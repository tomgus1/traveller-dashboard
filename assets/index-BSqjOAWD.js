const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/xlsx-C9OvYgdp.js","assets/icons-CuHNWACw.js","assets/excel-CRXrONvn.js","assets/vendor-X-tRH5j4.js"])))=>i.map(i=>d[i]);
import{r as S,U as Ls,X as qu,P as op,a as Bs,T as _u,A as ub,C as Pu,S as db,b as hg,R as fg,c as El,d as hb,D as fb,W as mg,e as mb,f as $u,g as pg,h as gg,i as Cn,j as pb,L as gb,Z as yb,k as vb,I as bb,l as xb,m as _b,n as yg,o as vg,p as wb,q as Sb,s as Cb,t as jb,M as cp,u as up,v as Ab,E as Jc,w as Xc,x as Nb,y as Eb,z as Rb,B as bg}from"./icons-CuHNWACw.js";import{g as xg,a as Tb}from"./excel-CRXrONvn.js";import{r as kb,a as Ob}from"./vendor-X-tRH5j4.js";function Db(i,a){for(var r=0;r<a.length;r++){const s=a[r];if(typeof s!="string"&&!Array.isArray(s)){for(const o in s)if(o!=="default"&&!(o in i)){const c=Object.getOwnPropertyDescriptor(s,o);c&&Object.defineProperty(i,o,c.get?c:{enumerable:!0,get:()=>s[o]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const h of c.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function r(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(o){if(o.ep)return;o.ep=!0;const c=r(o);fetch(o.href,c)}})();var Zc={exports:{}},js={};var dp;function Mb(){if(dp)return js;dp=1;var i=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function r(s,o,c){var h=null;if(c!==void 0&&(h=""+c),o.key!==void 0&&(h=""+o.key),"key"in o){c={};for(var m in o)m!=="key"&&(c[m]=o[m])}else c=o;return o=c.ref,{$$typeof:i,type:s,key:h,ref:o!==void 0?o:null,props:c}}return js.Fragment=a,js.jsx=r,js.jsxs=r,js}var hp;function Ub(){return hp||(hp=1,Zc.exports=Mb()),Zc.exports}var d=Ub(),eu={exports:{}},As={},tu={exports:{}},au={};var fp;function zb(){return fp||(fp=1,(function(i){function a(L,Y){var ae=L.length;L.push(Y);e:for(;0<ae;){var ee=ae-1>>>1,J=L[ee];if(0<o(J,Y))L[ee]=Y,L[ae]=J,ae=ee;else break e}}function r(L){return L.length===0?null:L[0]}function s(L){if(L.length===0)return null;var Y=L[0],ae=L.pop();if(ae!==Y){L[0]=ae;e:for(var ee=0,J=L.length,Ae=J>>>1;ee<Ae;){var Ne=2*(ee+1)-1,Q=L[Ne],me=Ne+1,et=L[me];if(0>o(Q,ae))me<J&&0>o(et,Q)?(L[ee]=et,L[me]=ae,ee=me):(L[ee]=Q,L[Ne]=ae,ee=Ne);else if(me<J&&0>o(et,ae))L[ee]=et,L[me]=ae,ee=me;else break e}}return Y}function o(L,Y){var ae=L.sortIndex-Y.sortIndex;return ae!==0?ae:L.id-Y.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;i.unstable_now=function(){return c.now()}}else{var h=Date,m=h.now();i.unstable_now=function(){return h.now()-m}}var p=[],g=[],v=1,b=null,x=3,_=!1,C=!1,j=!1,A=!1,R=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;function H(L){for(var Y=r(g);Y!==null;){if(Y.callback===null)s(g);else if(Y.startTime<=L)s(g),Y.sortIndex=Y.expirationTime,a(p,Y);else break;Y=r(g)}}function I(L){if(j=!1,H(L),!C)if(r(p)!==null)C=!0,V||(V=!0,ce());else{var Y=r(g);Y!==null&&pe(I,Y.startTime-L)}}var V=!1,re=-1,G=5,q=-1;function K(){return A?!0:!(i.unstable_now()-q<G)}function de(){if(A=!1,V){var L=i.unstable_now();q=L;var Y=!0;try{e:{C=!1,j&&(j=!1,k(re),re=-1),_=!0;var ae=x;try{t:{for(H(L),b=r(p);b!==null&&!(b.expirationTime>L&&K());){var ee=b.callback;if(typeof ee=="function"){b.callback=null,x=b.priorityLevel;var J=ee(b.expirationTime<=L);if(L=i.unstable_now(),typeof J=="function"){b.callback=J,H(L),Y=!0;break t}b===r(p)&&s(p),H(L)}else s(p);b=r(p)}if(b!==null)Y=!0;else{var Ae=r(g);Ae!==null&&pe(I,Ae.startTime-L),Y=!1}}break e}finally{b=null,x=ae,_=!1}Y=void 0}}finally{Y?ce():V=!1}}}var ce;if(typeof O=="function")ce=function(){O(de)};else if(typeof MessageChannel<"u"){var ie=new MessageChannel,F=ie.port2;ie.port1.onmessage=de,ce=function(){F.postMessage(null)}}else ce=function(){R(de,0)};function pe(L,Y){re=R(function(){L(i.unstable_now())},Y)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(L){L.callback=null},i.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<L?Math.floor(1e3/L):5},i.unstable_getCurrentPriorityLevel=function(){return x},i.unstable_next=function(L){switch(x){case 1:case 2:case 3:var Y=3;break;default:Y=x}var ae=x;x=Y;try{return L()}finally{x=ae}},i.unstable_requestPaint=function(){A=!0},i.unstable_runWithPriority=function(L,Y){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var ae=x;x=L;try{return Y()}finally{x=ae}},i.unstable_scheduleCallback=function(L,Y,ae){var ee=i.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?ee+ae:ee):ae=ee,L){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=ae+J,L={id:v++,callback:Y,priorityLevel:L,startTime:ae,expirationTime:J,sortIndex:-1},ae>ee?(L.sortIndex=ae,a(g,L),r(p)===null&&L===r(g)&&(j?(k(re),re=-1):j=!0,pe(I,ae-ee))):(L.sortIndex=J,a(p,L),C||_||(C=!0,V||(V=!0,ce()))),L},i.unstable_shouldYield=K,i.unstable_wrapCallback=function(L){var Y=x;return function(){var ae=x;x=Y;try{return L.apply(this,arguments)}finally{x=ae}}}})(au)),au}var mp;function Lb(){return mp||(mp=1,tu.exports=zb()),tu.exports}var pp;function Bb(){if(pp)return As;pp=1;var i=Lb(),a=kb(),r=Ob();function s(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function c(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function h(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function m(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(c(e)!==e)throw Error(s(188))}function g(e){var t=e.alternate;if(!t){if(t=c(e),t===null)throw Error(s(188));return t!==e?null:e}for(var n=e,l=t;;){var u=n.return;if(u===null)break;var f=u.alternate;if(f===null){if(l=u.return,l!==null){n=l;continue}break}if(u.child===f.child){for(f=u.child;f;){if(f===n)return p(u),e;if(f===l)return p(u),t;f=f.sibling}throw Error(s(188))}if(n.return!==l.return)n=u,l=f;else{for(var y=!1,w=u.child;w;){if(w===n){y=!0,n=u,l=f;break}if(w===l){y=!0,l=u,n=f;break}w=w.sibling}if(!y){for(w=f.child;w;){if(w===n){y=!0,n=f,l=u;break}if(w===l){y=!0,l=f,n=u;break}w=w.sibling}if(!y)throw Error(s(189))}}if(n.alternate!==l)throw Error(s(190))}if(n.tag!==3)throw Error(s(188));return n.stateNode.current===n?e:t}function v(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=v(e),t!==null)return t;e=e.sibling}return null}var b=Object.assign,x=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),C=Symbol.for("react.portal"),j=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),k=Symbol.for("react.consumer"),O=Symbol.for("react.context"),H=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),V=Symbol.for("react.suspense_list"),re=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),q=Symbol.for("react.activity"),K=Symbol.for("react.memo_cache_sentinel"),de=Symbol.iterator;function ce(e){return e===null||typeof e!="object"?null:(e=de&&e[de]||e["@@iterator"],typeof e=="function"?e:null)}var ie=Symbol.for("react.client.reference");function F(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===ie?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case j:return"Fragment";case R:return"Profiler";case A:return"StrictMode";case I:return"Suspense";case V:return"SuspenseList";case q:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case C:return"Portal";case O:return e.displayName||"Context";case k:return(e._context.displayName||"Context")+".Consumer";case H:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case re:return t=e.displayName||null,t!==null?t:F(e.type)||"Memo";case G:t=e._payload,e=e._init;try{return F(e(t))}catch{}}return null}var pe=Array.isArray,L=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Y=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae={pending:!1,data:null,method:null,action:null},ee=[],J=-1;function Ae(e){return{current:e}}function Ne(e){0>J||(e.current=ee[J],ee[J]=null,J--)}function Q(e,t){J++,ee[J]=e.current,e.current=t}var me=Ae(null),et=Ae(null),ze=Ae(null),_e=Ae(null);function ra(e,t){switch(Q(ze,t),Q(et,e),Q(me,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?km(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=km(t),e=Om(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}Ne(me),Q(me,e)}function na(){Ne(me),Ne(et),Ne(ze)}function jr(e){e.memoizedState!==null&&Q(_e,e);var t=me.current,n=Om(t,e.type);t!==n&&(Q(et,e),Q(me,n))}function Ar(e){et.current===e&&(Ne(me),Ne(et)),_e.current===e&&(Ne(_e),_s._currentValue=ae)}var On,ve;function Ie(e){if(On===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);On=t&&t[1]||"",ve=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+On+e+ve}var Vs=!1;function Nr(e,t){if(!e||Vs)return"";Vs=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var l={DetermineComponentFrameRoot:function(){try{if(t){var $=function(){throw Error()};if(Object.defineProperty($.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct($,[])}catch(z){var U=z}Reflect.construct(e,[],$)}else{try{$.call()}catch(z){U=z}e.call($.prototype)}}else{try{throw Error()}catch(z){U=z}($=e())&&typeof $.catch=="function"&&$.catch(function(){})}}catch(z){if(z&&U&&typeof z.stack=="string")return[z.stack,U.stack]}return[null,null]}};l.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var u=Object.getOwnPropertyDescriptor(l.DetermineComponentFrameRoot,"name");u&&u.configurable&&Object.defineProperty(l.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var f=l.DetermineComponentFrameRoot(),y=f[0],w=f[1];if(y&&w){var N=y.split(`
`),M=w.split(`
`);for(u=l=0;l<N.length&&!N[l].includes("DetermineComponentFrameRoot");)l++;for(;u<M.length&&!M[u].includes("DetermineComponentFrameRoot");)u++;if(l===N.length||u===M.length)for(l=N.length-1,u=M.length-1;1<=l&&0<=u&&N[l]!==M[u];)u--;for(;1<=l&&0<=u;l--,u--)if(N[l]!==M[u]){if(l!==1||u!==1)do if(l--,u--,0>u||N[l]!==M[u]){var B=`
`+N[l].replace(" at new "," at ");return e.displayName&&B.includes("<anonymous>")&&(B=B.replace("<anonymous>",e.displayName)),B}while(1<=l&&0<=u);break}}}finally{Vs=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?Ie(n):""}function $y(e,t){switch(e.tag){case 26:case 27:case 5:return Ie(e.type);case 16:return Ie("Lazy");case 13:return e.child!==t&&t!==null?Ie("Suspense Fallback"):Ie("Suspense");case 19:return Ie("SuspenseList");case 0:case 15:return Nr(e.type,!1);case 11:return Nr(e.type.render,!1);case 1:return Nr(e.type,!0);case 31:return Ie("Activity");default:return""}}function ld(e){try{var t="",n=null;do t+=$y(e,n),n=e,e=e.return;while(e);return t}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}var Ul=Object.prototype.hasOwnProperty,zl=i.unstable_scheduleCallback,Ll=i.unstable_cancelCallback,Hy=i.unstable_shouldYield,Vy=i.unstable_requestPaint,bt=i.unstable_now,Fy=i.unstable_getCurrentPriorityLevel,od=i.unstable_ImmediatePriority,cd=i.unstable_UserBlockingPriority,Fs=i.unstable_NormalPriority,Gy=i.unstable_LowPriority,ud=i.unstable_IdlePriority,Iy=i.log,Yy=i.unstable_setDisableYieldValue,Dn=null,xt=null;function Aa(e){if(typeof Iy=="function"&&Yy(e),xt&&typeof xt.setStrictMode=="function")try{xt.setStrictMode(Dn,e)}catch{}}var _t=Math.clz32?Math.clz32:Wy,Qy=Math.log,Ky=Math.LN2;function Wy(e){return e>>>=0,e===0?32:31-(Qy(e)/Ky|0)|0}var Gs=256,Is=262144,Ys=4194304;function tr(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Qs(e,t,n){var l=e.pendingLanes;if(l===0)return 0;var u=0,f=e.suspendedLanes,y=e.pingedLanes;e=e.warmLanes;var w=l&134217727;return w!==0?(l=w&~f,l!==0?u=tr(l):(y&=w,y!==0?u=tr(y):n||(n=w&~e,n!==0&&(u=tr(n))))):(w=l&~f,w!==0?u=tr(w):y!==0?u=tr(y):n||(n=l&~e,n!==0&&(u=tr(n)))),u===0?0:t!==0&&t!==u&&(t&f)===0&&(f=u&-u,n=t&-t,f>=n||f===32&&(n&4194048)!==0)?t:u}function Mn(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function Jy(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dd(){var e=Ys;return Ys<<=1,(Ys&62914560)===0&&(Ys=4194304),e}function Bl(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Un(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Xy(e,t,n,l,u,f){var y=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var w=e.entanglements,N=e.expirationTimes,M=e.hiddenUpdates;for(n=y&~n;0<n;){var B=31-_t(n),$=1<<B;w[B]=0,N[B]=-1;var U=M[B];if(U!==null)for(M[B]=null,B=0;B<U.length;B++){var z=U[B];z!==null&&(z.lane&=-536870913)}n&=~$}l!==0&&hd(e,l,0),f!==0&&u===0&&e.tag!==0&&(e.suspendedLanes|=f&~(y&~t))}function hd(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var l=31-_t(t);e.entangledLanes|=t,e.entanglements[l]=e.entanglements[l]|1073741824|n&261930}function fd(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var l=31-_t(n),u=1<<l;u&t|e[l]&t&&(e[l]|=t),n&=~u}}function md(e,t){var n=t&-t;return n=(n&42)!==0?1:ql(n),(n&(e.suspendedLanes|t))!==0?0:n}function ql(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Pl(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function pd(){var e=Y.p;return e!==0?e:(e=window.event,e===void 0?32:tp(e.type))}function gd(e,t){var n=Y.p;try{return Y.p=e,t()}finally{Y.p=n}}var Na=Math.random().toString(36).slice(2),nt="__reactFiber$"+Na,ht="__reactProps$"+Na,Er="__reactContainer$"+Na,$l="__reactEvents$"+Na,Zy="__reactListeners$"+Na,e0="__reactHandles$"+Na,yd="__reactResources$"+Na,zn="__reactMarker$"+Na;function Hl(e){delete e[nt],delete e[ht],delete e[$l],delete e[Zy],delete e[e0]}function Rr(e){var t=e[nt];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Er]||n[nt]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=qm(e);e!==null;){if(n=e[nt])return n;e=qm(e)}return t}e=n,n=e.parentNode}return null}function Tr(e){if(e=e[nt]||e[Er]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function Ln(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(s(33))}function kr(e){var t=e[yd];return t||(t=e[yd]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function tt(e){e[zn]=!0}var vd=new Set,bd={};function ar(e,t){Or(e,t),Or(e+"Capture",t)}function Or(e,t){for(bd[e]=t,e=0;e<t.length;e++)vd.add(t[e])}var t0=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),xd={},_d={};function a0(e){return Ul.call(_d,e)?!0:Ul.call(xd,e)?!1:t0.test(e)?_d[e]=!0:(xd[e]=!0,!1)}function Ks(e,t,n){if(a0(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var l=t.toLowerCase().slice(0,5);if(l!=="data-"&&l!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function Ws(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function sa(e,t,n,l){if(l===null)e.removeAttribute(n);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+l)}}function kt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function wd(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function r0(e,t,n){var l=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var u=l.get,f=l.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return u.call(this)},set:function(y){n=""+y,f.call(this,y)}}),Object.defineProperty(e,t,{enumerable:l.enumerable}),{getValue:function(){return n},setValue:function(y){n=""+y},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Vl(e){if(!e._valueTracker){var t=wd(e)?"checked":"value";e._valueTracker=r0(e,t,""+e[t])}}function Sd(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),l="";return e&&(l=wd(e)?e.checked?"true":"false":e.value),e=l,e!==n?(t.setValue(e),!0):!1}function Js(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var n0=/[\n"\\]/g;function Ot(e){return e.replace(n0,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function Fl(e,t,n,l,u,f,y,w){e.name="",y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"?e.type=y:e.removeAttribute("type"),t!=null?y==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+kt(t)):e.value!==""+kt(t)&&(e.value=""+kt(t)):y!=="submit"&&y!=="reset"||e.removeAttribute("value"),t!=null?Gl(e,y,kt(t)):n!=null?Gl(e,y,kt(n)):l!=null&&e.removeAttribute("value"),u==null&&f!=null&&(e.defaultChecked=!!f),u!=null&&(e.checked=u&&typeof u!="function"&&typeof u!="symbol"),w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?e.name=""+kt(w):e.removeAttribute("name")}function Cd(e,t,n,l,u,f,y,w){if(f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"&&(e.type=f),t!=null||n!=null){if(!(f!=="submit"&&f!=="reset"||t!=null)){Vl(e);return}n=n!=null?""+kt(n):"",t=t!=null?""+kt(t):n,w||t===e.value||(e.value=t),e.defaultValue=t}l=l??u,l=typeof l!="function"&&typeof l!="symbol"&&!!l,e.checked=w?e.checked:!!l,e.defaultChecked=!!l,y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(e.name=y),Vl(e)}function Gl(e,t,n){t==="number"&&Js(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function Dr(e,t,n,l){if(e=e.options,t){t={};for(var u=0;u<n.length;u++)t["$"+n[u]]=!0;for(n=0;n<e.length;n++)u=t.hasOwnProperty("$"+e[n].value),e[n].selected!==u&&(e[n].selected=u),u&&l&&(e[n].defaultSelected=!0)}else{for(n=""+kt(n),t=null,u=0;u<e.length;u++){if(e[u].value===n){e[u].selected=!0,l&&(e[u].defaultSelected=!0);return}t!==null||e[u].disabled||(t=e[u])}t!==null&&(t.selected=!0)}}function jd(e,t,n){if(t!=null&&(t=""+kt(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+kt(n):""}function Ad(e,t,n,l){if(t==null){if(l!=null){if(n!=null)throw Error(s(92));if(pe(l)){if(1<l.length)throw Error(s(93));l=l[0]}n=l}n==null&&(n=""),t=n}n=kt(t),e.defaultValue=n,l=e.textContent,l===n&&l!==""&&l!==null&&(e.value=l),Vl(e)}function Mr(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var s0=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Nd(e,t,n){var l=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?l?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":l?e.setProperty(t,n):typeof n!="number"||n===0||s0.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Ed(e,t,n){if(t!=null&&typeof t!="object")throw Error(s(62));if(e=e.style,n!=null){for(var l in n)!n.hasOwnProperty(l)||t!=null&&t.hasOwnProperty(l)||(l.indexOf("--")===0?e.setProperty(l,""):l==="float"?e.cssFloat="":e[l]="");for(var u in t)l=t[u],t.hasOwnProperty(u)&&n[u]!==l&&Nd(e,u,l)}else for(var f in t)t.hasOwnProperty(f)&&Nd(e,f,t[f])}function Il(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var i0=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),l0=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Xs(e){return l0.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function ia(){}var Yl=null;function Ql(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ur=null,zr=null;function Rd(e){var t=Tr(e);if(t&&(e=t.stateNode)){var n=e[ht]||null;e:switch(e=t.stateNode,t.type){case"input":if(Fl(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+Ot(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var l=n[t];if(l!==e&&l.form===e.form){var u=l[ht]||null;if(!u)throw Error(s(90));Fl(l,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name)}}for(t=0;t<n.length;t++)l=n[t],l.form===e.form&&Sd(l)}break e;case"textarea":jd(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&Dr(e,!!n.multiple,t,!1)}}}var Kl=!1;function Td(e,t,n){if(Kl)return e(t,n);Kl=!0;try{var l=e(t);return l}finally{if(Kl=!1,(Ur!==null||zr!==null)&&(qi(),Ur&&(t=Ur,e=zr,zr=Ur=null,Rd(t),e)))for(t=0;t<e.length;t++)Rd(e[t])}}function Bn(e,t){var n=e.stateNode;if(n===null)return null;var l=n[ht]||null;if(l===null)return null;n=l[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(s(231,t,typeof n));return n}var la=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wl=!1;if(la)try{var qn={};Object.defineProperty(qn,"passive",{get:function(){Wl=!0}}),window.addEventListener("test",qn,qn),window.removeEventListener("test",qn,qn)}catch{Wl=!1}var Ea=null,Jl=null,Zs=null;function kd(){if(Zs)return Zs;var e,t=Jl,n=t.length,l,u="value"in Ea?Ea.value:Ea.textContent,f=u.length;for(e=0;e<n&&t[e]===u[e];e++);var y=n-e;for(l=1;l<=y&&t[n-l]===u[f-l];l++);return Zs=u.slice(e,1<l?1-l:void 0)}function ei(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ti(){return!0}function Od(){return!1}function ft(e){function t(n,l,u,f,y){this._reactName=n,this._targetInst=u,this.type=l,this.nativeEvent=f,this.target=y,this.currentTarget=null;for(var w in e)e.hasOwnProperty(w)&&(n=e[w],this[w]=n?n(f):f[w]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?ti:Od,this.isPropagationStopped=Od,this}return b(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ti)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ti)},persist:function(){},isPersistent:ti}),t}var rr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ai=ft(rr),Pn=b({},rr,{view:0,detail:0}),o0=ft(Pn),Xl,Zl,$n,ri=b({},Pn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:to,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==$n&&($n&&e.type==="mousemove"?(Xl=e.screenX-$n.screenX,Zl=e.screenY-$n.screenY):Zl=Xl=0,$n=e),Xl)},movementY:function(e){return"movementY"in e?e.movementY:Zl}}),Dd=ft(ri),c0=b({},ri,{dataTransfer:0}),u0=ft(c0),d0=b({},Pn,{relatedTarget:0}),eo=ft(d0),h0=b({},rr,{animationName:0,elapsedTime:0,pseudoElement:0}),f0=ft(h0),m0=b({},rr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),p0=ft(m0),g0=b({},rr,{data:0}),Md=ft(g0),y0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},v0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},b0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function x0(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=b0[e])?!!t[e]:!1}function to(){return x0}var _0=b({},Pn,{key:function(e){if(e.key){var t=y0[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ei(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?v0[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:to,charCode:function(e){return e.type==="keypress"?ei(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ei(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),w0=ft(_0),S0=b({},ri,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ud=ft(S0),C0=b({},Pn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:to}),j0=ft(C0),A0=b({},rr,{propertyName:0,elapsedTime:0,pseudoElement:0}),N0=ft(A0),E0=b({},ri,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),R0=ft(E0),T0=b({},rr,{newState:0,oldState:0}),k0=ft(T0),O0=[9,13,27,32],ao=la&&"CompositionEvent"in window,Hn=null;la&&"documentMode"in document&&(Hn=document.documentMode);var D0=la&&"TextEvent"in window&&!Hn,zd=la&&(!ao||Hn&&8<Hn&&11>=Hn),Ld=" ",Bd=!1;function qd(e,t){switch(e){case"keyup":return O0.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Pd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Lr=!1;function M0(e,t){switch(e){case"compositionend":return Pd(t);case"keypress":return t.which!==32?null:(Bd=!0,Ld);case"textInput":return e=t.data,e===Ld&&Bd?null:e;default:return null}}function U0(e,t){if(Lr)return e==="compositionend"||!ao&&qd(e,t)?(e=kd(),Zs=Jl=Ea=null,Lr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return zd&&t.locale!=="ko"?null:t.data;default:return null}}var z0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $d(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!z0[e.type]:t==="textarea"}function Hd(e,t,n,l){Ur?zr?zr.push(l):zr=[l]:Ur=l,t=Ii(t,"onChange"),0<t.length&&(n=new ai("onChange","change",null,n,l),e.push({event:n,listeners:t}))}var Vn=null,Fn=null;function L0(e){jm(e,0)}function ni(e){var t=Ln(e);if(Sd(t))return e}function Vd(e,t){if(e==="change")return t}var Fd=!1;if(la){var ro;if(la){var no="oninput"in document;if(!no){var Gd=document.createElement("div");Gd.setAttribute("oninput","return;"),no=typeof Gd.oninput=="function"}ro=no}else ro=!1;Fd=ro&&(!document.documentMode||9<document.documentMode)}function Id(){Vn&&(Vn.detachEvent("onpropertychange",Yd),Fn=Vn=null)}function Yd(e){if(e.propertyName==="value"&&ni(Fn)){var t=[];Hd(t,Fn,e,Ql(e)),Td(L0,t)}}function B0(e,t,n){e==="focusin"?(Id(),Vn=t,Fn=n,Vn.attachEvent("onpropertychange",Yd)):e==="focusout"&&Id()}function q0(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ni(Fn)}function P0(e,t){if(e==="click")return ni(t)}function $0(e,t){if(e==="input"||e==="change")return ni(t)}function H0(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var wt=typeof Object.is=="function"?Object.is:H0;function Gn(e,t){if(wt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),l=Object.keys(t);if(n.length!==l.length)return!1;for(l=0;l<n.length;l++){var u=n[l];if(!Ul.call(t,u)||!wt(e[u],t[u]))return!1}return!0}function Qd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Kd(e,t){var n=Qd(e);e=0;for(var l;n;){if(n.nodeType===3){if(l=e+n.textContent.length,e<=t&&l>=t)return{node:n,offset:t-e};e=l}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Qd(n)}}function Wd(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Wd(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Jd(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Js(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Js(e.document)}return t}function so(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var V0=la&&"documentMode"in document&&11>=document.documentMode,Br=null,io=null,In=null,lo=!1;function Xd(e,t,n){var l=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;lo||Br==null||Br!==Js(l)||(l=Br,"selectionStart"in l&&so(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),In&&Gn(In,l)||(In=l,l=Ii(io,"onSelect"),0<l.length&&(t=new ai("onSelect","select",null,t,n),e.push({event:t,listeners:l}),t.target=Br)))}function nr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var qr={animationend:nr("Animation","AnimationEnd"),animationiteration:nr("Animation","AnimationIteration"),animationstart:nr("Animation","AnimationStart"),transitionrun:nr("Transition","TransitionRun"),transitionstart:nr("Transition","TransitionStart"),transitioncancel:nr("Transition","TransitionCancel"),transitionend:nr("Transition","TransitionEnd")},oo={},Zd={};la&&(Zd=document.createElement("div").style,"AnimationEvent"in window||(delete qr.animationend.animation,delete qr.animationiteration.animation,delete qr.animationstart.animation),"TransitionEvent"in window||delete qr.transitionend.transition);function sr(e){if(oo[e])return oo[e];if(!qr[e])return e;var t=qr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Zd)return oo[e]=t[n];return e}var eh=sr("animationend"),th=sr("animationiteration"),ah=sr("animationstart"),F0=sr("transitionrun"),G0=sr("transitionstart"),I0=sr("transitioncancel"),rh=sr("transitionend"),nh=new Map,co="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");co.push("scrollEnd");function $t(e,t){nh.set(e,t),ar(t,[e])}var si=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},Dt=[],Pr=0,uo=0;function ii(){for(var e=Pr,t=uo=Pr=0;t<e;){var n=Dt[t];Dt[t++]=null;var l=Dt[t];Dt[t++]=null;var u=Dt[t];Dt[t++]=null;var f=Dt[t];if(Dt[t++]=null,l!==null&&u!==null){var y=l.pending;y===null?u.next=u:(u.next=y.next,y.next=u),l.pending=u}f!==0&&sh(n,u,f)}}function li(e,t,n,l){Dt[Pr++]=e,Dt[Pr++]=t,Dt[Pr++]=n,Dt[Pr++]=l,uo|=l,e.lanes|=l,e=e.alternate,e!==null&&(e.lanes|=l)}function ho(e,t,n,l){return li(e,t,n,l),oi(e)}function ir(e,t){return li(e,null,null,t),oi(e)}function sh(e,t,n){e.lanes|=n;var l=e.alternate;l!==null&&(l.lanes|=n);for(var u=!1,f=e.return;f!==null;)f.childLanes|=n,l=f.alternate,l!==null&&(l.childLanes|=n),f.tag===22&&(e=f.stateNode,e===null||e._visibility&1||(u=!0)),e=f,f=f.return;return e.tag===3?(f=e.stateNode,u&&t!==null&&(u=31-_t(n),e=f.hiddenUpdates,l=e[u],l===null?e[u]=[t]:l.push(t),t.lane=n|536870912),f):null}function oi(e){if(50<ms)throw ms=0,_c=null,Error(s(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var $r={};function Y0(e,t,n,l){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function St(e,t,n,l){return new Y0(e,t,n,l)}function fo(e){return e=e.prototype,!(!e||!e.isReactComponent)}function oa(e,t){var n=e.alternate;return n===null?(n=St(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function ih(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function ci(e,t,n,l,u,f){var y=0;if(l=e,typeof e=="function")fo(e)&&(y=1);else if(typeof e=="string")y=Xv(e,n,me.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case q:return e=St(31,n,t,u),e.elementType=q,e.lanes=f,e;case j:return lr(n.children,u,f,t);case A:y=8,u|=24;break;case R:return e=St(12,n,t,u|2),e.elementType=R,e.lanes=f,e;case I:return e=St(13,n,t,u),e.elementType=I,e.lanes=f,e;case V:return e=St(19,n,t,u),e.elementType=V,e.lanes=f,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case O:y=10;break e;case k:y=9;break e;case H:y=11;break e;case re:y=14;break e;case G:y=16,l=null;break e}y=29,n=Error(s(130,e===null?"null":typeof e,"")),l=null}return t=St(y,n,t,u),t.elementType=e,t.type=l,t.lanes=f,t}function lr(e,t,n,l){return e=St(7,e,l,t),e.lanes=n,e}function mo(e,t,n){return e=St(6,e,null,t),e.lanes=n,e}function lh(e){var t=St(18,null,null,0);return t.stateNode=e,t}function po(e,t,n){return t=St(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var oh=new WeakMap;function Mt(e,t){if(typeof e=="object"&&e!==null){var n=oh.get(e);return n!==void 0?n:(t={value:e,source:t,stack:ld(t)},oh.set(e,t),t)}return{value:e,source:t,stack:ld(t)}}var Hr=[],Vr=0,ui=null,Yn=0,Ut=[],zt=0,Ra=null,Xt=1,Zt="";function ca(e,t){Hr[Vr++]=Yn,Hr[Vr++]=ui,ui=e,Yn=t}function ch(e,t,n){Ut[zt++]=Xt,Ut[zt++]=Zt,Ut[zt++]=Ra,Ra=e;var l=Xt;e=Zt;var u=32-_t(l)-1;l&=~(1<<u),n+=1;var f=32-_t(t)+u;if(30<f){var y=u-u%5;f=(l&(1<<y)-1).toString(32),l>>=y,u-=y,Xt=1<<32-_t(t)+u|n<<u|l,Zt=f+e}else Xt=1<<f|n<<u|l,Zt=e}function go(e){e.return!==null&&(ca(e,1),ch(e,1,0))}function yo(e){for(;e===ui;)ui=Hr[--Vr],Hr[Vr]=null,Yn=Hr[--Vr],Hr[Vr]=null;for(;e===Ra;)Ra=Ut[--zt],Ut[zt]=null,Zt=Ut[--zt],Ut[zt]=null,Xt=Ut[--zt],Ut[zt]=null}function uh(e,t){Ut[zt++]=Xt,Ut[zt++]=Zt,Ut[zt++]=Ra,Xt=t.id,Zt=t.overflow,Ra=e}var st=null,Le=null,we=!1,Ta=null,Lt=!1,vo=Error(s(519));function ka(e){var t=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Qn(Mt(t,e)),vo}function dh(e){var t=e.stateNode,n=e.type,l=e.memoizedProps;switch(t[nt]=e,t[ht]=l,n){case"dialog":ye("cancel",t),ye("close",t);break;case"iframe":case"object":case"embed":ye("load",t);break;case"video":case"audio":for(n=0;n<gs.length;n++)ye(gs[n],t);break;case"source":ye("error",t);break;case"img":case"image":case"link":ye("error",t),ye("load",t);break;case"details":ye("toggle",t);break;case"input":ye("invalid",t),Cd(t,l.value,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name,!0);break;case"select":ye("invalid",t);break;case"textarea":ye("invalid",t),Ad(t,l.value,l.defaultValue,l.children)}n=l.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||l.suppressHydrationWarning===!0||Rm(t.textContent,n)?(l.popover!=null&&(ye("beforetoggle",t),ye("toggle",t)),l.onScroll!=null&&ye("scroll",t),l.onScrollEnd!=null&&ye("scrollend",t),l.onClick!=null&&(t.onclick=ia),t=!0):t=!1,t||ka(e,!0)}function hh(e){for(st=e.return;st;)switch(st.tag){case 5:case 31:case 13:Lt=!1;return;case 27:case 3:Lt=!0;return;default:st=st.return}}function Fr(e){if(e!==st)return!1;if(!we)return hh(e),we=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||zc(e.type,e.memoizedProps)),n=!n),n&&Le&&ka(e),hh(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));Le=Bm(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));Le=Bm(e)}else t===27?(t=Le,Ga(e.type)?(e=$c,$c=null,Le=e):Le=t):Le=st?qt(e.stateNode.nextSibling):null;return!0}function or(){Le=st=null,we=!1}function bo(){var e=Ta;return e!==null&&(yt===null?yt=e:yt.push.apply(yt,e),Ta=null),e}function Qn(e){Ta===null?Ta=[e]:Ta.push(e)}var xo=Ae(null),cr=null,ua=null;function Oa(e,t,n){Q(xo,t._currentValue),t._currentValue=n}function da(e){e._currentValue=xo.current,Ne(xo)}function _o(e,t,n){for(;e!==null;){var l=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,l!==null&&(l.childLanes|=t)):l!==null&&(l.childLanes&t)!==t&&(l.childLanes|=t),e===n)break;e=e.return}}function wo(e,t,n,l){var u=e.child;for(u!==null&&(u.return=e);u!==null;){var f=u.dependencies;if(f!==null){var y=u.child;f=f.firstContext;e:for(;f!==null;){var w=f;f=u;for(var N=0;N<t.length;N++)if(w.context===t[N]){f.lanes|=n,w=f.alternate,w!==null&&(w.lanes|=n),_o(f.return,n,e),l||(y=null);break e}f=w.next}}else if(u.tag===18){if(y=u.return,y===null)throw Error(s(341));y.lanes|=n,f=y.alternate,f!==null&&(f.lanes|=n),_o(y,n,e),y=null}else y=u.child;if(y!==null)y.return=u;else for(y=u;y!==null;){if(y===e){y=null;break}if(u=y.sibling,u!==null){u.return=y.return,y=u;break}y=y.return}u=y}}function Gr(e,t,n,l){e=null;for(var u=t,f=!1;u!==null;){if(!f){if((u.flags&524288)!==0)f=!0;else if((u.flags&262144)!==0)break}if(u.tag===10){var y=u.alternate;if(y===null)throw Error(s(387));if(y=y.memoizedProps,y!==null){var w=u.type;wt(u.pendingProps.value,y.value)||(e!==null?e.push(w):e=[w])}}else if(u===_e.current){if(y=u.alternate,y===null)throw Error(s(387));y.memoizedState.memoizedState!==u.memoizedState.memoizedState&&(e!==null?e.push(_s):e=[_s])}u=u.return}e!==null&&wo(t,e,n,l),t.flags|=262144}function di(e){for(e=e.firstContext;e!==null;){if(!wt(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function ur(e){cr=e,ua=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function it(e){return fh(cr,e)}function hi(e,t){return cr===null&&ur(e),fh(e,t)}function fh(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},ua===null){if(e===null)throw Error(s(308));ua=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else ua=ua.next=t;return n}var Q0=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,l){e.push(l)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},K0=i.unstable_scheduleCallback,W0=i.unstable_NormalPriority,Ye={$$typeof:O,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function So(){return{controller:new Q0,data:new Map,refCount:0}}function Kn(e){e.refCount--,e.refCount===0&&K0(W0,function(){e.controller.abort()})}var Wn=null,Co=0,Ir=0,Yr=null;function J0(e,t){if(Wn===null){var n=Wn=[];Co=0,Ir=Nc(),Yr={status:"pending",value:void 0,then:function(l){n.push(l)}}}return Co++,t.then(mh,mh),t}function mh(){if(--Co===0&&Wn!==null){Yr!==null&&(Yr.status="fulfilled");var e=Wn;Wn=null,Ir=0,Yr=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function X0(e,t){var n=[],l={status:"pending",value:null,reason:null,then:function(u){n.push(u)}};return e.then(function(){l.status="fulfilled",l.value=t;for(var u=0;u<n.length;u++)(0,n[u])(t)},function(u){for(l.status="rejected",l.reason=u,u=0;u<n.length;u++)(0,n[u])(void 0)}),l}var ph=L.S;L.S=function(e,t){Zf=bt(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&J0(e,t),ph!==null&&ph(e,t)};var dr=Ae(null);function jo(){var e=dr.current;return e!==null?e:Me.pooledCache}function fi(e,t){t===null?Q(dr,dr.current):Q(dr,t.pool)}function gh(){var e=jo();return e===null?null:{parent:Ye._currentValue,pool:e}}var Qr=Error(s(460)),Ao=Error(s(474)),mi=Error(s(542)),pi={then:function(){}};function yh(e){return e=e.status,e==="fulfilled"||e==="rejected"}function vh(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(ia,ia),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,xh(e),e;default:if(typeof t.status=="string")t.then(ia,ia);else{if(e=Me,e!==null&&100<e.shellSuspendCounter)throw Error(s(482));e=t,e.status="pending",e.then(function(l){if(t.status==="pending"){var u=t;u.status="fulfilled",u.value=l}},function(l){if(t.status==="pending"){var u=t;u.status="rejected",u.reason=l}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,xh(e),e}throw fr=t,Qr}}function hr(e){try{var t=e._init;return t(e._payload)}catch(n){throw n!==null&&typeof n=="object"&&typeof n.then=="function"?(fr=n,Qr):n}}var fr=null;function bh(){if(fr===null)throw Error(s(459));var e=fr;return fr=null,e}function xh(e){if(e===Qr||e===mi)throw Error(s(483))}var Kr=null,Jn=0;function gi(e){var t=Jn;return Jn+=1,Kr===null&&(Kr=[]),vh(Kr,e,t)}function Xn(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function yi(e,t){throw t.$$typeof===x?Error(s(525)):(e=Object.prototype.toString.call(t),Error(s(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function _h(e){function t(T,E){if(e){var D=T.deletions;D===null?(T.deletions=[E],T.flags|=16):D.push(E)}}function n(T,E){if(!e)return null;for(;E!==null;)t(T,E),E=E.sibling;return null}function l(T){for(var E=new Map;T!==null;)T.key!==null?E.set(T.key,T):E.set(T.index,T),T=T.sibling;return E}function u(T,E){return T=oa(T,E),T.index=0,T.sibling=null,T}function f(T,E,D){return T.index=D,e?(D=T.alternate,D!==null?(D=D.index,D<E?(T.flags|=67108866,E):D):(T.flags|=67108866,E)):(T.flags|=1048576,E)}function y(T){return e&&T.alternate===null&&(T.flags|=67108866),T}function w(T,E,D,P){return E===null||E.tag!==6?(E=mo(D,T.mode,P),E.return=T,E):(E=u(E,D),E.return=T,E)}function N(T,E,D,P){var se=D.type;return se===j?B(T,E,D.props.children,P,D.key):E!==null&&(E.elementType===se||typeof se=="object"&&se!==null&&se.$$typeof===G&&hr(se)===E.type)?(E=u(E,D.props),Xn(E,D),E.return=T,E):(E=ci(D.type,D.key,D.props,null,T.mode,P),Xn(E,D),E.return=T,E)}function M(T,E,D,P){return E===null||E.tag!==4||E.stateNode.containerInfo!==D.containerInfo||E.stateNode.implementation!==D.implementation?(E=po(D,T.mode,P),E.return=T,E):(E=u(E,D.children||[]),E.return=T,E)}function B(T,E,D,P,se){return E===null||E.tag!==7?(E=lr(D,T.mode,P,se),E.return=T,E):(E=u(E,D),E.return=T,E)}function $(T,E,D){if(typeof E=="string"&&E!==""||typeof E=="number"||typeof E=="bigint")return E=mo(""+E,T.mode,D),E.return=T,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case _:return D=ci(E.type,E.key,E.props,null,T.mode,D),Xn(D,E),D.return=T,D;case C:return E=po(E,T.mode,D),E.return=T,E;case G:return E=hr(E),$(T,E,D)}if(pe(E)||ce(E))return E=lr(E,T.mode,D,null),E.return=T,E;if(typeof E.then=="function")return $(T,gi(E),D);if(E.$$typeof===O)return $(T,hi(T,E),D);yi(T,E)}return null}function U(T,E,D,P){var se=E!==null?E.key:null;if(typeof D=="string"&&D!==""||typeof D=="number"||typeof D=="bigint")return se!==null?null:w(T,E,""+D,P);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case _:return D.key===se?N(T,E,D,P):null;case C:return D.key===se?M(T,E,D,P):null;case G:return D=hr(D),U(T,E,D,P)}if(pe(D)||ce(D))return se!==null?null:B(T,E,D,P,null);if(typeof D.then=="function")return U(T,E,gi(D),P);if(D.$$typeof===O)return U(T,E,hi(T,D),P);yi(T,D)}return null}function z(T,E,D,P,se){if(typeof P=="string"&&P!==""||typeof P=="number"||typeof P=="bigint")return T=T.get(D)||null,w(E,T,""+P,se);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case _:return T=T.get(P.key===null?D:P.key)||null,N(E,T,P,se);case C:return T=T.get(P.key===null?D:P.key)||null,M(E,T,P,se);case G:return P=hr(P),z(T,E,D,P,se)}if(pe(P)||ce(P))return T=T.get(D)||null,B(E,T,P,se,null);if(typeof P.then=="function")return z(T,E,D,gi(P),se);if(P.$$typeof===O)return z(T,E,D,hi(E,P),se);yi(E,P)}return null}function X(T,E,D,P){for(var se=null,Se=null,Z=E,fe=E=0,xe=null;Z!==null&&fe<D.length;fe++){Z.index>fe?(xe=Z,Z=null):xe=Z.sibling;var Ce=U(T,Z,D[fe],P);if(Ce===null){Z===null&&(Z=xe);break}e&&Z&&Ce.alternate===null&&t(T,Z),E=f(Ce,E,fe),Se===null?se=Ce:Se.sibling=Ce,Se=Ce,Z=xe}if(fe===D.length)return n(T,Z),we&&ca(T,fe),se;if(Z===null){for(;fe<D.length;fe++)Z=$(T,D[fe],P),Z!==null&&(E=f(Z,E,fe),Se===null?se=Z:Se.sibling=Z,Se=Z);return we&&ca(T,fe),se}for(Z=l(Z);fe<D.length;fe++)xe=z(Z,T,fe,D[fe],P),xe!==null&&(e&&xe.alternate!==null&&Z.delete(xe.key===null?fe:xe.key),E=f(xe,E,fe),Se===null?se=xe:Se.sibling=xe,Se=xe);return e&&Z.forEach(function(Wa){return t(T,Wa)}),we&&ca(T,fe),se}function le(T,E,D,P){if(D==null)throw Error(s(151));for(var se=null,Se=null,Z=E,fe=E=0,xe=null,Ce=D.next();Z!==null&&!Ce.done;fe++,Ce=D.next()){Z.index>fe?(xe=Z,Z=null):xe=Z.sibling;var Wa=U(T,Z,Ce.value,P);if(Wa===null){Z===null&&(Z=xe);break}e&&Z&&Wa.alternate===null&&t(T,Z),E=f(Wa,E,fe),Se===null?se=Wa:Se.sibling=Wa,Se=Wa,Z=xe}if(Ce.done)return n(T,Z),we&&ca(T,fe),se;if(Z===null){for(;!Ce.done;fe++,Ce=D.next())Ce=$(T,Ce.value,P),Ce!==null&&(E=f(Ce,E,fe),Se===null?se=Ce:Se.sibling=Ce,Se=Ce);return we&&ca(T,fe),se}for(Z=l(Z);!Ce.done;fe++,Ce=D.next())Ce=z(Z,T,fe,Ce.value,P),Ce!==null&&(e&&Ce.alternate!==null&&Z.delete(Ce.key===null?fe:Ce.key),E=f(Ce,E,fe),Se===null?se=Ce:Se.sibling=Ce,Se=Ce);return e&&Z.forEach(function(cb){return t(T,cb)}),we&&ca(T,fe),se}function De(T,E,D,P){if(typeof D=="object"&&D!==null&&D.type===j&&D.key===null&&(D=D.props.children),typeof D=="object"&&D!==null){switch(D.$$typeof){case _:e:{for(var se=D.key;E!==null;){if(E.key===se){if(se=D.type,se===j){if(E.tag===7){n(T,E.sibling),P=u(E,D.props.children),P.return=T,T=P;break e}}else if(E.elementType===se||typeof se=="object"&&se!==null&&se.$$typeof===G&&hr(se)===E.type){n(T,E.sibling),P=u(E,D.props),Xn(P,D),P.return=T,T=P;break e}n(T,E);break}else t(T,E);E=E.sibling}D.type===j?(P=lr(D.props.children,T.mode,P,D.key),P.return=T,T=P):(P=ci(D.type,D.key,D.props,null,T.mode,P),Xn(P,D),P.return=T,T=P)}return y(T);case C:e:{for(se=D.key;E!==null;){if(E.key===se)if(E.tag===4&&E.stateNode.containerInfo===D.containerInfo&&E.stateNode.implementation===D.implementation){n(T,E.sibling),P=u(E,D.children||[]),P.return=T,T=P;break e}else{n(T,E);break}else t(T,E);E=E.sibling}P=po(D,T.mode,P),P.return=T,T=P}return y(T);case G:return D=hr(D),De(T,E,D,P)}if(pe(D))return X(T,E,D,P);if(ce(D)){if(se=ce(D),typeof se!="function")throw Error(s(150));return D=se.call(D),le(T,E,D,P)}if(typeof D.then=="function")return De(T,E,gi(D),P);if(D.$$typeof===O)return De(T,E,hi(T,D),P);yi(T,D)}return typeof D=="string"&&D!==""||typeof D=="number"||typeof D=="bigint"?(D=""+D,E!==null&&E.tag===6?(n(T,E.sibling),P=u(E,D),P.return=T,T=P):(n(T,E),P=mo(D,T.mode,P),P.return=T,T=P),y(T)):n(T,E)}return function(T,E,D,P){try{Jn=0;var se=De(T,E,D,P);return Kr=null,se}catch(Z){if(Z===Qr||Z===mi)throw Z;var Se=St(29,Z,null,T.mode);return Se.lanes=P,Se.return=T,Se}finally{}}}var mr=_h(!0),wh=_h(!1),Da=!1;function No(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Eo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Ma(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Ua(e,t,n){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,(je&2)!==0){var u=l.pending;return u===null?t.next=t:(t.next=u.next,u.next=t),l.pending=t,t=oi(e),sh(e,null,n),t}return li(e,l,t,n),oi(e)}function Zn(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var l=t.lanes;l&=e.pendingLanes,n|=l,t.lanes=n,fd(e,n)}}function Ro(e,t){var n=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,n===l)){var u=null,f=null;if(n=n.firstBaseUpdate,n!==null){do{var y={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};f===null?u=f=y:f=f.next=y,n=n.next}while(n!==null);f===null?u=f=t:f=f.next=t}else u=f=t;n={baseState:l.baseState,firstBaseUpdate:u,lastBaseUpdate:f,shared:l.shared,callbacks:l.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var To=!1;function es(){if(To){var e=Yr;if(e!==null)throw e}}function ts(e,t,n,l){To=!1;var u=e.updateQueue;Da=!1;var f=u.firstBaseUpdate,y=u.lastBaseUpdate,w=u.shared.pending;if(w!==null){u.shared.pending=null;var N=w,M=N.next;N.next=null,y===null?f=M:y.next=M,y=N;var B=e.alternate;B!==null&&(B=B.updateQueue,w=B.lastBaseUpdate,w!==y&&(w===null?B.firstBaseUpdate=M:w.next=M,B.lastBaseUpdate=N))}if(f!==null){var $=u.baseState;y=0,B=M=N=null,w=f;do{var U=w.lane&-536870913,z=U!==w.lane;if(z?(be&U)===U:(l&U)===U){U!==0&&U===Ir&&(To=!0),B!==null&&(B=B.next={lane:0,tag:w.tag,payload:w.payload,callback:null,next:null});e:{var X=e,le=w;U=t;var De=n;switch(le.tag){case 1:if(X=le.payload,typeof X=="function"){$=X.call(De,$,U);break e}$=X;break e;case 3:X.flags=X.flags&-65537|128;case 0:if(X=le.payload,U=typeof X=="function"?X.call(De,$,U):X,U==null)break e;$=b({},$,U);break e;case 2:Da=!0}}U=w.callback,U!==null&&(e.flags|=64,z&&(e.flags|=8192),z=u.callbacks,z===null?u.callbacks=[U]:z.push(U))}else z={lane:U,tag:w.tag,payload:w.payload,callback:w.callback,next:null},B===null?(M=B=z,N=$):B=B.next=z,y|=U;if(w=w.next,w===null){if(w=u.shared.pending,w===null)break;z=w,w=z.next,z.next=null,u.lastBaseUpdate=z,u.shared.pending=null}}while(!0);B===null&&(N=$),u.baseState=N,u.firstBaseUpdate=M,u.lastBaseUpdate=B,f===null&&(u.shared.lanes=0),Pa|=y,e.lanes=y,e.memoizedState=$}}function Sh(e,t){if(typeof e!="function")throw Error(s(191,e));e.call(t)}function Ch(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)Sh(n[e],t)}var Wr=Ae(null),vi=Ae(0);function jh(e,t){e=xa,Q(vi,e),Q(Wr,t),xa=e|t.baseLanes}function ko(){Q(vi,xa),Q(Wr,Wr.current)}function Oo(){xa=vi.current,Ne(Wr),Ne(vi)}var Ct=Ae(null),Bt=null;function za(e){var t=e.alternate;Q(Fe,Fe.current&1),Q(Ct,e),Bt===null&&(t===null||Wr.current!==null||t.memoizedState!==null)&&(Bt=e)}function Do(e){Q(Fe,Fe.current),Q(Ct,e),Bt===null&&(Bt=e)}function Ah(e){e.tag===22?(Q(Fe,Fe.current),Q(Ct,e),Bt===null&&(Bt=e)):La()}function La(){Q(Fe,Fe.current),Q(Ct,Ct.current)}function jt(e){Ne(Ct),Bt===e&&(Bt=null),Ne(Fe)}var Fe=Ae(0);function bi(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||qc(n)||Pc(n)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ha=0,he=null,ke=null,Qe=null,xi=!1,Jr=!1,pr=!1,_i=0,as=0,Xr=null,Z0=0;function He(){throw Error(s(321))}function Mo(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!wt(e[n],t[n]))return!1;return!0}function Uo(e,t,n,l,u,f){return ha=f,he=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,L.H=e===null||e.memoizedState===null?uf:Wo,pr=!1,f=n(l,u),pr=!1,Jr&&(f=Eh(t,n,l,u)),Nh(e),f}function Nh(e){L.H=ss;var t=ke!==null&&ke.next!==null;if(ha=0,Qe=ke=he=null,xi=!1,as=0,Xr=null,t)throw Error(s(300));e===null||Ke||(e=e.dependencies,e!==null&&di(e)&&(Ke=!0))}function Eh(e,t,n,l){he=e;var u=0;do{if(Jr&&(Xr=null),as=0,Jr=!1,25<=u)throw Error(s(301));if(u+=1,Qe=ke=null,e.updateQueue!=null){var f=e.updateQueue;f.lastEffect=null,f.events=null,f.stores=null,f.memoCache!=null&&(f.memoCache.index=0)}L.H=df,f=t(n,l)}while(Jr);return f}function ev(){var e=L.H,t=e.useState()[0];return t=typeof t.then=="function"?rs(t):t,e=e.useState()[0],(ke!==null?ke.memoizedState:null)!==e&&(he.flags|=1024),t}function zo(){var e=_i!==0;return _i=0,e}function Lo(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function Bo(e){if(xi){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}xi=!1}ha=0,Qe=ke=he=null,Jr=!1,as=_i=0,Xr=null}function dt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Qe===null?he.memoizedState=Qe=e:Qe=Qe.next=e,Qe}function Ge(){if(ke===null){var e=he.alternate;e=e!==null?e.memoizedState:null}else e=ke.next;var t=Qe===null?he.memoizedState:Qe.next;if(t!==null)Qe=t,ke=e;else{if(e===null)throw he.alternate===null?Error(s(467)):Error(s(310));ke=e,e={memoizedState:ke.memoizedState,baseState:ke.baseState,baseQueue:ke.baseQueue,queue:ke.queue,next:null},Qe===null?he.memoizedState=Qe=e:Qe=Qe.next=e}return Qe}function wi(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function rs(e){var t=as;return as+=1,Xr===null&&(Xr=[]),e=vh(Xr,e,t),t=he,(Qe===null?t.memoizedState:Qe.next)===null&&(t=t.alternate,L.H=t===null||t.memoizedState===null?uf:Wo),e}function Si(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return rs(e);if(e.$$typeof===O)return it(e)}throw Error(s(438,String(e)))}function qo(e){var t=null,n=he.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var l=he.alternate;l!==null&&(l=l.updateQueue,l!==null&&(l=l.memoCache,l!=null&&(t={data:l.data.map(function(u){return u.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=wi(),he.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),l=0;l<e;l++)n[l]=K;return t.index++,n}function fa(e,t){return typeof t=="function"?t(e):t}function Ci(e){var t=Ge();return Po(t,ke,e)}function Po(e,t,n){var l=e.queue;if(l===null)throw Error(s(311));l.lastRenderedReducer=n;var u=e.baseQueue,f=l.pending;if(f!==null){if(u!==null){var y=u.next;u.next=f.next,f.next=y}t.baseQueue=u=f,l.pending=null}if(f=e.baseState,u===null)e.memoizedState=f;else{t=u.next;var w=y=null,N=null,M=t,B=!1;do{var $=M.lane&-536870913;if($!==M.lane?(be&$)===$:(ha&$)===$){var U=M.revertLane;if(U===0)N!==null&&(N=N.next={lane:0,revertLane:0,gesture:null,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null}),$===Ir&&(B=!0);else if((ha&U)===U){M=M.next,U===Ir&&(B=!0);continue}else $={lane:0,revertLane:M.revertLane,gesture:null,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null},N===null?(w=N=$,y=f):N=N.next=$,he.lanes|=U,Pa|=U;$=M.action,pr&&n(f,$),f=M.hasEagerState?M.eagerState:n(f,$)}else U={lane:$,revertLane:M.revertLane,gesture:M.gesture,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null},N===null?(w=N=U,y=f):N=N.next=U,he.lanes|=$,Pa|=$;M=M.next}while(M!==null&&M!==t);if(N===null?y=f:N.next=w,!wt(f,e.memoizedState)&&(Ke=!0,B&&(n=Yr,n!==null)))throw n;e.memoizedState=f,e.baseState=y,e.baseQueue=N,l.lastRenderedState=f}return u===null&&(l.lanes=0),[e.memoizedState,l.dispatch]}function $o(e){var t=Ge(),n=t.queue;if(n===null)throw Error(s(311));n.lastRenderedReducer=e;var l=n.dispatch,u=n.pending,f=t.memoizedState;if(u!==null){n.pending=null;var y=u=u.next;do f=e(f,y.action),y=y.next;while(y!==u);wt(f,t.memoizedState)||(Ke=!0),t.memoizedState=f,t.baseQueue===null&&(t.baseState=f),n.lastRenderedState=f}return[f,l]}function Rh(e,t,n){var l=he,u=Ge(),f=we;if(f){if(n===void 0)throw Error(s(407));n=n()}else n=t();var y=!wt((ke||u).memoizedState,n);if(y&&(u.memoizedState=n,Ke=!0),u=u.queue,Fo(Oh.bind(null,l,u,e),[e]),u.getSnapshot!==t||y||Qe!==null&&Qe.memoizedState.tag&1){if(l.flags|=2048,Zr(9,{destroy:void 0},kh.bind(null,l,u,n,t),null),Me===null)throw Error(s(349));f||(ha&127)!==0||Th(l,t,n)}return n}function Th(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=he.updateQueue,t===null?(t=wi(),he.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function kh(e,t,n,l){t.value=n,t.getSnapshot=l,Dh(t)&&Mh(e)}function Oh(e,t,n){return n(function(){Dh(t)&&Mh(e)})}function Dh(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!wt(e,n)}catch{return!0}}function Mh(e){var t=ir(e,2);t!==null&&vt(t,e,2)}function Ho(e){var t=dt();if(typeof e=="function"){var n=e;if(e=n(),pr){Aa(!0);try{n()}finally{Aa(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:fa,lastRenderedState:e},t}function Uh(e,t,n,l){return e.baseState=n,Po(e,ke,typeof l=="function"?l:fa)}function tv(e,t,n,l,u){if(Ni(e))throw Error(s(485));if(e=t.action,e!==null){var f={payload:u,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(y){f.listeners.push(y)}};L.T!==null?n(!0):f.isTransition=!1,l(f),n=t.pending,n===null?(f.next=t.pending=f,zh(t,f)):(f.next=n.next,t.pending=n.next=f)}}function zh(e,t){var n=t.action,l=t.payload,u=e.state;if(t.isTransition){var f=L.T,y={};L.T=y;try{var w=n(u,l),N=L.S;N!==null&&N(y,w),Lh(e,t,w)}catch(M){Vo(e,t,M)}finally{f!==null&&y.types!==null&&(f.types=y.types),L.T=f}}else try{f=n(u,l),Lh(e,t,f)}catch(M){Vo(e,t,M)}}function Lh(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(l){Bh(e,t,l)},function(l){return Vo(e,t,l)}):Bh(e,t,n)}function Bh(e,t,n){t.status="fulfilled",t.value=n,qh(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,zh(e,n)))}function Vo(e,t,n){var l=e.pending;if(e.pending=null,l!==null){l=l.next;do t.status="rejected",t.reason=n,qh(t),t=t.next;while(t!==l)}e.action=null}function qh(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Ph(e,t){return t}function $h(e,t){if(we){var n=Me.formState;if(n!==null){e:{var l=he;if(we){if(Le){t:{for(var u=Le,f=Lt;u.nodeType!==8;){if(!f){u=null;break t}if(u=qt(u.nextSibling),u===null){u=null;break t}}f=u.data,u=f==="F!"||f==="F"?u:null}if(u){Le=qt(u.nextSibling),l=u.data==="F!";break e}}ka(l)}l=!1}l&&(t=n[0])}}return n=dt(),n.memoizedState=n.baseState=t,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ph,lastRenderedState:t},n.queue=l,n=lf.bind(null,he,l),l.dispatch=n,l=Ho(!1),f=Ko.bind(null,he,!1,l.queue),l=dt(),u={state:t,dispatch:null,action:e,pending:null},l.queue=u,n=tv.bind(null,he,u,f,n),u.dispatch=n,l.memoizedState=e,[t,n,!1]}function Hh(e){var t=Ge();return Vh(t,ke,e)}function Vh(e,t,n){if(t=Po(e,t,Ph)[0],e=Ci(fa)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var l=rs(t)}catch(y){throw y===Qr?mi:y}else l=t;t=Ge();var u=t.queue,f=u.dispatch;return n!==t.memoizedState&&(he.flags|=2048,Zr(9,{destroy:void 0},av.bind(null,u,n),null)),[l,f,e]}function av(e,t){e.action=t}function Fh(e){var t=Ge(),n=ke;if(n!==null)return Vh(t,n,e);Ge(),t=t.memoizedState,n=Ge();var l=n.queue.dispatch;return n.memoizedState=e,[t,l,!1]}function Zr(e,t,n,l){return e={tag:e,create:n,deps:l,inst:t,next:null},t=he.updateQueue,t===null&&(t=wi(),he.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(l=n.next,n.next=e,e.next=l,t.lastEffect=e),e}function Gh(){return Ge().memoizedState}function ji(e,t,n,l){var u=dt();he.flags|=e,u.memoizedState=Zr(1|t,{destroy:void 0},n,l===void 0?null:l)}function Ai(e,t,n,l){var u=Ge();l=l===void 0?null:l;var f=u.memoizedState.inst;ke!==null&&l!==null&&Mo(l,ke.memoizedState.deps)?u.memoizedState=Zr(t,f,n,l):(he.flags|=e,u.memoizedState=Zr(1|t,f,n,l))}function Ih(e,t){ji(8390656,8,e,t)}function Fo(e,t){Ai(2048,8,e,t)}function rv(e){he.flags|=4;var t=he.updateQueue;if(t===null)t=wi(),he.updateQueue=t,t.events=[e];else{var n=t.events;n===null?t.events=[e]:n.push(e)}}function Yh(e){var t=Ge().memoizedState;return rv({ref:t,nextImpl:e}),function(){if((je&2)!==0)throw Error(s(440));return t.impl.apply(void 0,arguments)}}function Qh(e,t){return Ai(4,2,e,t)}function Kh(e,t){return Ai(4,4,e,t)}function Wh(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Jh(e,t,n){n=n!=null?n.concat([e]):null,Ai(4,4,Wh.bind(null,t,e),n)}function Go(){}function Xh(e,t){var n=Ge();t=t===void 0?null:t;var l=n.memoizedState;return t!==null&&Mo(t,l[1])?l[0]:(n.memoizedState=[e,t],e)}function Zh(e,t){var n=Ge();t=t===void 0?null:t;var l=n.memoizedState;if(t!==null&&Mo(t,l[1]))return l[0];if(l=e(),pr){Aa(!0);try{e()}finally{Aa(!1)}}return n.memoizedState=[l,t],l}function Io(e,t,n){return n===void 0||(ha&1073741824)!==0&&(be&261930)===0?e.memoizedState=t:(e.memoizedState=n,e=tm(),he.lanes|=e,Pa|=e,n)}function ef(e,t,n,l){return wt(n,t)?n:Wr.current!==null?(e=Io(e,n,l),wt(e,t)||(Ke=!0),e):(ha&42)===0||(ha&1073741824)!==0&&(be&261930)===0?(Ke=!0,e.memoizedState=n):(e=tm(),he.lanes|=e,Pa|=e,t)}function tf(e,t,n,l,u){var f=Y.p;Y.p=f!==0&&8>f?f:8;var y=L.T,w={};L.T=w,Ko(e,!1,t,n);try{var N=u(),M=L.S;if(M!==null&&M(w,N),N!==null&&typeof N=="object"&&typeof N.then=="function"){var B=X0(N,l);ns(e,t,B,Et(e))}else ns(e,t,l,Et(e))}catch($){ns(e,t,{then:function(){},status:"rejected",reason:$},Et())}finally{Y.p=f,y!==null&&w.types!==null&&(y.types=w.types),L.T=y}}function nv(){}function Yo(e,t,n,l){if(e.tag!==5)throw Error(s(476));var u=af(e).queue;tf(e,u,t,ae,n===null?nv:function(){return rf(e),n(l)})}function af(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:ae,baseState:ae,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fa,lastRenderedState:ae},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fa,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function rf(e){var t=af(e);t.next===null&&(t=e.alternate.memoizedState),ns(e,t.next.queue,{},Et())}function Qo(){return it(_s)}function nf(){return Ge().memoizedState}function sf(){return Ge().memoizedState}function sv(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=Et();e=Ma(n);var l=Ua(t,e,n);l!==null&&(vt(l,t,n),Zn(l,t,n)),t={cache:So()},e.payload=t;return}t=t.return}}function iv(e,t,n){var l=Et();n={lane:l,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},Ni(e)?of(t,n):(n=ho(e,t,n,l),n!==null&&(vt(n,e,l),cf(n,t,l)))}function lf(e,t,n){var l=Et();ns(e,t,n,l)}function ns(e,t,n,l){var u={lane:l,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ni(e))of(t,u);else{var f=e.alternate;if(e.lanes===0&&(f===null||f.lanes===0)&&(f=t.lastRenderedReducer,f!==null))try{var y=t.lastRenderedState,w=f(y,n);if(u.hasEagerState=!0,u.eagerState=w,wt(w,y))return li(e,t,u,0),Me===null&&ii(),!1}catch{}finally{}if(n=ho(e,t,u,l),n!==null)return vt(n,e,l),cf(n,t,l),!0}return!1}function Ko(e,t,n,l){if(l={lane:2,revertLane:Nc(),gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Ni(e)){if(t)throw Error(s(479))}else t=ho(e,n,l,2),t!==null&&vt(t,e,2)}function Ni(e){var t=e.alternate;return e===he||t!==null&&t===he}function of(e,t){Jr=xi=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function cf(e,t,n){if((n&4194048)!==0){var l=t.lanes;l&=e.pendingLanes,n|=l,t.lanes=n,fd(e,n)}}var ss={readContext:it,use:Si,useCallback:He,useContext:He,useEffect:He,useImperativeHandle:He,useLayoutEffect:He,useInsertionEffect:He,useMemo:He,useReducer:He,useRef:He,useState:He,useDebugValue:He,useDeferredValue:He,useTransition:He,useSyncExternalStore:He,useId:He,useHostTransitionStatus:He,useFormState:He,useActionState:He,useOptimistic:He,useMemoCache:He,useCacheRefresh:He};ss.useEffectEvent=He;var uf={readContext:it,use:Si,useCallback:function(e,t){return dt().memoizedState=[e,t===void 0?null:t],e},useContext:it,useEffect:Ih,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,ji(4194308,4,Wh.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ji(4194308,4,e,t)},useInsertionEffect:function(e,t){ji(4,2,e,t)},useMemo:function(e,t){var n=dt();t=t===void 0?null:t;var l=e();if(pr){Aa(!0);try{e()}finally{Aa(!1)}}return n.memoizedState=[l,t],l},useReducer:function(e,t,n){var l=dt();if(n!==void 0){var u=n(t);if(pr){Aa(!0);try{n(t)}finally{Aa(!1)}}}else u=t;return l.memoizedState=l.baseState=u,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:u},l.queue=e,e=e.dispatch=iv.bind(null,he,e),[l.memoizedState,e]},useRef:function(e){var t=dt();return e={current:e},t.memoizedState=e},useState:function(e){e=Ho(e);var t=e.queue,n=lf.bind(null,he,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Go,useDeferredValue:function(e,t){var n=dt();return Io(n,e,t)},useTransition:function(){var e=Ho(!1);return e=tf.bind(null,he,e.queue,!0,!1),dt().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var l=he,u=dt();if(we){if(n===void 0)throw Error(s(407));n=n()}else{if(n=t(),Me===null)throw Error(s(349));(be&127)!==0||Th(l,t,n)}u.memoizedState=n;var f={value:n,getSnapshot:t};return u.queue=f,Ih(Oh.bind(null,l,f,e),[e]),l.flags|=2048,Zr(9,{destroy:void 0},kh.bind(null,l,f,n,t),null),n},useId:function(){var e=dt(),t=Me.identifierPrefix;if(we){var n=Zt,l=Xt;n=(l&~(1<<32-_t(l)-1)).toString(32)+n,t="_"+t+"R_"+n,n=_i++,0<n&&(t+="H"+n.toString(32)),t+="_"}else n=Z0++,t="_"+t+"r_"+n.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:Qo,useFormState:$h,useActionState:$h,useOptimistic:function(e){var t=dt();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Ko.bind(null,he,!0,n),n.dispatch=t,[e,t]},useMemoCache:qo,useCacheRefresh:function(){return dt().memoizedState=sv.bind(null,he)},useEffectEvent:function(e){var t=dt(),n={impl:e};return t.memoizedState=n,function(){if((je&2)!==0)throw Error(s(440));return n.impl.apply(void 0,arguments)}}},Wo={readContext:it,use:Si,useCallback:Xh,useContext:it,useEffect:Fo,useImperativeHandle:Jh,useInsertionEffect:Qh,useLayoutEffect:Kh,useMemo:Zh,useReducer:Ci,useRef:Gh,useState:function(){return Ci(fa)},useDebugValue:Go,useDeferredValue:function(e,t){var n=Ge();return ef(n,ke.memoizedState,e,t)},useTransition:function(){var e=Ci(fa)[0],t=Ge().memoizedState;return[typeof e=="boolean"?e:rs(e),t]},useSyncExternalStore:Rh,useId:nf,useHostTransitionStatus:Qo,useFormState:Hh,useActionState:Hh,useOptimistic:function(e,t){var n=Ge();return Uh(n,ke,e,t)},useMemoCache:qo,useCacheRefresh:sf};Wo.useEffectEvent=Yh;var df={readContext:it,use:Si,useCallback:Xh,useContext:it,useEffect:Fo,useImperativeHandle:Jh,useInsertionEffect:Qh,useLayoutEffect:Kh,useMemo:Zh,useReducer:$o,useRef:Gh,useState:function(){return $o(fa)},useDebugValue:Go,useDeferredValue:function(e,t){var n=Ge();return ke===null?Io(n,e,t):ef(n,ke.memoizedState,e,t)},useTransition:function(){var e=$o(fa)[0],t=Ge().memoizedState;return[typeof e=="boolean"?e:rs(e),t]},useSyncExternalStore:Rh,useId:nf,useHostTransitionStatus:Qo,useFormState:Fh,useActionState:Fh,useOptimistic:function(e,t){var n=Ge();return ke!==null?Uh(n,ke,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:qo,useCacheRefresh:sf};df.useEffectEvent=Yh;function Jo(e,t,n,l){t=e.memoizedState,n=n(l,t),n=n==null?t:b({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Xo={enqueueSetState:function(e,t,n){e=e._reactInternals;var l=Et(),u=Ma(l);u.payload=t,n!=null&&(u.callback=n),t=Ua(e,u,l),t!==null&&(vt(t,e,l),Zn(t,e,l))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var l=Et(),u=Ma(l);u.tag=1,u.payload=t,n!=null&&(u.callback=n),t=Ua(e,u,l),t!==null&&(vt(t,e,l),Zn(t,e,l))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Et(),l=Ma(n);l.tag=2,t!=null&&(l.callback=t),t=Ua(e,l,n),t!==null&&(vt(t,e,n),Zn(t,e,n))}};function hf(e,t,n,l,u,f,y){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,f,y):t.prototype&&t.prototype.isPureReactComponent?!Gn(n,l)||!Gn(u,f):!0}function ff(e,t,n,l){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,l),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,l),t.state!==e&&Xo.enqueueReplaceState(t,t.state,null)}function gr(e,t){var n=t;if("ref"in t){n={};for(var l in t)l!=="ref"&&(n[l]=t[l])}if(e=e.defaultProps){n===t&&(n=b({},n));for(var u in e)n[u]===void 0&&(n[u]=e[u])}return n}function mf(e){si(e)}function pf(e){console.error(e)}function gf(e){si(e)}function Ei(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(l){setTimeout(function(){throw l})}}function yf(e,t,n){try{var l=e.onCaughtError;l(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(u){setTimeout(function(){throw u})}}function Zo(e,t,n){return n=Ma(n),n.tag=3,n.payload={element:null},n.callback=function(){Ei(e,t)},n}function vf(e){return e=Ma(e),e.tag=3,e}function bf(e,t,n,l){var u=n.type.getDerivedStateFromError;if(typeof u=="function"){var f=l.value;e.payload=function(){return u(f)},e.callback=function(){yf(t,n,l)}}var y=n.stateNode;y!==null&&typeof y.componentDidCatch=="function"&&(e.callback=function(){yf(t,n,l),typeof u!="function"&&($a===null?$a=new Set([this]):$a.add(this));var w=l.stack;this.componentDidCatch(l.value,{componentStack:w!==null?w:""})})}function lv(e,t,n,l,u){if(n.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){if(t=n.alternate,t!==null&&Gr(t,n,u,!0),n=Ct.current,n!==null){switch(n.tag){case 31:case 13:return Bt===null?Pi():n.alternate===null&&Ve===0&&(Ve=3),n.flags&=-257,n.flags|=65536,n.lanes=u,l===pi?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([l]):t.add(l),Cc(e,l,u)),!1;case 22:return n.flags|=65536,l===pi?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([l])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([l]):n.add(l)),Cc(e,l,u)),!1}throw Error(s(435,n.tag))}return Cc(e,l,u),Pi(),!1}if(we)return t=Ct.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=u,l!==vo&&(e=Error(s(422),{cause:l}),Qn(Mt(e,n)))):(l!==vo&&(t=Error(s(423),{cause:l}),Qn(Mt(t,n))),e=e.current.alternate,e.flags|=65536,u&=-u,e.lanes|=u,l=Mt(l,n),u=Zo(e.stateNode,l,u),Ro(e,u),Ve!==4&&(Ve=2)),!1;var f=Error(s(520),{cause:l});if(f=Mt(f,n),fs===null?fs=[f]:fs.push(f),Ve!==4&&(Ve=2),t===null)return!0;l=Mt(l,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=u&-u,n.lanes|=e,e=Zo(n.stateNode,l,e),Ro(n,e),!1;case 1:if(t=n.type,f=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&($a===null||!$a.has(f))))return n.flags|=65536,u&=-u,n.lanes|=u,u=vf(u),bf(u,e,n,l),Ro(n,u),!1}n=n.return}while(n!==null);return!1}var ec=Error(s(461)),Ke=!1;function lt(e,t,n,l){t.child=e===null?wh(t,null,n,l):mr(t,e.child,n,l)}function xf(e,t,n,l,u){n=n.render;var f=t.ref;if("ref"in l){var y={};for(var w in l)w!=="ref"&&(y[w]=l[w])}else y=l;return ur(t),l=Uo(e,t,n,y,f,u),w=zo(),e!==null&&!Ke?(Lo(e,t,u),ma(e,t,u)):(we&&w&&go(t),t.flags|=1,lt(e,t,l,u),t.child)}function _f(e,t,n,l,u){if(e===null){var f=n.type;return typeof f=="function"&&!fo(f)&&f.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=f,wf(e,t,f,l,u)):(e=ci(n.type,null,l,t,t.mode,u),e.ref=t.ref,e.return=t,t.child=e)}if(f=e.child,!oc(e,u)){var y=f.memoizedProps;if(n=n.compare,n=n!==null?n:Gn,n(y,l)&&e.ref===t.ref)return ma(e,t,u)}return t.flags|=1,e=oa(f,l),e.ref=t.ref,e.return=t,t.child=e}function wf(e,t,n,l,u){if(e!==null){var f=e.memoizedProps;if(Gn(f,l)&&e.ref===t.ref)if(Ke=!1,t.pendingProps=l=f,oc(e,u))(e.flags&131072)!==0&&(Ke=!0);else return t.lanes=e.lanes,ma(e,t,u)}return tc(e,t,n,l,u)}function Sf(e,t,n,l){var u=l.children,f=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.mode==="hidden"){if((t.flags&128)!==0){if(f=f!==null?f.baseLanes|n:n,e!==null){for(l=t.child=e.child,u=0;l!==null;)u=u|l.lanes|l.childLanes,l=l.sibling;l=u&~f}else l=0,t.child=null;return Cf(e,t,f,n,l)}if((n&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&fi(t,f!==null?f.cachePool:null),f!==null?jh(t,f):ko(),Ah(t);else return l=t.lanes=536870912,Cf(e,t,f!==null?f.baseLanes|n:n,n,l)}else f!==null?(fi(t,f.cachePool),jh(t,f),La(),t.memoizedState=null):(e!==null&&fi(t,null),ko(),La());return lt(e,t,u,n),t.child}function is(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Cf(e,t,n,l,u){var f=jo();return f=f===null?null:{parent:Ye._currentValue,pool:f},t.memoizedState={baseLanes:n,cachePool:f},e!==null&&fi(t,null),ko(),Ah(t),e!==null&&Gr(e,t,l,!0),t.childLanes=u,null}function Ri(e,t){return t=ki({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function jf(e,t,n){return mr(t,e.child,null,n),e=Ri(t,t.pendingProps),e.flags|=2,jt(t),t.memoizedState=null,e}function ov(e,t,n){var l=t.pendingProps,u=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(we){if(l.mode==="hidden")return e=Ri(t,l),t.lanes=536870912,is(null,e);if(Do(t),(e=Le)?(e=Lm(e,Lt),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Ra!==null?{id:Xt,overflow:Zt}:null,retryLane:536870912,hydrationErrors:null},n=lh(e),n.return=t,t.child=n,st=t,Le=null)):e=null,e===null)throw ka(t);return t.lanes=536870912,null}return Ri(t,l)}var f=e.memoizedState;if(f!==null){var y=f.dehydrated;if(Do(t),u)if(t.flags&256)t.flags&=-257,t=jf(e,t,n);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(s(558));else if(Ke||Gr(e,t,n,!1),u=(n&e.childLanes)!==0,Ke||u){if(l=Me,l!==null&&(y=md(l,n),y!==0&&y!==f.retryLane))throw f.retryLane=y,ir(e,y),vt(l,e,y),ec;Pi(),t=jf(e,t,n)}else e=f.treeContext,Le=qt(y.nextSibling),st=t,we=!0,Ta=null,Lt=!1,e!==null&&uh(t,e),t=Ri(t,l),t.flags|=4096;return t}return e=oa(e.child,{mode:l.mode,children:l.children}),e.ref=t.ref,t.child=e,e.return=t,e}function Ti(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(s(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function tc(e,t,n,l,u){return ur(t),n=Uo(e,t,n,l,void 0,u),l=zo(),e!==null&&!Ke?(Lo(e,t,u),ma(e,t,u)):(we&&l&&go(t),t.flags|=1,lt(e,t,n,u),t.child)}function Af(e,t,n,l,u,f){return ur(t),t.updateQueue=null,n=Eh(t,l,n,u),Nh(e),l=zo(),e!==null&&!Ke?(Lo(e,t,f),ma(e,t,f)):(we&&l&&go(t),t.flags|=1,lt(e,t,n,f),t.child)}function Nf(e,t,n,l,u){if(ur(t),t.stateNode===null){var f=$r,y=n.contextType;typeof y=="object"&&y!==null&&(f=it(y)),f=new n(l,f),t.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=Xo,t.stateNode=f,f._reactInternals=t,f=t.stateNode,f.props=l,f.state=t.memoizedState,f.refs={},No(t),y=n.contextType,f.context=typeof y=="object"&&y!==null?it(y):$r,f.state=t.memoizedState,y=n.getDerivedStateFromProps,typeof y=="function"&&(Jo(t,n,y,l),f.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(y=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),y!==f.state&&Xo.enqueueReplaceState(f,f.state,null),ts(t,l,f,u),es(),f.state=t.memoizedState),typeof f.componentDidMount=="function"&&(t.flags|=4194308),l=!0}else if(e===null){f=t.stateNode;var w=t.memoizedProps,N=gr(n,w);f.props=N;var M=f.context,B=n.contextType;y=$r,typeof B=="object"&&B!==null&&(y=it(B));var $=n.getDerivedStateFromProps;B=typeof $=="function"||typeof f.getSnapshotBeforeUpdate=="function",w=t.pendingProps!==w,B||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(w||M!==y)&&ff(t,f,l,y),Da=!1;var U=t.memoizedState;f.state=U,ts(t,l,f,u),es(),M=t.memoizedState,w||U!==M||Da?(typeof $=="function"&&(Jo(t,n,$,l),M=t.memoizedState),(N=Da||hf(t,n,N,l,U,M,y))?(B||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(t.flags|=4194308)):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=l,t.memoizedState=M),f.props=l,f.state=M,f.context=y,l=N):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),l=!1)}else{f=t.stateNode,Eo(e,t),y=t.memoizedProps,B=gr(n,y),f.props=B,$=t.pendingProps,U=f.context,M=n.contextType,N=$r,typeof M=="object"&&M!==null&&(N=it(M)),w=n.getDerivedStateFromProps,(M=typeof w=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(y!==$||U!==N)&&ff(t,f,l,N),Da=!1,U=t.memoizedState,f.state=U,ts(t,l,f,u),es();var z=t.memoizedState;y!==$||U!==z||Da||e!==null&&e.dependencies!==null&&di(e.dependencies)?(typeof w=="function"&&(Jo(t,n,w,l),z=t.memoizedState),(B=Da||hf(t,n,B,l,U,z,N)||e!==null&&e.dependencies!==null&&di(e.dependencies))?(M||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(l,z,N),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(l,z,N)),typeof f.componentDidUpdate=="function"&&(t.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof f.componentDidUpdate!="function"||y===e.memoizedProps&&U===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&U===e.memoizedState||(t.flags|=1024),t.memoizedProps=l,t.memoizedState=z),f.props=l,f.state=z,f.context=N,l=B):(typeof f.componentDidUpdate!="function"||y===e.memoizedProps&&U===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&U===e.memoizedState||(t.flags|=1024),l=!1)}return f=l,Ti(e,t),l=(t.flags&128)!==0,f||l?(f=t.stateNode,n=l&&typeof n.getDerivedStateFromError!="function"?null:f.render(),t.flags|=1,e!==null&&l?(t.child=mr(t,e.child,null,u),t.child=mr(t,null,n,u)):lt(e,t,n,u),t.memoizedState=f.state,e=t.child):e=ma(e,t,u),e}function Ef(e,t,n,l){return or(),t.flags|=256,lt(e,t,n,l),t.child}var ac={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function rc(e){return{baseLanes:e,cachePool:gh()}}function nc(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=Nt),e}function Rf(e,t,n){var l=t.pendingProps,u=!1,f=(t.flags&128)!==0,y;if((y=f)||(y=e!==null&&e.memoizedState===null?!1:(Fe.current&2)!==0),y&&(u=!0,t.flags&=-129),y=(t.flags&32)!==0,t.flags&=-33,e===null){if(we){if(u?za(t):La(),(e=Le)?(e=Lm(e,Lt),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Ra!==null?{id:Xt,overflow:Zt}:null,retryLane:536870912,hydrationErrors:null},n=lh(e),n.return=t,t.child=n,st=t,Le=null)):e=null,e===null)throw ka(t);return Pc(e)?t.lanes=32:t.lanes=536870912,null}var w=l.children;return l=l.fallback,u?(La(),u=t.mode,w=ki({mode:"hidden",children:w},u),l=lr(l,u,n,null),w.return=t,l.return=t,w.sibling=l,t.child=w,l=t.child,l.memoizedState=rc(n),l.childLanes=nc(e,y,n),t.memoizedState=ac,is(null,l)):(za(t),sc(t,w))}var N=e.memoizedState;if(N!==null&&(w=N.dehydrated,w!==null)){if(f)t.flags&256?(za(t),t.flags&=-257,t=ic(e,t,n)):t.memoizedState!==null?(La(),t.child=e.child,t.flags|=128,t=null):(La(),w=l.fallback,u=t.mode,l=ki({mode:"visible",children:l.children},u),w=lr(w,u,n,null),w.flags|=2,l.return=t,w.return=t,l.sibling=w,t.child=l,mr(t,e.child,null,n),l=t.child,l.memoizedState=rc(n),l.childLanes=nc(e,y,n),t.memoizedState=ac,t=is(null,l));else if(za(t),Pc(w)){if(y=w.nextSibling&&w.nextSibling.dataset,y)var M=y.dgst;y=M,l=Error(s(419)),l.stack="",l.digest=y,Qn({value:l,source:null,stack:null}),t=ic(e,t,n)}else if(Ke||Gr(e,t,n,!1),y=(n&e.childLanes)!==0,Ke||y){if(y=Me,y!==null&&(l=md(y,n),l!==0&&l!==N.retryLane))throw N.retryLane=l,ir(e,l),vt(y,e,l),ec;qc(w)||Pi(),t=ic(e,t,n)}else qc(w)?(t.flags|=192,t.child=e.child,t=null):(e=N.treeContext,Le=qt(w.nextSibling),st=t,we=!0,Ta=null,Lt=!1,e!==null&&uh(t,e),t=sc(t,l.children),t.flags|=4096);return t}return u?(La(),w=l.fallback,u=t.mode,N=e.child,M=N.sibling,l=oa(N,{mode:"hidden",children:l.children}),l.subtreeFlags=N.subtreeFlags&65011712,M!==null?w=oa(M,w):(w=lr(w,u,n,null),w.flags|=2),w.return=t,l.return=t,l.sibling=w,t.child=l,is(null,l),l=t.child,w=e.child.memoizedState,w===null?w=rc(n):(u=w.cachePool,u!==null?(N=Ye._currentValue,u=u.parent!==N?{parent:N,pool:N}:u):u=gh(),w={baseLanes:w.baseLanes|n,cachePool:u}),l.memoizedState=w,l.childLanes=nc(e,y,n),t.memoizedState=ac,is(e.child,l)):(za(t),n=e.child,e=n.sibling,n=oa(n,{mode:"visible",children:l.children}),n.return=t,n.sibling=null,e!==null&&(y=t.deletions,y===null?(t.deletions=[e],t.flags|=16):y.push(e)),t.child=n,t.memoizedState=null,n)}function sc(e,t){return t=ki({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function ki(e,t){return e=St(22,e,null,t),e.lanes=0,e}function ic(e,t,n){return mr(t,e.child,null,n),e=sc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Tf(e,t,n){e.lanes|=t;var l=e.alternate;l!==null&&(l.lanes|=t),_o(e.return,t,n)}function lc(e,t,n,l,u,f){var y=e.memoizedState;y===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:l,tail:n,tailMode:u,treeForkCount:f}:(y.isBackwards=t,y.rendering=null,y.renderingStartTime=0,y.last=l,y.tail=n,y.tailMode=u,y.treeForkCount=f)}function kf(e,t,n){var l=t.pendingProps,u=l.revealOrder,f=l.tail;l=l.children;var y=Fe.current,w=(y&2)!==0;if(w?(y=y&1|2,t.flags|=128):y&=1,Q(Fe,y),lt(e,t,l,n),l=we?Yn:0,!w&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Tf(e,n,t);else if(e.tag===19)Tf(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(u){case"forwards":for(n=t.child,u=null;n!==null;)e=n.alternate,e!==null&&bi(e)===null&&(u=n),n=n.sibling;n=u,n===null?(u=t.child,t.child=null):(u=n.sibling,n.sibling=null),lc(t,!1,u,n,f,l);break;case"backwards":case"unstable_legacy-backwards":for(n=null,u=t.child,t.child=null;u!==null;){if(e=u.alternate,e!==null&&bi(e)===null){t.child=u;break}e=u.sibling,u.sibling=n,n=u,u=e}lc(t,!0,n,null,f,l);break;case"together":lc(t,!1,null,null,void 0,l);break;default:t.memoizedState=null}return t.child}function ma(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Pa|=t.lanes,(n&t.childLanes)===0)if(e!==null){if(Gr(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(s(153));if(t.child!==null){for(e=t.child,n=oa(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=oa(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function oc(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&di(e)))}function cv(e,t,n){switch(t.tag){case 3:ra(t,t.stateNode.containerInfo),Oa(t,Ye,e.memoizedState.cache),or();break;case 27:case 5:jr(t);break;case 4:ra(t,t.stateNode.containerInfo);break;case 10:Oa(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,Do(t),null;break;case 13:var l=t.memoizedState;if(l!==null)return l.dehydrated!==null?(za(t),t.flags|=128,null):(n&t.child.childLanes)!==0?Rf(e,t,n):(za(t),e=ma(e,t,n),e!==null?e.sibling:null);za(t);break;case 19:var u=(e.flags&128)!==0;if(l=(n&t.childLanes)!==0,l||(Gr(e,t,n,!1),l=(n&t.childLanes)!==0),u){if(l)return kf(e,t,n);t.flags|=128}if(u=t.memoizedState,u!==null&&(u.rendering=null,u.tail=null,u.lastEffect=null),Q(Fe,Fe.current),l)break;return null;case 22:return t.lanes=0,Sf(e,t,n,t.pendingProps);case 24:Oa(t,Ye,e.memoizedState.cache)}return ma(e,t,n)}function Of(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)Ke=!0;else{if(!oc(e,n)&&(t.flags&128)===0)return Ke=!1,cv(e,t,n);Ke=(e.flags&131072)!==0}else Ke=!1,we&&(t.flags&1048576)!==0&&ch(t,Yn,t.index);switch(t.lanes=0,t.tag){case 16:e:{var l=t.pendingProps;if(e=hr(t.elementType),t.type=e,typeof e=="function")fo(e)?(l=gr(e,l),t.tag=1,t=Nf(null,t,e,l,n)):(t.tag=0,t=tc(null,t,e,l,n));else{if(e!=null){var u=e.$$typeof;if(u===H){t.tag=11,t=xf(null,t,e,l,n);break e}else if(u===re){t.tag=14,t=_f(null,t,e,l,n);break e}}throw t=F(e)||e,Error(s(306,t,""))}}return t;case 0:return tc(e,t,t.type,t.pendingProps,n);case 1:return l=t.type,u=gr(l,t.pendingProps),Nf(e,t,l,u,n);case 3:e:{if(ra(t,t.stateNode.containerInfo),e===null)throw Error(s(387));l=t.pendingProps;var f=t.memoizedState;u=f.element,Eo(e,t),ts(t,l,null,n);var y=t.memoizedState;if(l=y.cache,Oa(t,Ye,l),l!==f.cache&&wo(t,[Ye],n,!0),es(),l=y.element,f.isDehydrated)if(f={element:l,isDehydrated:!1,cache:y.cache},t.updateQueue.baseState=f,t.memoizedState=f,t.flags&256){t=Ef(e,t,l,n);break e}else if(l!==u){u=Mt(Error(s(424)),t),Qn(u),t=Ef(e,t,l,n);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Le=qt(e.firstChild),st=t,we=!0,Ta=null,Lt=!0,n=wh(t,null,l,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(or(),l===u){t=ma(e,t,n);break e}lt(e,t,l,n)}t=t.child}return t;case 26:return Ti(e,t),e===null?(n=Vm(t.type,null,t.pendingProps,null))?t.memoizedState=n:we||(n=t.type,e=t.pendingProps,l=Yi(ze.current).createElement(n),l[nt]=t,l[ht]=e,ot(l,n,e),tt(l),t.stateNode=l):t.memoizedState=Vm(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return jr(t),e===null&&we&&(l=t.stateNode=Pm(t.type,t.pendingProps,ze.current),st=t,Lt=!0,u=Le,Ga(t.type)?($c=u,Le=qt(l.firstChild)):Le=u),lt(e,t,t.pendingProps.children,n),Ti(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&we&&((u=l=Le)&&(l=qv(l,t.type,t.pendingProps,Lt),l!==null?(t.stateNode=l,st=t,Le=qt(l.firstChild),Lt=!1,u=!0):u=!1),u||ka(t)),jr(t),u=t.type,f=t.pendingProps,y=e!==null?e.memoizedProps:null,l=f.children,zc(u,f)?l=null:y!==null&&zc(u,y)&&(t.flags|=32),t.memoizedState!==null&&(u=Uo(e,t,ev,null,null,n),_s._currentValue=u),Ti(e,t),lt(e,t,l,n),t.child;case 6:return e===null&&we&&((e=n=Le)&&(n=Pv(n,t.pendingProps,Lt),n!==null?(t.stateNode=n,st=t,Le=null,e=!0):e=!1),e||ka(t)),null;case 13:return Rf(e,t,n);case 4:return ra(t,t.stateNode.containerInfo),l=t.pendingProps,e===null?t.child=mr(t,null,l,n):lt(e,t,l,n),t.child;case 11:return xf(e,t,t.type,t.pendingProps,n);case 7:return lt(e,t,t.pendingProps,n),t.child;case 8:return lt(e,t,t.pendingProps.children,n),t.child;case 12:return lt(e,t,t.pendingProps.children,n),t.child;case 10:return l=t.pendingProps,Oa(t,t.type,l.value),lt(e,t,l.children,n),t.child;case 9:return u=t.type._context,l=t.pendingProps.children,ur(t),u=it(u),l=l(u),t.flags|=1,lt(e,t,l,n),t.child;case 14:return _f(e,t,t.type,t.pendingProps,n);case 15:return wf(e,t,t.type,t.pendingProps,n);case 19:return kf(e,t,n);case 31:return ov(e,t,n);case 22:return Sf(e,t,n,t.pendingProps);case 24:return ur(t),l=it(Ye),e===null?(u=jo(),u===null&&(u=Me,f=So(),u.pooledCache=f,f.refCount++,f!==null&&(u.pooledCacheLanes|=n),u=f),t.memoizedState={parent:l,cache:u},No(t),Oa(t,Ye,u)):((e.lanes&n)!==0&&(Eo(e,t),ts(t,null,null,n),es()),u=e.memoizedState,f=t.memoizedState,u.parent!==l?(u={parent:l,cache:l},t.memoizedState=u,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=u),Oa(t,Ye,l)):(l=f.cache,Oa(t,Ye,l),l!==u.cache&&wo(t,[Ye],n,!0))),lt(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(s(156,t.tag))}function pa(e){e.flags|=4}function cc(e,t,n,l,u){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(u&335544128)===u)if(e.stateNode.complete)e.flags|=8192;else if(sm())e.flags|=8192;else throw fr=pi,Ao}else e.flags&=-16777217}function Df(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!Qm(t))if(sm())e.flags|=8192;else throw fr=pi,Ao}function Oi(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?dd():536870912,e.lanes|=t,rn|=t)}function ls(e,t){if(!we)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var l=null;n!==null;)n.alternate!==null&&(l=n),n=n.sibling;l===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function Be(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,l=0;if(t)for(var u=e.child;u!==null;)n|=u.lanes|u.childLanes,l|=u.subtreeFlags&65011712,l|=u.flags&65011712,u.return=e,u=u.sibling;else for(u=e.child;u!==null;)n|=u.lanes|u.childLanes,l|=u.subtreeFlags,l|=u.flags,u.return=e,u=u.sibling;return e.subtreeFlags|=l,e.childLanes=n,t}function uv(e,t,n){var l=t.pendingProps;switch(yo(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Be(t),null;case 1:return Be(t),null;case 3:return n=t.stateNode,l=null,e!==null&&(l=e.memoizedState.cache),t.memoizedState.cache!==l&&(t.flags|=2048),da(Ye),na(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Fr(t)?pa(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,bo())),Be(t),null;case 26:var u=t.type,f=t.memoizedState;return e===null?(pa(t),f!==null?(Be(t),Df(t,f)):(Be(t),cc(t,u,null,l,n))):f?f!==e.memoizedState?(pa(t),Be(t),Df(t,f)):(Be(t),t.flags&=-16777217):(e=e.memoizedProps,e!==l&&pa(t),Be(t),cc(t,u,e,l,n)),null;case 27:if(Ar(t),n=ze.current,u=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==l&&pa(t);else{if(!l){if(t.stateNode===null)throw Error(s(166));return Be(t),null}e=me.current,Fr(t)?dh(t):(e=Pm(u,l,n),t.stateNode=e,pa(t))}return Be(t),null;case 5:if(Ar(t),u=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==l&&pa(t);else{if(!l){if(t.stateNode===null)throw Error(s(166));return Be(t),null}if(f=me.current,Fr(t))dh(t);else{var y=Yi(ze.current);switch(f){case 1:f=y.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:f=y.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":f=y.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":f=y.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":f=y.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof l.is=="string"?y.createElement("select",{is:l.is}):y.createElement("select"),l.multiple?f.multiple=!0:l.size&&(f.size=l.size);break;default:f=typeof l.is=="string"?y.createElement(u,{is:l.is}):y.createElement(u)}}f[nt]=t,f[ht]=l;e:for(y=t.child;y!==null;){if(y.tag===5||y.tag===6)f.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===t)break e;for(;y.sibling===null;){if(y.return===null||y.return===t)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}t.stateNode=f;e:switch(ot(f,u,l),u){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}l&&pa(t)}}return Be(t),cc(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==l&&pa(t);else{if(typeof l!="string"&&t.stateNode===null)throw Error(s(166));if(e=ze.current,Fr(t)){if(e=t.stateNode,n=t.memoizedProps,l=null,u=st,u!==null)switch(u.tag){case 27:case 5:l=u.memoizedProps}e[nt]=t,e=!!(e.nodeValue===n||l!==null&&l.suppressHydrationWarning===!0||Rm(e.nodeValue,n)),e||ka(t,!0)}else e=Yi(e).createTextNode(l),e[nt]=t,t.stateNode=e}return Be(t),null;case 31:if(n=t.memoizedState,e===null||e.memoizedState!==null){if(l=Fr(t),n!==null){if(e===null){if(!l)throw Error(s(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(557));e[nt]=t}else or(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Be(t),e=!1}else n=bo(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return t.flags&256?(jt(t),t):(jt(t),null);if((t.flags&128)!==0)throw Error(s(558))}return Be(t),null;case 13:if(l=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(u=Fr(t),l!==null&&l.dehydrated!==null){if(e===null){if(!u)throw Error(s(318));if(u=t.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(s(317));u[nt]=t}else or(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Be(t),u=!1}else u=bo(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=u),u=!0;if(!u)return t.flags&256?(jt(t),t):(jt(t),null)}return jt(t),(t.flags&128)!==0?(t.lanes=n,t):(n=l!==null,e=e!==null&&e.memoizedState!==null,n&&(l=t.child,u=null,l.alternate!==null&&l.alternate.memoizedState!==null&&l.alternate.memoizedState.cachePool!==null&&(u=l.alternate.memoizedState.cachePool.pool),f=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(f=l.memoizedState.cachePool.pool),f!==u&&(l.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),Oi(t,t.updateQueue),Be(t),null);case 4:return na(),e===null&&kc(t.stateNode.containerInfo),Be(t),null;case 10:return da(t.type),Be(t),null;case 19:if(Ne(Fe),l=t.memoizedState,l===null)return Be(t),null;if(u=(t.flags&128)!==0,f=l.rendering,f===null)if(u)ls(l,!1);else{if(Ve!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(f=bi(e),f!==null){for(t.flags|=128,ls(l,!1),e=f.updateQueue,t.updateQueue=e,Oi(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)ih(n,e),n=n.sibling;return Q(Fe,Fe.current&1|2),we&&ca(t,l.treeForkCount),t.child}e=e.sibling}l.tail!==null&&bt()>Li&&(t.flags|=128,u=!0,ls(l,!1),t.lanes=4194304)}else{if(!u)if(e=bi(f),e!==null){if(t.flags|=128,u=!0,e=e.updateQueue,t.updateQueue=e,Oi(t,e),ls(l,!0),l.tail===null&&l.tailMode==="hidden"&&!f.alternate&&!we)return Be(t),null}else 2*bt()-l.renderingStartTime>Li&&n!==536870912&&(t.flags|=128,u=!0,ls(l,!1),t.lanes=4194304);l.isBackwards?(f.sibling=t.child,t.child=f):(e=l.last,e!==null?e.sibling=f:t.child=f,l.last=f)}return l.tail!==null?(e=l.tail,l.rendering=e,l.tail=e.sibling,l.renderingStartTime=bt(),e.sibling=null,n=Fe.current,Q(Fe,u?n&1|2:n&1),we&&ca(t,l.treeForkCount),e):(Be(t),null);case 22:case 23:return jt(t),Oo(),l=t.memoizedState!==null,e!==null?e.memoizedState!==null!==l&&(t.flags|=8192):l&&(t.flags|=8192),l?(n&536870912)!==0&&(t.flags&128)===0&&(Be(t),t.subtreeFlags&6&&(t.flags|=8192)):Be(t),n=t.updateQueue,n!==null&&Oi(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),l=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(l=t.memoizedState.cachePool.pool),l!==n&&(t.flags|=2048),e!==null&&Ne(dr),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),da(Ye),Be(t),null;case 25:return null;case 30:return null}throw Error(s(156,t.tag))}function dv(e,t){switch(yo(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return da(Ye),na(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Ar(t),null;case 31:if(t.memoizedState!==null){if(jt(t),t.alternate===null)throw Error(s(340));or()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(jt(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(s(340));or()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ne(Fe),null;case 4:return na(),null;case 10:return da(t.type),null;case 22:case 23:return jt(t),Oo(),e!==null&&Ne(dr),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return da(Ye),null;case 25:return null;default:return null}}function Mf(e,t){switch(yo(t),t.tag){case 3:da(Ye),na();break;case 26:case 27:case 5:Ar(t);break;case 4:na();break;case 31:t.memoizedState!==null&&jt(t);break;case 13:jt(t);break;case 19:Ne(Fe);break;case 10:da(t.type);break;case 22:case 23:jt(t),Oo(),e!==null&&Ne(dr);break;case 24:da(Ye)}}function os(e,t){try{var n=t.updateQueue,l=n!==null?n.lastEffect:null;if(l!==null){var u=l.next;n=u;do{if((n.tag&e)===e){l=void 0;var f=n.create,y=n.inst;l=f(),y.destroy=l}n=n.next}while(n!==u)}}catch(w){Re(t,t.return,w)}}function Ba(e,t,n){try{var l=t.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var f=u.next;l=f;do{if((l.tag&e)===e){var y=l.inst,w=y.destroy;if(w!==void 0){y.destroy=void 0,u=t;var N=n,M=w;try{M()}catch(B){Re(u,N,B)}}}l=l.next}while(l!==f)}}catch(B){Re(t,t.return,B)}}function Uf(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{Ch(t,n)}catch(l){Re(e,e.return,l)}}}function zf(e,t,n){n.props=gr(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(l){Re(e,t,l)}}function cs(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var l=e.stateNode;break;case 30:l=e.stateNode;break;default:l=e.stateNode}typeof n=="function"?e.refCleanup=n(l):n.current=l}}catch(u){Re(e,t,u)}}function ea(e,t){var n=e.ref,l=e.refCleanup;if(n!==null)if(typeof l=="function")try{l()}catch(u){Re(e,t,u)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(u){Re(e,t,u)}else n.current=null}function Lf(e){var t=e.type,n=e.memoizedProps,l=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&l.focus();break e;case"img":n.src?l.src=n.src:n.srcSet&&(l.srcset=n.srcSet)}}catch(u){Re(e,e.return,u)}}function uc(e,t,n){try{var l=e.stateNode;Dv(l,e.type,n,t),l[ht]=t}catch(u){Re(e,e.return,u)}}function Bf(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Ga(e.type)||e.tag===4}function dc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Bf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Ga(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function hc(e,t,n){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=ia));else if(l!==4&&(l===27&&Ga(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(hc(e,t,n),e=e.sibling;e!==null;)hc(e,t,n),e=e.sibling}function Di(e,t,n){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(l!==4&&(l===27&&Ga(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(Di(e,t,n),e=e.sibling;e!==null;)Di(e,t,n),e=e.sibling}function qf(e){var t=e.stateNode,n=e.memoizedProps;try{for(var l=e.type,u=t.attributes;u.length;)t.removeAttributeNode(u[0]);ot(t,l,n),t[nt]=e,t[ht]=n}catch(f){Re(e,e.return,f)}}var ga=!1,We=!1,fc=!1,Pf=typeof WeakSet=="function"?WeakSet:Set,at=null;function hv(e,t){if(e=e.containerInfo,Mc=el,e=Jd(e),so(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var l=n.getSelection&&n.getSelection();if(l&&l.rangeCount!==0){n=l.anchorNode;var u=l.anchorOffset,f=l.focusNode;l=l.focusOffset;try{n.nodeType,f.nodeType}catch{n=null;break e}var y=0,w=-1,N=-1,M=0,B=0,$=e,U=null;t:for(;;){for(var z;$!==n||u!==0&&$.nodeType!==3||(w=y+u),$!==f||l!==0&&$.nodeType!==3||(N=y+l),$.nodeType===3&&(y+=$.nodeValue.length),(z=$.firstChild)!==null;)U=$,$=z;for(;;){if($===e)break t;if(U===n&&++M===u&&(w=y),U===f&&++B===l&&(N=y),(z=$.nextSibling)!==null)break;$=U,U=$.parentNode}$=z}n=w===-1||N===-1?null:{start:w,end:N}}else n=null}n=n||{start:0,end:0}}else n=null;for(Uc={focusedElem:e,selectionRange:n},el=!1,at=t;at!==null;)if(t=at,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,at=e;else for(;at!==null;){switch(t=at,f=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(n=0;n<e.length;n++)u=e[n],u.ref.impl=u.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&f!==null){e=void 0,n=t,u=f.memoizedProps,f=f.memoizedState,l=n.stateNode;try{var X=gr(n.type,u);e=l.getSnapshotBeforeUpdate(X,f),l.__reactInternalSnapshotBeforeUpdate=e}catch(le){Re(n,n.return,le)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)Bc(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Bc(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(s(163))}if(e=t.sibling,e!==null){e.return=t.return,at=e;break}at=t.return}}function $f(e,t,n){var l=n.flags;switch(n.tag){case 0:case 11:case 15:va(e,n),l&4&&os(5,n);break;case 1:if(va(e,n),l&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(y){Re(n,n.return,y)}else{var u=gr(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(u,t,e.__reactInternalSnapshotBeforeUpdate)}catch(y){Re(n,n.return,y)}}l&64&&Uf(n),l&512&&cs(n,n.return);break;case 3:if(va(e,n),l&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{Ch(e,t)}catch(y){Re(n,n.return,y)}}break;case 27:t===null&&l&4&&qf(n);case 26:case 5:va(e,n),t===null&&l&4&&Lf(n),l&512&&cs(n,n.return);break;case 12:va(e,n);break;case 31:va(e,n),l&4&&Ff(e,n);break;case 13:va(e,n),l&4&&Gf(e,n),l&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=_v.bind(null,n),$v(e,n))));break;case 22:if(l=n.memoizedState!==null||ga,!l){t=t!==null&&t.memoizedState!==null||We,u=ga;var f=We;ga=l,(We=t)&&!f?ba(e,n,(n.subtreeFlags&8772)!==0):va(e,n),ga=u,We=f}break;case 30:break;default:va(e,n)}}function Hf(e){var t=e.alternate;t!==null&&(e.alternate=null,Hf(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Hl(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var qe=null,mt=!1;function ya(e,t,n){for(n=n.child;n!==null;)Vf(e,t,n),n=n.sibling}function Vf(e,t,n){if(xt&&typeof xt.onCommitFiberUnmount=="function")try{xt.onCommitFiberUnmount(Dn,n)}catch{}switch(n.tag){case 26:We||ea(n,t),ya(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:We||ea(n,t);var l=qe,u=mt;Ga(n.type)&&(qe=n.stateNode,mt=!1),ya(e,t,n),vs(n.stateNode),qe=l,mt=u;break;case 5:We||ea(n,t);case 6:if(l=qe,u=mt,qe=null,ya(e,t,n),qe=l,mt=u,qe!==null)if(mt)try{(qe.nodeType===9?qe.body:qe.nodeName==="HTML"?qe.ownerDocument.body:qe).removeChild(n.stateNode)}catch(f){Re(n,t,f)}else try{qe.removeChild(n.stateNode)}catch(f){Re(n,t,f)}break;case 18:qe!==null&&(mt?(e=qe,Um(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,n.stateNode),hn(e)):Um(qe,n.stateNode));break;case 4:l=qe,u=mt,qe=n.stateNode.containerInfo,mt=!0,ya(e,t,n),qe=l,mt=u;break;case 0:case 11:case 14:case 15:Ba(2,n,t),We||Ba(4,n,t),ya(e,t,n);break;case 1:We||(ea(n,t),l=n.stateNode,typeof l.componentWillUnmount=="function"&&zf(n,t,l)),ya(e,t,n);break;case 21:ya(e,t,n);break;case 22:We=(l=We)||n.memoizedState!==null,ya(e,t,n),We=l;break;default:ya(e,t,n)}}function Ff(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{hn(e)}catch(n){Re(t,t.return,n)}}}function Gf(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{hn(e)}catch(n){Re(t,t.return,n)}}function fv(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new Pf),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new Pf),t;default:throw Error(s(435,e.tag))}}function Mi(e,t){var n=fv(e);t.forEach(function(l){if(!n.has(l)){n.add(l);var u=wv.bind(null,e,l);l.then(u,u)}})}function pt(e,t){var n=t.deletions;if(n!==null)for(var l=0;l<n.length;l++){var u=n[l],f=e,y=t,w=y;e:for(;w!==null;){switch(w.tag){case 27:if(Ga(w.type)){qe=w.stateNode,mt=!1;break e}break;case 5:qe=w.stateNode,mt=!1;break e;case 3:case 4:qe=w.stateNode.containerInfo,mt=!0;break e}w=w.return}if(qe===null)throw Error(s(160));Vf(f,y,u),qe=null,mt=!1,f=u.alternate,f!==null&&(f.return=null),u.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)If(t,e),t=t.sibling}var Ht=null;function If(e,t){var n=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:pt(t,e),gt(e),l&4&&(Ba(3,e,e.return),os(3,e),Ba(5,e,e.return));break;case 1:pt(t,e),gt(e),l&512&&(We||n===null||ea(n,n.return)),l&64&&ga&&(e=e.updateQueue,e!==null&&(l=e.callbacks,l!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?l:n.concat(l))));break;case 26:var u=Ht;if(pt(t,e),gt(e),l&512&&(We||n===null||ea(n,n.return)),l&4){var f=n!==null?n.memoizedState:null;if(l=e.memoizedState,n===null)if(l===null)if(e.stateNode===null){e:{l=e.type,n=e.memoizedProps,u=u.ownerDocument||u;t:switch(l){case"title":f=u.getElementsByTagName("title")[0],(!f||f[zn]||f[nt]||f.namespaceURI==="http://www.w3.org/2000/svg"||f.hasAttribute("itemprop"))&&(f=u.createElement(l),u.head.insertBefore(f,u.querySelector("head > title"))),ot(f,l,n),f[nt]=e,tt(f),l=f;break e;case"link":var y=Im("link","href",u).get(l+(n.href||""));if(y){for(var w=0;w<y.length;w++)if(f=y[w],f.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&f.getAttribute("rel")===(n.rel==null?null:n.rel)&&f.getAttribute("title")===(n.title==null?null:n.title)&&f.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){y.splice(w,1);break t}}f=u.createElement(l),ot(f,l,n),u.head.appendChild(f);break;case"meta":if(y=Im("meta","content",u).get(l+(n.content||""))){for(w=0;w<y.length;w++)if(f=y[w],f.getAttribute("content")===(n.content==null?null:""+n.content)&&f.getAttribute("name")===(n.name==null?null:n.name)&&f.getAttribute("property")===(n.property==null?null:n.property)&&f.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&f.getAttribute("charset")===(n.charSet==null?null:n.charSet)){y.splice(w,1);break t}}f=u.createElement(l),ot(f,l,n),u.head.appendChild(f);break;default:throw Error(s(468,l))}f[nt]=e,tt(f),l=f}e.stateNode=l}else Ym(u,e.type,e.stateNode);else e.stateNode=Gm(u,l,e.memoizedProps);else f!==l?(f===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):f.count--,l===null?Ym(u,e.type,e.stateNode):Gm(u,l,e.memoizedProps)):l===null&&e.stateNode!==null&&uc(e,e.memoizedProps,n.memoizedProps)}break;case 27:pt(t,e),gt(e),l&512&&(We||n===null||ea(n,n.return)),n!==null&&l&4&&uc(e,e.memoizedProps,n.memoizedProps);break;case 5:if(pt(t,e),gt(e),l&512&&(We||n===null||ea(n,n.return)),e.flags&32){u=e.stateNode;try{Mr(u,"")}catch(X){Re(e,e.return,X)}}l&4&&e.stateNode!=null&&(u=e.memoizedProps,uc(e,u,n!==null?n.memoizedProps:u)),l&1024&&(fc=!0);break;case 6:if(pt(t,e),gt(e),l&4){if(e.stateNode===null)throw Error(s(162));l=e.memoizedProps,n=e.stateNode;try{n.nodeValue=l}catch(X){Re(e,e.return,X)}}break;case 3:if(Wi=null,u=Ht,Ht=Qi(t.containerInfo),pt(t,e),Ht=u,gt(e),l&4&&n!==null&&n.memoizedState.isDehydrated)try{hn(t.containerInfo)}catch(X){Re(e,e.return,X)}fc&&(fc=!1,Yf(e));break;case 4:l=Ht,Ht=Qi(e.stateNode.containerInfo),pt(t,e),gt(e),Ht=l;break;case 12:pt(t,e),gt(e);break;case 31:pt(t,e),gt(e),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,Mi(e,l)));break;case 13:pt(t,e),gt(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(zi=bt()),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,Mi(e,l)));break;case 22:u=e.memoizedState!==null;var N=n!==null&&n.memoizedState!==null,M=ga,B=We;if(ga=M||u,We=B||N,pt(t,e),We=B,ga=M,gt(e),l&8192)e:for(t=e.stateNode,t._visibility=u?t._visibility&-2:t._visibility|1,u&&(n===null||N||ga||We||yr(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){N=n=t;try{if(f=N.stateNode,u)y=f.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none";else{w=N.stateNode;var $=N.memoizedProps.style,U=$!=null&&$.hasOwnProperty("display")?$.display:null;w.style.display=U==null||typeof U=="boolean"?"":(""+U).trim()}}catch(X){Re(N,N.return,X)}}}else if(t.tag===6){if(n===null){N=t;try{N.stateNode.nodeValue=u?"":N.memoizedProps}catch(X){Re(N,N.return,X)}}}else if(t.tag===18){if(n===null){N=t;try{var z=N.stateNode;u?zm(z,!0):zm(N.stateNode,!1)}catch(X){Re(N,N.return,X)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}l&4&&(l=e.updateQueue,l!==null&&(n=l.retryQueue,n!==null&&(l.retryQueue=null,Mi(e,n))));break;case 19:pt(t,e),gt(e),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,Mi(e,l)));break;case 30:break;case 21:break;default:pt(t,e),gt(e)}}function gt(e){var t=e.flags;if(t&2){try{for(var n,l=e.return;l!==null;){if(Bf(l)){n=l;break}l=l.return}if(n==null)throw Error(s(160));switch(n.tag){case 27:var u=n.stateNode,f=dc(e);Di(e,f,u);break;case 5:var y=n.stateNode;n.flags&32&&(Mr(y,""),n.flags&=-33);var w=dc(e);Di(e,w,y);break;case 3:case 4:var N=n.stateNode.containerInfo,M=dc(e);hc(e,M,N);break;default:throw Error(s(161))}}catch(B){Re(e,e.return,B)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Yf(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;Yf(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function va(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)$f(e,t.alternate,t),t=t.sibling}function yr(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Ba(4,t,t.return),yr(t);break;case 1:ea(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&zf(t,t.return,n),yr(t);break;case 27:vs(t.stateNode);case 26:case 5:ea(t,t.return),yr(t);break;case 22:t.memoizedState===null&&yr(t);break;case 30:yr(t);break;default:yr(t)}e=e.sibling}}function ba(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var l=t.alternate,u=e,f=t,y=f.flags;switch(f.tag){case 0:case 11:case 15:ba(u,f,n),os(4,f);break;case 1:if(ba(u,f,n),l=f,u=l.stateNode,typeof u.componentDidMount=="function")try{u.componentDidMount()}catch(M){Re(l,l.return,M)}if(l=f,u=l.updateQueue,u!==null){var w=l.stateNode;try{var N=u.shared.hiddenCallbacks;if(N!==null)for(u.shared.hiddenCallbacks=null,u=0;u<N.length;u++)Sh(N[u],w)}catch(M){Re(l,l.return,M)}}n&&y&64&&Uf(f),cs(f,f.return);break;case 27:qf(f);case 26:case 5:ba(u,f,n),n&&l===null&&y&4&&Lf(f),cs(f,f.return);break;case 12:ba(u,f,n);break;case 31:ba(u,f,n),n&&y&4&&Ff(u,f);break;case 13:ba(u,f,n),n&&y&4&&Gf(u,f);break;case 22:f.memoizedState===null&&ba(u,f,n),cs(f,f.return);break;case 30:break;default:ba(u,f,n)}t=t.sibling}}function mc(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&Kn(n))}function pc(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Kn(e))}function Vt(e,t,n,l){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Qf(e,t,n,l),t=t.sibling}function Qf(e,t,n,l){var u=t.flags;switch(t.tag){case 0:case 11:case 15:Vt(e,t,n,l),u&2048&&os(9,t);break;case 1:Vt(e,t,n,l);break;case 3:Vt(e,t,n,l),u&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Kn(e)));break;case 12:if(u&2048){Vt(e,t,n,l),e=t.stateNode;try{var f=t.memoizedProps,y=f.id,w=f.onPostCommit;typeof w=="function"&&w(y,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(N){Re(t,t.return,N)}}else Vt(e,t,n,l);break;case 31:Vt(e,t,n,l);break;case 13:Vt(e,t,n,l);break;case 23:break;case 22:f=t.stateNode,y=t.alternate,t.memoizedState!==null?f._visibility&2?Vt(e,t,n,l):us(e,t):f._visibility&2?Vt(e,t,n,l):(f._visibility|=2,en(e,t,n,l,(t.subtreeFlags&10256)!==0||!1)),u&2048&&mc(y,t);break;case 24:Vt(e,t,n,l),u&2048&&pc(t.alternate,t);break;default:Vt(e,t,n,l)}}function en(e,t,n,l,u){for(u=u&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var f=e,y=t,w=n,N=l,M=y.flags;switch(y.tag){case 0:case 11:case 15:en(f,y,w,N,u),os(8,y);break;case 23:break;case 22:var B=y.stateNode;y.memoizedState!==null?B._visibility&2?en(f,y,w,N,u):us(f,y):(B._visibility|=2,en(f,y,w,N,u)),u&&M&2048&&mc(y.alternate,y);break;case 24:en(f,y,w,N,u),u&&M&2048&&pc(y.alternate,y);break;default:en(f,y,w,N,u)}t=t.sibling}}function us(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,l=t,u=l.flags;switch(l.tag){case 22:us(n,l),u&2048&&mc(l.alternate,l);break;case 24:us(n,l),u&2048&&pc(l.alternate,l);break;default:us(n,l)}t=t.sibling}}var ds=8192;function tn(e,t,n){if(e.subtreeFlags&ds)for(e=e.child;e!==null;)Kf(e,t,n),e=e.sibling}function Kf(e,t,n){switch(e.tag){case 26:tn(e,t,n),e.flags&ds&&e.memoizedState!==null&&Zv(n,Ht,e.memoizedState,e.memoizedProps);break;case 5:tn(e,t,n);break;case 3:case 4:var l=Ht;Ht=Qi(e.stateNode.containerInfo),tn(e,t,n),Ht=l;break;case 22:e.memoizedState===null&&(l=e.alternate,l!==null&&l.memoizedState!==null?(l=ds,ds=16777216,tn(e,t,n),ds=l):tn(e,t,n));break;default:tn(e,t,n)}}function Wf(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function hs(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var l=t[n];at=l,Xf(l,e)}Wf(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Jf(e),e=e.sibling}function Jf(e){switch(e.tag){case 0:case 11:case 15:hs(e),e.flags&2048&&Ba(9,e,e.return);break;case 3:hs(e);break;case 12:hs(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Ui(e)):hs(e);break;default:hs(e)}}function Ui(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var l=t[n];at=l,Xf(l,e)}Wf(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:Ba(8,t,t.return),Ui(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,Ui(t));break;default:Ui(t)}e=e.sibling}}function Xf(e,t){for(;at!==null;){var n=at;switch(n.tag){case 0:case 11:case 15:Ba(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var l=n.memoizedState.cachePool.pool;l!=null&&l.refCount++}break;case 24:Kn(n.memoizedState.cache)}if(l=n.child,l!==null)l.return=n,at=l;else e:for(n=e;at!==null;){l=at;var u=l.sibling,f=l.return;if(Hf(l),l===n){at=null;break e}if(u!==null){u.return=f,at=u;break e}at=f}}}var mv={getCacheForType:function(e){var t=it(Ye),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return it(Ye).controller.signal}},pv=typeof WeakMap=="function"?WeakMap:Map,je=0,Me=null,ge=null,be=0,Ee=0,At=null,qa=!1,an=!1,gc=!1,xa=0,Ve=0,Pa=0,vr=0,yc=0,Nt=0,rn=0,fs=null,yt=null,vc=!1,zi=0,Zf=0,Li=1/0,Bi=null,$a=null,Xe=0,Ha=null,nn=null,_a=0,bc=0,xc=null,em=null,ms=0,_c=null;function Et(){return(je&2)!==0&&be!==0?be&-be:L.T!==null?Nc():pd()}function tm(){if(Nt===0)if((be&536870912)===0||we){var e=Is;Is<<=1,(Is&3932160)===0&&(Is=262144),Nt=e}else Nt=536870912;return e=Ct.current,e!==null&&(e.flags|=32),Nt}function vt(e,t,n){(e===Me&&(Ee===2||Ee===9)||e.cancelPendingCommit!==null)&&(sn(e,0),Va(e,be,Nt,!1)),Un(e,n),((je&2)===0||e!==Me)&&(e===Me&&((je&2)===0&&(vr|=n),Ve===4&&Va(e,be,Nt,!1)),ta(e))}function am(e,t,n){if((je&6)!==0)throw Error(s(327));var l=!n&&(t&127)===0&&(t&e.expiredLanes)===0||Mn(e,t),u=l?vv(e,t):Sc(e,t,!0),f=l;do{if(u===0){an&&!l&&Va(e,t,0,!1);break}else{if(n=e.current.alternate,f&&!gv(n)){u=Sc(e,t,!1),f=!1;continue}if(u===2){if(f=t,e.errorRecoveryDisabledLanes&f)var y=0;else y=e.pendingLanes&-536870913,y=y!==0?y:y&536870912?536870912:0;if(y!==0){t=y;e:{var w=e;u=fs;var N=w.current.memoizedState.isDehydrated;if(N&&(sn(w,y).flags|=256),y=Sc(w,y,!1),y!==2){if(gc&&!N){w.errorRecoveryDisabledLanes|=f,vr|=f,u=4;break e}f=yt,yt=u,f!==null&&(yt===null?yt=f:yt.push.apply(yt,f))}u=y}if(f=!1,u!==2)continue}}if(u===1){sn(e,0),Va(e,t,0,!0);break}e:{switch(l=e,f=u,f){case 0:case 1:throw Error(s(345));case 4:if((t&4194048)!==t)break;case 6:Va(l,t,Nt,!qa);break e;case 2:yt=null;break;case 3:case 5:break;default:throw Error(s(329))}if((t&62914560)===t&&(u=zi+300-bt(),10<u)){if(Va(l,t,Nt,!qa),Qs(l,0,!0)!==0)break e;_a=t,l.timeoutHandle=Dm(rm.bind(null,l,n,yt,Bi,vc,t,Nt,vr,rn,qa,f,"Throttled",-0,0),u);break e}rm(l,n,yt,Bi,vc,t,Nt,vr,rn,qa,f,null,-0,0)}}break}while(!0);ta(e)}function rm(e,t,n,l,u,f,y,w,N,M,B,$,U,z){if(e.timeoutHandle=-1,$=t.subtreeFlags,$&8192||($&16785408)===16785408){$={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ia},Kf(t,f,$);var X=(f&62914560)===f?zi-bt():(f&4194048)===f?Zf-bt():0;if(X=eb($,X),X!==null){_a=f,e.cancelPendingCommit=X(dm.bind(null,e,t,f,n,l,u,y,w,N,B,$,null,U,z)),Va(e,f,y,!M);return}}dm(e,t,f,n,l,u,y,w,N)}function gv(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var l=0;l<n.length;l++){var u=n[l],f=u.getSnapshot;u=u.value;try{if(!wt(f(),u))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Va(e,t,n,l){t&=~yc,t&=~vr,e.suspendedLanes|=t,e.pingedLanes&=~t,l&&(e.warmLanes|=t),l=e.expirationTimes;for(var u=t;0<u;){var f=31-_t(u),y=1<<f;l[f]=-1,u&=~y}n!==0&&hd(e,n,t)}function qi(){return(je&6)===0?(ps(0),!1):!0}function wc(){if(ge!==null){if(Ee===0)var e=ge.return;else e=ge,ua=cr=null,Bo(e),Kr=null,Jn=0,e=ge;for(;e!==null;)Mf(e.alternate,e),e=e.return;ge=null}}function sn(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,zv(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),_a=0,wc(),Me=e,ge=n=oa(e.current,null),be=t,Ee=0,At=null,qa=!1,an=Mn(e,t),gc=!1,rn=Nt=yc=vr=Pa=Ve=0,yt=fs=null,vc=!1,(t&8)!==0&&(t|=t&32);var l=e.entangledLanes;if(l!==0)for(e=e.entanglements,l&=t;0<l;){var u=31-_t(l),f=1<<u;t|=e[u],l&=~f}return xa=t,ii(),n}function nm(e,t){he=null,L.H=ss,t===Qr||t===mi?(t=bh(),Ee=3):t===Ao?(t=bh(),Ee=4):Ee=t===ec?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,At=t,ge===null&&(Ve=1,Ei(e,Mt(t,e.current)))}function sm(){var e=Ct.current;return e===null?!0:(be&4194048)===be?Bt===null:(be&62914560)===be||(be&536870912)!==0?e===Bt:!1}function im(){var e=L.H;return L.H=ss,e===null?ss:e}function lm(){var e=L.A;return L.A=mv,e}function Pi(){Ve=4,qa||(be&4194048)!==be&&Ct.current!==null||(an=!0),(Pa&134217727)===0&&(vr&134217727)===0||Me===null||Va(Me,be,Nt,!1)}function Sc(e,t,n){var l=je;je|=2;var u=im(),f=lm();(Me!==e||be!==t)&&(Bi=null,sn(e,t)),t=!1;var y=Ve;e:do try{if(Ee!==0&&ge!==null){var w=ge,N=At;switch(Ee){case 8:wc(),y=6;break e;case 3:case 2:case 9:case 6:Ct.current===null&&(t=!0);var M=Ee;if(Ee=0,At=null,ln(e,w,N,M),n&&an){y=0;break e}break;default:M=Ee,Ee=0,At=null,ln(e,w,N,M)}}yv(),y=Ve;break}catch(B){nm(e,B)}while(!0);return t&&e.shellSuspendCounter++,ua=cr=null,je=l,L.H=u,L.A=f,ge===null&&(Me=null,be=0,ii()),y}function yv(){for(;ge!==null;)om(ge)}function vv(e,t){var n=je;je|=2;var l=im(),u=lm();Me!==e||be!==t?(Bi=null,Li=bt()+500,sn(e,t)):an=Mn(e,t);e:do try{if(Ee!==0&&ge!==null){t=ge;var f=At;t:switch(Ee){case 1:Ee=0,At=null,ln(e,t,f,1);break;case 2:case 9:if(yh(f)){Ee=0,At=null,cm(t);break}t=function(){Ee!==2&&Ee!==9||Me!==e||(Ee=7),ta(e)},f.then(t,t);break e;case 3:Ee=7;break e;case 4:Ee=5;break e;case 7:yh(f)?(Ee=0,At=null,cm(t)):(Ee=0,At=null,ln(e,t,f,7));break;case 5:var y=null;switch(ge.tag){case 26:y=ge.memoizedState;case 5:case 27:var w=ge;if(y?Qm(y):w.stateNode.complete){Ee=0,At=null;var N=w.sibling;if(N!==null)ge=N;else{var M=w.return;M!==null?(ge=M,$i(M)):ge=null}break t}}Ee=0,At=null,ln(e,t,f,5);break;case 6:Ee=0,At=null,ln(e,t,f,6);break;case 8:wc(),Ve=6;break e;default:throw Error(s(462))}}bv();break}catch(B){nm(e,B)}while(!0);return ua=cr=null,L.H=l,L.A=u,je=n,ge!==null?0:(Me=null,be=0,ii(),Ve)}function bv(){for(;ge!==null&&!Hy();)om(ge)}function om(e){var t=Of(e.alternate,e,xa);e.memoizedProps=e.pendingProps,t===null?$i(e):ge=t}function cm(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Af(n,t,t.pendingProps,t.type,void 0,be);break;case 11:t=Af(n,t,t.pendingProps,t.type.render,t.ref,be);break;case 5:Bo(t);default:Mf(n,t),t=ge=ih(t,xa),t=Of(n,t,xa)}e.memoizedProps=e.pendingProps,t===null?$i(e):ge=t}function ln(e,t,n,l){ua=cr=null,Bo(t),Kr=null,Jn=0;var u=t.return;try{if(lv(e,u,t,n,be)){Ve=1,Ei(e,Mt(n,e.current)),ge=null;return}}catch(f){if(u!==null)throw ge=u,f;Ve=1,Ei(e,Mt(n,e.current)),ge=null;return}t.flags&32768?(we||l===1?e=!0:an||(be&536870912)!==0?e=!1:(qa=e=!0,(l===2||l===9||l===3||l===6)&&(l=Ct.current,l!==null&&l.tag===13&&(l.flags|=16384))),um(t,e)):$i(t)}function $i(e){var t=e;do{if((t.flags&32768)!==0){um(t,qa);return}e=t.return;var n=uv(t.alternate,t,xa);if(n!==null){ge=n;return}if(t=t.sibling,t!==null){ge=t;return}ge=t=e}while(t!==null);Ve===0&&(Ve=5)}function um(e,t){do{var n=dv(e.alternate,e);if(n!==null){n.flags&=32767,ge=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){ge=e;return}ge=e=n}while(e!==null);Ve=6,ge=null}function dm(e,t,n,l,u,f,y,w,N){e.cancelPendingCommit=null;do Hi();while(Xe!==0);if((je&6)!==0)throw Error(s(327));if(t!==null){if(t===e.current)throw Error(s(177));if(f=t.lanes|t.childLanes,f|=uo,Xy(e,n,f,y,w,N),e===Me&&(ge=Me=null,be=0),nn=t,Ha=e,_a=n,bc=f,xc=u,em=l,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Sv(Fs,function(){return gm(),null})):(e.callbackNode=null,e.callbackPriority=0),l=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||l){l=L.T,L.T=null,u=Y.p,Y.p=2,y=je,je|=4;try{hv(e,t,n)}finally{je=y,Y.p=u,L.T=l}}Xe=1,hm(),fm(),mm()}}function hm(){if(Xe===1){Xe=0;var e=Ha,t=nn,n=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||n){n=L.T,L.T=null;var l=Y.p;Y.p=2;var u=je;je|=4;try{If(t,e);var f=Uc,y=Jd(e.containerInfo),w=f.focusedElem,N=f.selectionRange;if(y!==w&&w&&w.ownerDocument&&Wd(w.ownerDocument.documentElement,w)){if(N!==null&&so(w)){var M=N.start,B=N.end;if(B===void 0&&(B=M),"selectionStart"in w)w.selectionStart=M,w.selectionEnd=Math.min(B,w.value.length);else{var $=w.ownerDocument||document,U=$&&$.defaultView||window;if(U.getSelection){var z=U.getSelection(),X=w.textContent.length,le=Math.min(N.start,X),De=N.end===void 0?le:Math.min(N.end,X);!z.extend&&le>De&&(y=De,De=le,le=y);var T=Kd(w,le),E=Kd(w,De);if(T&&E&&(z.rangeCount!==1||z.anchorNode!==T.node||z.anchorOffset!==T.offset||z.focusNode!==E.node||z.focusOffset!==E.offset)){var D=$.createRange();D.setStart(T.node,T.offset),z.removeAllRanges(),le>De?(z.addRange(D),z.extend(E.node,E.offset)):(D.setEnd(E.node,E.offset),z.addRange(D))}}}}for($=[],z=w;z=z.parentNode;)z.nodeType===1&&$.push({element:z,left:z.scrollLeft,top:z.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<$.length;w++){var P=$[w];P.element.scrollLeft=P.left,P.element.scrollTop=P.top}}el=!!Mc,Uc=Mc=null}finally{je=u,Y.p=l,L.T=n}}e.current=t,Xe=2}}function fm(){if(Xe===2){Xe=0;var e=Ha,t=nn,n=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||n){n=L.T,L.T=null;var l=Y.p;Y.p=2;var u=je;je|=4;try{$f(e,t.alternate,t)}finally{je=u,Y.p=l,L.T=n}}Xe=3}}function mm(){if(Xe===4||Xe===3){Xe=0,Vy();var e=Ha,t=nn,n=_a,l=em;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Xe=5:(Xe=0,nn=Ha=null,pm(e,e.pendingLanes));var u=e.pendingLanes;if(u===0&&($a=null),Pl(n),t=t.stateNode,xt&&typeof xt.onCommitFiberRoot=="function")try{xt.onCommitFiberRoot(Dn,t,void 0,(t.current.flags&128)===128)}catch{}if(l!==null){t=L.T,u=Y.p,Y.p=2,L.T=null;try{for(var f=e.onRecoverableError,y=0;y<l.length;y++){var w=l[y];f(w.value,{componentStack:w.stack})}}finally{L.T=t,Y.p=u}}(_a&3)!==0&&Hi(),ta(e),u=e.pendingLanes,(n&261930)!==0&&(u&42)!==0?e===_c?ms++:(ms=0,_c=e):ms=0,ps(0)}}function pm(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,Kn(t)))}function Hi(){return hm(),fm(),mm(),gm()}function gm(){if(Xe!==5)return!1;var e=Ha,t=bc;bc=0;var n=Pl(_a),l=L.T,u=Y.p;try{Y.p=32>n?32:n,L.T=null,n=xc,xc=null;var f=Ha,y=_a;if(Xe=0,nn=Ha=null,_a=0,(je&6)!==0)throw Error(s(331));var w=je;if(je|=4,Jf(f.current),Qf(f,f.current,y,n),je=w,ps(0,!1),xt&&typeof xt.onPostCommitFiberRoot=="function")try{xt.onPostCommitFiberRoot(Dn,f)}catch{}return!0}finally{Y.p=u,L.T=l,pm(e,t)}}function ym(e,t,n){t=Mt(n,t),t=Zo(e.stateNode,t,2),e=Ua(e,t,2),e!==null&&(Un(e,2),ta(e))}function Re(e,t,n){if(e.tag===3)ym(e,e,n);else for(;t!==null;){if(t.tag===3){ym(t,e,n);break}else if(t.tag===1){var l=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&($a===null||!$a.has(l))){e=Mt(n,e),n=vf(2),l=Ua(t,n,2),l!==null&&(bf(n,l,t,e),Un(l,2),ta(l));break}}t=t.return}}function Cc(e,t,n){var l=e.pingCache;if(l===null){l=e.pingCache=new pv;var u=new Set;l.set(t,u)}else u=l.get(t),u===void 0&&(u=new Set,l.set(t,u));u.has(n)||(gc=!0,u.add(n),e=xv.bind(null,e,t,n),t.then(e,e))}function xv(e,t,n){var l=e.pingCache;l!==null&&l.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,Me===e&&(be&n)===n&&(Ve===4||Ve===3&&(be&62914560)===be&&300>bt()-zi?(je&2)===0&&sn(e,0):yc|=n,rn===be&&(rn=0)),ta(e)}function vm(e,t){t===0&&(t=dd()),e=ir(e,t),e!==null&&(Un(e,t),ta(e))}function _v(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),vm(e,n)}function wv(e,t){var n=0;switch(e.tag){case 31:case 13:var l=e.stateNode,u=e.memoizedState;u!==null&&(n=u.retryLane);break;case 19:l=e.stateNode;break;case 22:l=e.stateNode._retryCache;break;default:throw Error(s(314))}l!==null&&l.delete(t),vm(e,n)}function Sv(e,t){return zl(e,t)}var Vi=null,on=null,jc=!1,Fi=!1,Ac=!1,Fa=0;function ta(e){e!==on&&e.next===null&&(on===null?Vi=on=e:on=on.next=e),Fi=!0,jc||(jc=!0,jv())}function ps(e,t){if(!Ac&&Fi){Ac=!0;do for(var n=!1,l=Vi;l!==null;){if(e!==0){var u=l.pendingLanes;if(u===0)var f=0;else{var y=l.suspendedLanes,w=l.pingedLanes;f=(1<<31-_t(42|e)+1)-1,f&=u&~(y&~w),f=f&201326741?f&201326741|1:f?f|2:0}f!==0&&(n=!0,wm(l,f))}else f=be,f=Qs(l,l===Me?f:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),(f&3)===0||Mn(l,f)||(n=!0,wm(l,f));l=l.next}while(n);Ac=!1}}function Cv(){bm()}function bm(){Fi=jc=!1;var e=0;Fa!==0&&Uv()&&(e=Fa);for(var t=bt(),n=null,l=Vi;l!==null;){var u=l.next,f=xm(l,t);f===0?(l.next=null,n===null?Vi=u:n.next=u,u===null&&(on=n)):(n=l,(e!==0||(f&3)!==0)&&(Fi=!0)),l=u}Xe!==0&&Xe!==5||ps(e),Fa!==0&&(Fa=0)}function xm(e,t){for(var n=e.suspendedLanes,l=e.pingedLanes,u=e.expirationTimes,f=e.pendingLanes&-62914561;0<f;){var y=31-_t(f),w=1<<y,N=u[y];N===-1?((w&n)===0||(w&l)!==0)&&(u[y]=Jy(w,t)):N<=t&&(e.expiredLanes|=w),f&=~w}if(t=Me,n=be,n=Qs(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),l=e.callbackNode,n===0||e===t&&(Ee===2||Ee===9)||e.cancelPendingCommit!==null)return l!==null&&l!==null&&Ll(l),e.callbackNode=null,e.callbackPriority=0;if((n&3)===0||Mn(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(l!==null&&Ll(l),Pl(n)){case 2:case 8:n=cd;break;case 32:n=Fs;break;case 268435456:n=ud;break;default:n=Fs}return l=_m.bind(null,e),n=zl(n,l),e.callbackPriority=t,e.callbackNode=n,t}return l!==null&&l!==null&&Ll(l),e.callbackPriority=2,e.callbackNode=null,2}function _m(e,t){if(Xe!==0&&Xe!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(Hi()&&e.callbackNode!==n)return null;var l=be;return l=Qs(e,e===Me?l:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),l===0?null:(am(e,l,t),xm(e,bt()),e.callbackNode!=null&&e.callbackNode===n?_m.bind(null,e):null)}function wm(e,t){if(Hi())return null;am(e,t,!0)}function jv(){Lv(function(){(je&6)!==0?zl(od,Cv):bm()})}function Nc(){if(Fa===0){var e=Ir;e===0&&(e=Gs,Gs<<=1,(Gs&261888)===0&&(Gs=256)),Fa=e}return Fa}function Sm(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Xs(""+e)}function Cm(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function Av(e,t,n,l,u){if(t==="submit"&&n&&n.stateNode===u){var f=Sm((u[ht]||null).action),y=l.submitter;y&&(t=(t=y[ht]||null)?Sm(t.formAction):y.getAttribute("formAction"),t!==null&&(f=t,y=null));var w=new ai("action","action",null,l,u);e.push({event:w,listeners:[{instance:null,listener:function(){if(l.defaultPrevented){if(Fa!==0){var N=y?Cm(u,y):new FormData(u);Yo(n,{pending:!0,data:N,method:u.method,action:f},null,N)}}else typeof f=="function"&&(w.preventDefault(),N=y?Cm(u,y):new FormData(u),Yo(n,{pending:!0,data:N,method:u.method,action:f},f,N))},currentTarget:u}]})}}for(var Ec=0;Ec<co.length;Ec++){var Rc=co[Ec],Nv=Rc.toLowerCase(),Ev=Rc[0].toUpperCase()+Rc.slice(1);$t(Nv,"on"+Ev)}$t(eh,"onAnimationEnd"),$t(th,"onAnimationIteration"),$t(ah,"onAnimationStart"),$t("dblclick","onDoubleClick"),$t("focusin","onFocus"),$t("focusout","onBlur"),$t(F0,"onTransitionRun"),$t(G0,"onTransitionStart"),$t(I0,"onTransitionCancel"),$t(rh,"onTransitionEnd"),Or("onMouseEnter",["mouseout","mouseover"]),Or("onMouseLeave",["mouseout","mouseover"]),Or("onPointerEnter",["pointerout","pointerover"]),Or("onPointerLeave",["pointerout","pointerover"]),ar("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ar("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ar("onBeforeInput",["compositionend","keypress","textInput","paste"]),ar("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ar("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ar("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var gs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Rv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(gs));function jm(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var l=e[n],u=l.event;l=l.listeners;e:{var f=void 0;if(t)for(var y=l.length-1;0<=y;y--){var w=l[y],N=w.instance,M=w.currentTarget;if(w=w.listener,N!==f&&u.isPropagationStopped())break e;f=w,u.currentTarget=M;try{f(u)}catch(B){si(B)}u.currentTarget=null,f=N}else for(y=0;y<l.length;y++){if(w=l[y],N=w.instance,M=w.currentTarget,w=w.listener,N!==f&&u.isPropagationStopped())break e;f=w,u.currentTarget=M;try{f(u)}catch(B){si(B)}u.currentTarget=null,f=N}}}}function ye(e,t){var n=t[$l];n===void 0&&(n=t[$l]=new Set);var l=e+"__bubble";n.has(l)||(Am(t,e,2,!1),n.add(l))}function Tc(e,t,n){var l=0;t&&(l|=4),Am(n,e,l,t)}var Gi="_reactListening"+Math.random().toString(36).slice(2);function kc(e){if(!e[Gi]){e[Gi]=!0,vd.forEach(function(n){n!=="selectionchange"&&(Rv.has(n)||Tc(n,!1,e),Tc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Gi]||(t[Gi]=!0,Tc("selectionchange",!1,t))}}function Am(e,t,n,l){switch(tp(t)){case 2:var u=rb;break;case 8:u=nb;break;default:u=Ic}n=u.bind(null,t,n,e),u=void 0,!Wl||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(u=!0),l?u!==void 0?e.addEventListener(t,n,{capture:!0,passive:u}):e.addEventListener(t,n,!0):u!==void 0?e.addEventListener(t,n,{passive:u}):e.addEventListener(t,n,!1)}function Oc(e,t,n,l,u){var f=l;if((t&1)===0&&(t&2)===0&&l!==null)e:for(;;){if(l===null)return;var y=l.tag;if(y===3||y===4){var w=l.stateNode.containerInfo;if(w===u)break;if(y===4)for(y=l.return;y!==null;){var N=y.tag;if((N===3||N===4)&&y.stateNode.containerInfo===u)return;y=y.return}for(;w!==null;){if(y=Rr(w),y===null)return;if(N=y.tag,N===5||N===6||N===26||N===27){l=f=y;continue e}w=w.parentNode}}l=l.return}Td(function(){var M=f,B=Ql(n),$=[];e:{var U=nh.get(e);if(U!==void 0){var z=ai,X=e;switch(e){case"keypress":if(ei(n)===0)break e;case"keydown":case"keyup":z=w0;break;case"focusin":X="focus",z=eo;break;case"focusout":X="blur",z=eo;break;case"beforeblur":case"afterblur":z=eo;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":z=Dd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":z=u0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":z=j0;break;case eh:case th:case ah:z=f0;break;case rh:z=N0;break;case"scroll":case"scrollend":z=o0;break;case"wheel":z=R0;break;case"copy":case"cut":case"paste":z=p0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":z=Ud;break;case"toggle":case"beforetoggle":z=k0}var le=(t&4)!==0,De=!le&&(e==="scroll"||e==="scrollend"),T=le?U!==null?U+"Capture":null:U;le=[];for(var E=M,D;E!==null;){var P=E;if(D=P.stateNode,P=P.tag,P!==5&&P!==26&&P!==27||D===null||T===null||(P=Bn(E,T),P!=null&&le.push(ys(E,P,D))),De)break;E=E.return}0<le.length&&(U=new z(U,X,null,n,B),$.push({event:U,listeners:le}))}}if((t&7)===0){e:{if(U=e==="mouseover"||e==="pointerover",z=e==="mouseout"||e==="pointerout",U&&n!==Yl&&(X=n.relatedTarget||n.fromElement)&&(Rr(X)||X[Er]))break e;if((z||U)&&(U=B.window===B?B:(U=B.ownerDocument)?U.defaultView||U.parentWindow:window,z?(X=n.relatedTarget||n.toElement,z=M,X=X?Rr(X):null,X!==null&&(De=c(X),le=X.tag,X!==De||le!==5&&le!==27&&le!==6)&&(X=null)):(z=null,X=M),z!==X)){if(le=Dd,P="onMouseLeave",T="onMouseEnter",E="mouse",(e==="pointerout"||e==="pointerover")&&(le=Ud,P="onPointerLeave",T="onPointerEnter",E="pointer"),De=z==null?U:Ln(z),D=X==null?U:Ln(X),U=new le(P,E+"leave",z,n,B),U.target=De,U.relatedTarget=D,P=null,Rr(B)===M&&(le=new le(T,E+"enter",X,n,B),le.target=D,le.relatedTarget=De,P=le),De=P,z&&X)t:{for(le=Tv,T=z,E=X,D=0,P=T;P;P=le(P))D++;P=0;for(var se=E;se;se=le(se))P++;for(;0<D-P;)T=le(T),D--;for(;0<P-D;)E=le(E),P--;for(;D--;){if(T===E||E!==null&&T===E.alternate){le=T;break t}T=le(T),E=le(E)}le=null}else le=null;z!==null&&Nm($,U,z,le,!1),X!==null&&De!==null&&Nm($,De,X,le,!0)}}e:{if(U=M?Ln(M):window,z=U.nodeName&&U.nodeName.toLowerCase(),z==="select"||z==="input"&&U.type==="file")var Se=Vd;else if($d(U))if(Fd)Se=$0;else{Se=q0;var Z=B0}else z=U.nodeName,!z||z.toLowerCase()!=="input"||U.type!=="checkbox"&&U.type!=="radio"?M&&Il(M.elementType)&&(Se=Vd):Se=P0;if(Se&&(Se=Se(e,M))){Hd($,Se,n,B);break e}Z&&Z(e,U,M),e==="focusout"&&M&&U.type==="number"&&M.memoizedProps.value!=null&&Gl(U,"number",U.value)}switch(Z=M?Ln(M):window,e){case"focusin":($d(Z)||Z.contentEditable==="true")&&(Br=Z,io=M,In=null);break;case"focusout":In=io=Br=null;break;case"mousedown":lo=!0;break;case"contextmenu":case"mouseup":case"dragend":lo=!1,Xd($,n,B);break;case"selectionchange":if(V0)break;case"keydown":case"keyup":Xd($,n,B)}var fe;if(ao)e:{switch(e){case"compositionstart":var xe="onCompositionStart";break e;case"compositionend":xe="onCompositionEnd";break e;case"compositionupdate":xe="onCompositionUpdate";break e}xe=void 0}else Lr?qd(e,n)&&(xe="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(xe="onCompositionStart");xe&&(zd&&n.locale!=="ko"&&(Lr||xe!=="onCompositionStart"?xe==="onCompositionEnd"&&Lr&&(fe=kd()):(Ea=B,Jl="value"in Ea?Ea.value:Ea.textContent,Lr=!0)),Z=Ii(M,xe),0<Z.length&&(xe=new Md(xe,e,null,n,B),$.push({event:xe,listeners:Z}),fe?xe.data=fe:(fe=Pd(n),fe!==null&&(xe.data=fe)))),(fe=D0?M0(e,n):U0(e,n))&&(xe=Ii(M,"onBeforeInput"),0<xe.length&&(Z=new Md("onBeforeInput","beforeinput",null,n,B),$.push({event:Z,listeners:xe}),Z.data=fe)),Av($,e,M,n,B)}jm($,t)})}function ys(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ii(e,t){for(var n=t+"Capture",l=[];e!==null;){var u=e,f=u.stateNode;if(u=u.tag,u!==5&&u!==26&&u!==27||f===null||(u=Bn(e,n),u!=null&&l.unshift(ys(e,u,f)),u=Bn(e,t),u!=null&&l.push(ys(e,u,f))),e.tag===3)return l;e=e.return}return[]}function Tv(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Nm(e,t,n,l,u){for(var f=t._reactName,y=[];n!==null&&n!==l;){var w=n,N=w.alternate,M=w.stateNode;if(w=w.tag,N!==null&&N===l)break;w!==5&&w!==26&&w!==27||M===null||(N=M,u?(M=Bn(n,f),M!=null&&y.unshift(ys(n,M,N))):u||(M=Bn(n,f),M!=null&&y.push(ys(n,M,N)))),n=n.return}y.length!==0&&e.push({event:t,listeners:y})}var kv=/\r\n?/g,Ov=/\u0000|\uFFFD/g;function Em(e){return(typeof e=="string"?e:""+e).replace(kv,`
`).replace(Ov,"")}function Rm(e,t){return t=Em(t),Em(e)===t}function Oe(e,t,n,l,u,f){switch(n){case"children":typeof l=="string"?t==="body"||t==="textarea"&&l===""||Mr(e,l):(typeof l=="number"||typeof l=="bigint")&&t!=="body"&&Mr(e,""+l);break;case"className":Ws(e,"class",l);break;case"tabIndex":Ws(e,"tabindex",l);break;case"dir":case"role":case"viewBox":case"width":case"height":Ws(e,n,l);break;case"style":Ed(e,l,f);break;case"data":if(t!=="object"){Ws(e,"data",l);break}case"src":case"href":if(l===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(l==null||typeof l=="function"||typeof l=="symbol"||typeof l=="boolean"){e.removeAttribute(n);break}l=Xs(""+l),e.setAttribute(n,l);break;case"action":case"formAction":if(typeof l=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof f=="function"&&(n==="formAction"?(t!=="input"&&Oe(e,t,"name",u.name,u,null),Oe(e,t,"formEncType",u.formEncType,u,null),Oe(e,t,"formMethod",u.formMethod,u,null),Oe(e,t,"formTarget",u.formTarget,u,null)):(Oe(e,t,"encType",u.encType,u,null),Oe(e,t,"method",u.method,u,null),Oe(e,t,"target",u.target,u,null)));if(l==null||typeof l=="symbol"||typeof l=="boolean"){e.removeAttribute(n);break}l=Xs(""+l),e.setAttribute(n,l);break;case"onClick":l!=null&&(e.onclick=ia);break;case"onScroll":l!=null&&ye("scroll",e);break;case"onScrollEnd":l!=null&&ye("scrollend",e);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(s(61));if(n=l.__html,n!=null){if(u.children!=null)throw Error(s(60));e.innerHTML=n}}break;case"multiple":e.multiple=l&&typeof l!="function"&&typeof l!="symbol";break;case"muted":e.muted=l&&typeof l!="function"&&typeof l!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(l==null||typeof l=="function"||typeof l=="boolean"||typeof l=="symbol"){e.removeAttribute("xlink:href");break}n=Xs(""+l),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":l!=null&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(n,""+l):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":l&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":l===!0?e.setAttribute(n,""):l!==!1&&l!=null&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(n,l):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":l!=null&&typeof l!="function"&&typeof l!="symbol"&&!isNaN(l)&&1<=l?e.setAttribute(n,l):e.removeAttribute(n);break;case"rowSpan":case"start":l==null||typeof l=="function"||typeof l=="symbol"||isNaN(l)?e.removeAttribute(n):e.setAttribute(n,l);break;case"popover":ye("beforetoggle",e),ye("toggle",e),Ks(e,"popover",l);break;case"xlinkActuate":sa(e,"http://www.w3.org/1999/xlink","xlink:actuate",l);break;case"xlinkArcrole":sa(e,"http://www.w3.org/1999/xlink","xlink:arcrole",l);break;case"xlinkRole":sa(e,"http://www.w3.org/1999/xlink","xlink:role",l);break;case"xlinkShow":sa(e,"http://www.w3.org/1999/xlink","xlink:show",l);break;case"xlinkTitle":sa(e,"http://www.w3.org/1999/xlink","xlink:title",l);break;case"xlinkType":sa(e,"http://www.w3.org/1999/xlink","xlink:type",l);break;case"xmlBase":sa(e,"http://www.w3.org/XML/1998/namespace","xml:base",l);break;case"xmlLang":sa(e,"http://www.w3.org/XML/1998/namespace","xml:lang",l);break;case"xmlSpace":sa(e,"http://www.w3.org/XML/1998/namespace","xml:space",l);break;case"is":Ks(e,"is",l);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=i0.get(n)||n,Ks(e,n,l))}}function Dc(e,t,n,l,u,f){switch(n){case"style":Ed(e,l,f);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(s(61));if(n=l.__html,n!=null){if(u.children!=null)throw Error(s(60));e.innerHTML=n}}break;case"children":typeof l=="string"?Mr(e,l):(typeof l=="number"||typeof l=="bigint")&&Mr(e,""+l);break;case"onScroll":l!=null&&ye("scroll",e);break;case"onScrollEnd":l!=null&&ye("scrollend",e);break;case"onClick":l!=null&&(e.onclick=ia);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!bd.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(u=n.endsWith("Capture"),t=n.slice(2,u?n.length-7:void 0),f=e[ht]||null,f=f!=null?f[n]:null,typeof f=="function"&&e.removeEventListener(t,f,u),typeof l=="function")){typeof f!="function"&&f!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,l,u);break e}n in e?e[n]=l:l===!0?e.setAttribute(n,""):Ks(e,n,l)}}}function ot(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ye("error",e),ye("load",e);var l=!1,u=!1,f;for(f in n)if(n.hasOwnProperty(f)){var y=n[f];if(y!=null)switch(f){case"src":l=!0;break;case"srcSet":u=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:Oe(e,t,f,y,n,null)}}u&&Oe(e,t,"srcSet",n.srcSet,n,null),l&&Oe(e,t,"src",n.src,n,null);return;case"input":ye("invalid",e);var w=f=y=u=null,N=null,M=null;for(l in n)if(n.hasOwnProperty(l)){var B=n[l];if(B!=null)switch(l){case"name":u=B;break;case"type":y=B;break;case"checked":N=B;break;case"defaultChecked":M=B;break;case"value":f=B;break;case"defaultValue":w=B;break;case"children":case"dangerouslySetInnerHTML":if(B!=null)throw Error(s(137,t));break;default:Oe(e,t,l,B,n,null)}}Cd(e,f,w,N,M,y,u,!1);return;case"select":ye("invalid",e),l=y=f=null;for(u in n)if(n.hasOwnProperty(u)&&(w=n[u],w!=null))switch(u){case"value":f=w;break;case"defaultValue":y=w;break;case"multiple":l=w;default:Oe(e,t,u,w,n,null)}t=f,n=y,e.multiple=!!l,t!=null?Dr(e,!!l,t,!1):n!=null&&Dr(e,!!l,n,!0);return;case"textarea":ye("invalid",e),f=u=l=null;for(y in n)if(n.hasOwnProperty(y)&&(w=n[y],w!=null))switch(y){case"value":l=w;break;case"defaultValue":u=w;break;case"children":f=w;break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(s(91));break;default:Oe(e,t,y,w,n,null)}Ad(e,l,u,f);return;case"option":for(N in n)if(n.hasOwnProperty(N)&&(l=n[N],l!=null))switch(N){case"selected":e.selected=l&&typeof l!="function"&&typeof l!="symbol";break;default:Oe(e,t,N,l,n,null)}return;case"dialog":ye("beforetoggle",e),ye("toggle",e),ye("cancel",e),ye("close",e);break;case"iframe":case"object":ye("load",e);break;case"video":case"audio":for(l=0;l<gs.length;l++)ye(gs[l],e);break;case"image":ye("error",e),ye("load",e);break;case"details":ye("toggle",e);break;case"embed":case"source":case"link":ye("error",e),ye("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(M in n)if(n.hasOwnProperty(M)&&(l=n[M],l!=null))switch(M){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:Oe(e,t,M,l,n,null)}return;default:if(Il(t)){for(B in n)n.hasOwnProperty(B)&&(l=n[B],l!==void 0&&Dc(e,t,B,l,n,void 0));return}}for(w in n)n.hasOwnProperty(w)&&(l=n[w],l!=null&&Oe(e,t,w,l,n,null))}function Dv(e,t,n,l){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var u=null,f=null,y=null,w=null,N=null,M=null,B=null;for(z in n){var $=n[z];if(n.hasOwnProperty(z)&&$!=null)switch(z){case"checked":break;case"value":break;case"defaultValue":N=$;default:l.hasOwnProperty(z)||Oe(e,t,z,null,l,$)}}for(var U in l){var z=l[U];if($=n[U],l.hasOwnProperty(U)&&(z!=null||$!=null))switch(U){case"type":f=z;break;case"name":u=z;break;case"checked":M=z;break;case"defaultChecked":B=z;break;case"value":y=z;break;case"defaultValue":w=z;break;case"children":case"dangerouslySetInnerHTML":if(z!=null)throw Error(s(137,t));break;default:z!==$&&Oe(e,t,U,z,l,$)}}Fl(e,y,w,N,M,B,f,u);return;case"select":z=y=w=U=null;for(f in n)if(N=n[f],n.hasOwnProperty(f)&&N!=null)switch(f){case"value":break;case"multiple":z=N;default:l.hasOwnProperty(f)||Oe(e,t,f,null,l,N)}for(u in l)if(f=l[u],N=n[u],l.hasOwnProperty(u)&&(f!=null||N!=null))switch(u){case"value":U=f;break;case"defaultValue":w=f;break;case"multiple":y=f;default:f!==N&&Oe(e,t,u,f,l,N)}t=w,n=y,l=z,U!=null?Dr(e,!!n,U,!1):!!l!=!!n&&(t!=null?Dr(e,!!n,t,!0):Dr(e,!!n,n?[]:"",!1));return;case"textarea":z=U=null;for(w in n)if(u=n[w],n.hasOwnProperty(w)&&u!=null&&!l.hasOwnProperty(w))switch(w){case"value":break;case"children":break;default:Oe(e,t,w,null,l,u)}for(y in l)if(u=l[y],f=n[y],l.hasOwnProperty(y)&&(u!=null||f!=null))switch(y){case"value":U=u;break;case"defaultValue":z=u;break;case"children":break;case"dangerouslySetInnerHTML":if(u!=null)throw Error(s(91));break;default:u!==f&&Oe(e,t,y,u,l,f)}jd(e,U,z);return;case"option":for(var X in n)if(U=n[X],n.hasOwnProperty(X)&&U!=null&&!l.hasOwnProperty(X))switch(X){case"selected":e.selected=!1;break;default:Oe(e,t,X,null,l,U)}for(N in l)if(U=l[N],z=n[N],l.hasOwnProperty(N)&&U!==z&&(U!=null||z!=null))switch(N){case"selected":e.selected=U&&typeof U!="function"&&typeof U!="symbol";break;default:Oe(e,t,N,U,l,z)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var le in n)U=n[le],n.hasOwnProperty(le)&&U!=null&&!l.hasOwnProperty(le)&&Oe(e,t,le,null,l,U);for(M in l)if(U=l[M],z=n[M],l.hasOwnProperty(M)&&U!==z&&(U!=null||z!=null))switch(M){case"children":case"dangerouslySetInnerHTML":if(U!=null)throw Error(s(137,t));break;default:Oe(e,t,M,U,l,z)}return;default:if(Il(t)){for(var De in n)U=n[De],n.hasOwnProperty(De)&&U!==void 0&&!l.hasOwnProperty(De)&&Dc(e,t,De,void 0,l,U);for(B in l)U=l[B],z=n[B],!l.hasOwnProperty(B)||U===z||U===void 0&&z===void 0||Dc(e,t,B,U,l,z);return}}for(var T in n)U=n[T],n.hasOwnProperty(T)&&U!=null&&!l.hasOwnProperty(T)&&Oe(e,t,T,null,l,U);for($ in l)U=l[$],z=n[$],!l.hasOwnProperty($)||U===z||U==null&&z==null||Oe(e,t,$,U,l,z)}function Tm(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Mv(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,n=performance.getEntriesByType("resource"),l=0;l<n.length;l++){var u=n[l],f=u.transferSize,y=u.initiatorType,w=u.duration;if(f&&w&&Tm(y)){for(y=0,w=u.responseEnd,l+=1;l<n.length;l++){var N=n[l],M=N.startTime;if(M>w)break;var B=N.transferSize,$=N.initiatorType;B&&Tm($)&&(N=N.responseEnd,y+=B*(N<w?1:(w-M)/(N-M)))}if(--l,t+=8*(f+y)/(u.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Mc=null,Uc=null;function Yi(e){return e.nodeType===9?e:e.ownerDocument}function km(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Om(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function zc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Lc=null;function Uv(){var e=window.event;return e&&e.type==="popstate"?e===Lc?!1:(Lc=e,!0):(Lc=null,!1)}var Dm=typeof setTimeout=="function"?setTimeout:void 0,zv=typeof clearTimeout=="function"?clearTimeout:void 0,Mm=typeof Promise=="function"?Promise:void 0,Lv=typeof queueMicrotask=="function"?queueMicrotask:typeof Mm<"u"?function(e){return Mm.resolve(null).then(e).catch(Bv)}:Dm;function Bv(e){setTimeout(function(){throw e})}function Ga(e){return e==="head"}function Um(e,t){var n=t,l=0;do{var u=n.nextSibling;if(e.removeChild(n),u&&u.nodeType===8)if(n=u.data,n==="/$"||n==="/&"){if(l===0){e.removeChild(u),hn(t);return}l--}else if(n==="$"||n==="$?"||n==="$~"||n==="$!"||n==="&")l++;else if(n==="html")vs(e.ownerDocument.documentElement);else if(n==="head"){n=e.ownerDocument.head,vs(n);for(var f=n.firstChild;f;){var y=f.nextSibling,w=f.nodeName;f[zn]||w==="SCRIPT"||w==="STYLE"||w==="LINK"&&f.rel.toLowerCase()==="stylesheet"||n.removeChild(f),f=y}}else n==="body"&&vs(e.ownerDocument.body);n=u}while(n);hn(t)}function zm(e,t){var n=e;e=0;do{var l=n.nextSibling;if(n.nodeType===1?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",n.getAttribute("style")===""&&n.removeAttribute("style")):n.nodeType===3&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),l&&l.nodeType===8)if(n=l.data,n==="/$"){if(e===0)break;e--}else n!=="$"&&n!=="$?"&&n!=="$~"&&n!=="$!"||e++;n=l}while(n)}function Bc(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Bc(n),Hl(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function qv(e,t,n,l){for(;e.nodeType===1;){var u=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!l&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(l){if(!e[zn])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(f=e.getAttribute("rel"),f==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(f!==u.rel||e.getAttribute("href")!==(u.href==null||u.href===""?null:u.href)||e.getAttribute("crossorigin")!==(u.crossOrigin==null?null:u.crossOrigin)||e.getAttribute("title")!==(u.title==null?null:u.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(f=e.getAttribute("src"),(f!==(u.src==null?null:u.src)||e.getAttribute("type")!==(u.type==null?null:u.type)||e.getAttribute("crossorigin")!==(u.crossOrigin==null?null:u.crossOrigin))&&f&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var f=u.name==null?null:""+u.name;if(u.type==="hidden"&&e.getAttribute("name")===f)return e}else return e;if(e=qt(e.nextSibling),e===null)break}return null}function Pv(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=qt(e.nextSibling),e===null))return null;return e}function Lm(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=qt(e.nextSibling),e===null))return null;return e}function qc(e){return e.data==="$?"||e.data==="$~"}function Pc(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function $v(e,t){var n=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||n.readyState!=="loading")t();else{var l=function(){t(),n.removeEventListener("DOMContentLoaded",l)};n.addEventListener("DOMContentLoaded",l),e._reactRetry=l}}function qt(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var $c=null;function Bm(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"||n==="/&"){if(t===0)return qt(e.nextSibling);t--}else n!=="$"&&n!=="$!"&&n!=="$?"&&n!=="$~"&&n!=="&"||t++}e=e.nextSibling}return null}function qm(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"){if(t===0)return e;t--}else n!=="/$"&&n!=="/&"||t++}e=e.previousSibling}return null}function Pm(e,t,n){switch(t=Yi(n),e){case"html":if(e=t.documentElement,!e)throw Error(s(452));return e;case"head":if(e=t.head,!e)throw Error(s(453));return e;case"body":if(e=t.body,!e)throw Error(s(454));return e;default:throw Error(s(451))}}function vs(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Hl(e)}var Pt=new Map,$m=new Set;function Qi(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var wa=Y.d;Y.d={f:Hv,r:Vv,D:Fv,C:Gv,L:Iv,m:Yv,X:Kv,S:Qv,M:Wv};function Hv(){var e=wa.f(),t=qi();return e||t}function Vv(e){var t=Tr(e);t!==null&&t.tag===5&&t.type==="form"?rf(t):wa.r(e)}var cn=typeof document>"u"?null:document;function Hm(e,t,n){var l=cn;if(l&&typeof t=="string"&&t){var u=Ot(t);u='link[rel="'+e+'"][href="'+u+'"]',typeof n=="string"&&(u+='[crossorigin="'+n+'"]'),$m.has(u)||($m.add(u),e={rel:e,crossOrigin:n,href:t},l.querySelector(u)===null&&(t=l.createElement("link"),ot(t,"link",e),tt(t),l.head.appendChild(t)))}}function Fv(e){wa.D(e),Hm("dns-prefetch",e,null)}function Gv(e,t){wa.C(e,t),Hm("preconnect",e,t)}function Iv(e,t,n){wa.L(e,t,n);var l=cn;if(l&&e&&t){var u='link[rel="preload"][as="'+Ot(t)+'"]';t==="image"&&n&&n.imageSrcSet?(u+='[imagesrcset="'+Ot(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(u+='[imagesizes="'+Ot(n.imageSizes)+'"]')):u+='[href="'+Ot(e)+'"]';var f=u;switch(t){case"style":f=un(e);break;case"script":f=dn(e)}Pt.has(f)||(e=b({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),Pt.set(f,e),l.querySelector(u)!==null||t==="style"&&l.querySelector(bs(f))||t==="script"&&l.querySelector(xs(f))||(t=l.createElement("link"),ot(t,"link",e),tt(t),l.head.appendChild(t)))}}function Yv(e,t){wa.m(e,t);var n=cn;if(n&&e){var l=t&&typeof t.as=="string"?t.as:"script",u='link[rel="modulepreload"][as="'+Ot(l)+'"][href="'+Ot(e)+'"]',f=u;switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":f=dn(e)}if(!Pt.has(f)&&(e=b({rel:"modulepreload",href:e},t),Pt.set(f,e),n.querySelector(u)===null)){switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(xs(f)))return}l=n.createElement("link"),ot(l,"link",e),tt(l),n.head.appendChild(l)}}}function Qv(e,t,n){wa.S(e,t,n);var l=cn;if(l&&e){var u=kr(l).hoistableStyles,f=un(e);t=t||"default";var y=u.get(f);if(!y){var w={loading:0,preload:null};if(y=l.querySelector(bs(f)))w.loading=5;else{e=b({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Pt.get(f))&&Hc(e,n);var N=y=l.createElement("link");tt(N),ot(N,"link",e),N._p=new Promise(function(M,B){N.onload=M,N.onerror=B}),N.addEventListener("load",function(){w.loading|=1}),N.addEventListener("error",function(){w.loading|=2}),w.loading|=4,Ki(y,t,l)}y={type:"stylesheet",instance:y,count:1,state:w},u.set(f,y)}}}function Kv(e,t){wa.X(e,t);var n=cn;if(n&&e){var l=kr(n).hoistableScripts,u=dn(e),f=l.get(u);f||(f=n.querySelector(xs(u)),f||(e=b({src:e,async:!0},t),(t=Pt.get(u))&&Vc(e,t),f=n.createElement("script"),tt(f),ot(f,"link",e),n.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},l.set(u,f))}}function Wv(e,t){wa.M(e,t);var n=cn;if(n&&e){var l=kr(n).hoistableScripts,u=dn(e),f=l.get(u);f||(f=n.querySelector(xs(u)),f||(e=b({src:e,async:!0,type:"module"},t),(t=Pt.get(u))&&Vc(e,t),f=n.createElement("script"),tt(f),ot(f,"link",e),n.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},l.set(u,f))}}function Vm(e,t,n,l){var u=(u=ze.current)?Qi(u):null;if(!u)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=un(n.href),n=kr(u).hoistableStyles,l=n.get(t),l||(l={type:"style",instance:null,count:0,state:null},n.set(t,l)),l):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=un(n.href);var f=kr(u).hoistableStyles,y=f.get(e);if(y||(u=u.ownerDocument||u,y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},f.set(e,y),(f=u.querySelector(bs(e)))&&!f._p&&(y.instance=f,y.state.loading=5),Pt.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Pt.set(e,n),f||Jv(u,e,n,y.state))),t&&l===null)throw Error(s(528,""));return y}if(t&&l!==null)throw Error(s(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=dn(n),n=kr(u).hoistableScripts,l=n.get(t),l||(l={type:"script",instance:null,count:0,state:null},n.set(t,l)),l):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function un(e){return'href="'+Ot(e)+'"'}function bs(e){return'link[rel="stylesheet"]['+e+"]"}function Fm(e){return b({},e,{"data-precedence":e.precedence,precedence:null})}function Jv(e,t,n,l){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?l.loading=1:(t=e.createElement("link"),l.preload=t,t.addEventListener("load",function(){return l.loading|=1}),t.addEventListener("error",function(){return l.loading|=2}),ot(t,"link",n),tt(t),e.head.appendChild(t))}function dn(e){return'[src="'+Ot(e)+'"]'}function xs(e){return"script[async]"+e}function Gm(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var l=e.querySelector('style[data-href~="'+Ot(n.href)+'"]');if(l)return t.instance=l,tt(l),l;var u=b({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return l=(e.ownerDocument||e).createElement("style"),tt(l),ot(l,"style",u),Ki(l,n.precedence,e),t.instance=l;case"stylesheet":u=un(n.href);var f=e.querySelector(bs(u));if(f)return t.state.loading|=4,t.instance=f,tt(f),f;l=Fm(n),(u=Pt.get(u))&&Hc(l,u),f=(e.ownerDocument||e).createElement("link"),tt(f);var y=f;return y._p=new Promise(function(w,N){y.onload=w,y.onerror=N}),ot(f,"link",l),t.state.loading|=4,Ki(f,n.precedence,e),t.instance=f;case"script":return f=dn(n.src),(u=e.querySelector(xs(f)))?(t.instance=u,tt(u),u):(l=n,(u=Pt.get(f))&&(l=b({},n),Vc(l,u)),e=e.ownerDocument||e,u=e.createElement("script"),tt(u),ot(u,"link",l),e.head.appendChild(u),t.instance=u);case"void":return null;default:throw Error(s(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(l=t.instance,t.state.loading|=4,Ki(l,n.precedence,e));return t.instance}function Ki(e,t,n){for(var l=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),u=l.length?l[l.length-1]:null,f=u,y=0;y<l.length;y++){var w=l[y];if(w.dataset.precedence===t)f=w;else if(f!==u)break}f?f.parentNode.insertBefore(e,f.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function Hc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Vc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var Wi=null;function Im(e,t,n){if(Wi===null){var l=new Map,u=Wi=new Map;u.set(n,l)}else u=Wi,l=u.get(n),l||(l=new Map,u.set(n,l));if(l.has(e))return l;for(l.set(e,null),n=n.getElementsByTagName(e),u=0;u<n.length;u++){var f=n[u];if(!(f[zn]||f[nt]||e==="link"&&f.getAttribute("rel")==="stylesheet")&&f.namespaceURI!=="http://www.w3.org/2000/svg"){var y=f.getAttribute(t)||"";y=e+y;var w=l.get(y);w?w.push(f):l.set(y,[f])}}return l}function Ym(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function Xv(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function Qm(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function Zv(e,t,n,l){if(n.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var u=un(l.href),f=t.querySelector(bs(u));if(f){t=f._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=Ji.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=f,tt(f);return}f=t.ownerDocument||t,l=Fm(l),(u=Pt.get(u))&&Hc(l,u),f=f.createElement("link"),tt(f);var y=f;y._p=new Promise(function(w,N){y.onload=w,y.onerror=N}),ot(f,"link",l),n.instance=f}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&(n.state.loading&3)===0&&(e.count++,n=Ji.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}var Fc=0;function eb(e,t){return e.stylesheets&&e.count===0&&Zi(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var l=setTimeout(function(){if(e.stylesheets&&Zi(e,e.stylesheets),e.unsuspend){var f=e.unsuspend;e.unsuspend=null,f()}},6e4+t);0<e.imgBytes&&Fc===0&&(Fc=62500*Mv());var u=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Zi(e,e.stylesheets),e.unsuspend)){var f=e.unsuspend;e.unsuspend=null,f()}},(e.imgBytes>Fc?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(l),clearTimeout(u)}}:null}function Ji(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Zi(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Xi=null;function Zi(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Xi=new Map,t.forEach(tb,e),Xi=null,Ji.call(e))}function tb(e,t){if(!(t.state.loading&4)){var n=Xi.get(e);if(n)var l=n.get(null);else{n=new Map,Xi.set(e,n);for(var u=e.querySelectorAll("link[data-precedence],style[data-precedence]"),f=0;f<u.length;f++){var y=u[f];(y.nodeName==="LINK"||y.getAttribute("media")!=="not all")&&(n.set(y.dataset.precedence,y),l=y)}l&&n.set(null,l)}u=t.instance,y=u.getAttribute("data-precedence"),f=n.get(y)||l,f===l&&n.set(null,u),n.set(y,u),this.count++,l=Ji.bind(this),u.addEventListener("load",l),u.addEventListener("error",l),f?f.parentNode.insertBefore(u,f.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(u,e.firstChild)),t.state.loading|=4}}var _s={$$typeof:O,Provider:null,Consumer:null,_currentValue:ae,_currentValue2:ae,_threadCount:0};function ab(e,t,n,l,u,f,y,w,N){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Bl(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Bl(0),this.hiddenUpdates=Bl(null),this.identifierPrefix=l,this.onUncaughtError=u,this.onCaughtError=f,this.onRecoverableError=y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=N,this.incompleteTransitions=new Map}function Km(e,t,n,l,u,f,y,w,N,M,B,$){return e=new ab(e,t,n,y,N,M,B,$,w),t=1,f===!0&&(t|=24),f=St(3,null,null,t),e.current=f,f.stateNode=e,t=So(),t.refCount++,e.pooledCache=t,t.refCount++,f.memoizedState={element:l,isDehydrated:n,cache:t},No(f),e}function Wm(e){return e?(e=$r,e):$r}function Jm(e,t,n,l,u,f){u=Wm(u),l.context===null?l.context=u:l.pendingContext=u,l=Ma(t),l.payload={element:n},f=f===void 0?null:f,f!==null&&(l.callback=f),n=Ua(e,l,t),n!==null&&(vt(n,e,t),Zn(n,e,t))}function Xm(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Gc(e,t){Xm(e,t),(e=e.alternate)&&Xm(e,t)}function Zm(e){if(e.tag===13||e.tag===31){var t=ir(e,67108864);t!==null&&vt(t,e,67108864),Gc(e,67108864)}}function ep(e){if(e.tag===13||e.tag===31){var t=Et();t=ql(t);var n=ir(e,t);n!==null&&vt(n,e,t),Gc(e,t)}}var el=!0;function rb(e,t,n,l){var u=L.T;L.T=null;var f=Y.p;try{Y.p=2,Ic(e,t,n,l)}finally{Y.p=f,L.T=u}}function nb(e,t,n,l){var u=L.T;L.T=null;var f=Y.p;try{Y.p=8,Ic(e,t,n,l)}finally{Y.p=f,L.T=u}}function Ic(e,t,n,l){if(el){var u=Yc(l);if(u===null)Oc(e,t,l,tl,n),ap(e,l);else if(ib(u,e,t,n,l))l.stopPropagation();else if(ap(e,l),t&4&&-1<sb.indexOf(e)){for(;u!==null;){var f=Tr(u);if(f!==null)switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var y=tr(f.pendingLanes);if(y!==0){var w=f;for(w.pendingLanes|=2,w.entangledLanes|=2;y;){var N=1<<31-_t(y);w.entanglements[1]|=N,y&=~N}ta(f),(je&6)===0&&(Li=bt()+500,ps(0))}}break;case 31:case 13:w=ir(f,2),w!==null&&vt(w,f,2),qi(),Gc(f,2)}if(f=Yc(l),f===null&&Oc(e,t,l,tl,n),f===u)break;u=f}u!==null&&l.stopPropagation()}else Oc(e,t,l,null,n)}}function Yc(e){return e=Ql(e),Qc(e)}var tl=null;function Qc(e){if(tl=null,e=Rr(e),e!==null){var t=c(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=h(t),e!==null)return e;e=null}else if(n===31){if(e=m(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return tl=e,null}function tp(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Fy()){case od:return 2;case cd:return 8;case Fs:case Gy:return 32;case ud:return 268435456;default:return 32}default:return 32}}var Kc=!1,Ia=null,Ya=null,Qa=null,ws=new Map,Ss=new Map,Ka=[],sb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ap(e,t){switch(e){case"focusin":case"focusout":Ia=null;break;case"dragenter":case"dragleave":Ya=null;break;case"mouseover":case"mouseout":Qa=null;break;case"pointerover":case"pointerout":ws.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ss.delete(t.pointerId)}}function Cs(e,t,n,l,u,f){return e===null||e.nativeEvent!==f?(e={blockedOn:t,domEventName:n,eventSystemFlags:l,nativeEvent:f,targetContainers:[u]},t!==null&&(t=Tr(t),t!==null&&Zm(t)),e):(e.eventSystemFlags|=l,t=e.targetContainers,u!==null&&t.indexOf(u)===-1&&t.push(u),e)}function ib(e,t,n,l,u){switch(t){case"focusin":return Ia=Cs(Ia,e,t,n,l,u),!0;case"dragenter":return Ya=Cs(Ya,e,t,n,l,u),!0;case"mouseover":return Qa=Cs(Qa,e,t,n,l,u),!0;case"pointerover":var f=u.pointerId;return ws.set(f,Cs(ws.get(f)||null,e,t,n,l,u)),!0;case"gotpointercapture":return f=u.pointerId,Ss.set(f,Cs(Ss.get(f)||null,e,t,n,l,u)),!0}return!1}function rp(e){var t=Rr(e.target);if(t!==null){var n=c(t);if(n!==null){if(t=n.tag,t===13){if(t=h(n),t!==null){e.blockedOn=t,gd(e.priority,function(){ep(n)});return}}else if(t===31){if(t=m(n),t!==null){e.blockedOn=t,gd(e.priority,function(){ep(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function al(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yc(e.nativeEvent);if(n===null){n=e.nativeEvent;var l=new n.constructor(n.type,n);Yl=l,n.target.dispatchEvent(l),Yl=null}else return t=Tr(n),t!==null&&Zm(t),e.blockedOn=n,!1;t.shift()}return!0}function np(e,t,n){al(e)&&n.delete(t)}function lb(){Kc=!1,Ia!==null&&al(Ia)&&(Ia=null),Ya!==null&&al(Ya)&&(Ya=null),Qa!==null&&al(Qa)&&(Qa=null),ws.forEach(np),Ss.forEach(np)}function rl(e,t){e.blockedOn===t&&(e.blockedOn=null,Kc||(Kc=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,lb)))}var nl=null;function sp(e){nl!==e&&(nl=e,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){nl===e&&(nl=null);for(var t=0;t<e.length;t+=3){var n=e[t],l=e[t+1],u=e[t+2];if(typeof l!="function"){if(Qc(l||n)===null)continue;break}var f=Tr(n);f!==null&&(e.splice(t,3),t-=3,Yo(f,{pending:!0,data:u,method:n.method,action:l},l,u))}}))}function hn(e){function t(N){return rl(N,e)}Ia!==null&&rl(Ia,e),Ya!==null&&rl(Ya,e),Qa!==null&&rl(Qa,e),ws.forEach(t),Ss.forEach(t);for(var n=0;n<Ka.length;n++){var l=Ka[n];l.blockedOn===e&&(l.blockedOn=null)}for(;0<Ka.length&&(n=Ka[0],n.blockedOn===null);)rp(n),n.blockedOn===null&&Ka.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(l=0;l<n.length;l+=3){var u=n[l],f=n[l+1],y=u[ht]||null;if(typeof f=="function")y||sp(n);else if(y){var w=null;if(f&&f.hasAttribute("formAction")){if(u=f,y=f[ht]||null)w=y.formAction;else if(Qc(u)!==null)continue}else w=y.action;typeof w=="function"?n[l+1]=w:(n.splice(l,3),l-=3),sp(n)}}}function ip(){function e(f){f.canIntercept&&f.info==="react-transition"&&f.intercept({handler:function(){return new Promise(function(y){return u=y})},focusReset:"manual",scroll:"manual"})}function t(){u!==null&&(u(),u=null),l||setTimeout(n,20)}function n(){if(!l&&!navigation.transition){var f=navigation.currentEntry;f&&f.url!=null&&navigation.navigate(f.url,{state:f.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var l=!1,u=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){l=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),u!==null&&(u(),u=null)}}}function Wc(e){this._internalRoot=e}sl.prototype.render=Wc.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(s(409));var n=t.current,l=Et();Jm(n,l,e,t,null,null)},sl.prototype.unmount=Wc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Jm(e.current,2,null,e,null,null),qi(),t[Er]=null}};function sl(e){this._internalRoot=e}sl.prototype.unstable_scheduleHydration=function(e){if(e){var t=pd();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ka.length&&t!==0&&t<Ka[n].priority;n++);Ka.splice(n,0,e),n===0&&rp(e)}};var lp=a.version;if(lp!=="19.2.0")throw Error(s(527,lp,"19.2.0"));Y.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(s(188)):(e=Object.keys(e).join(","),Error(s(268,e)));return e=g(t),e=e!==null?v(e):null,e=e===null?null:e.stateNode,e};var ob={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:L,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var il=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!il.isDisabled&&il.supportsFiber)try{Dn=il.inject(ob),xt=il}catch{}}return As.createRoot=function(e,t){if(!o(e))throw Error(s(299));var n=!1,l="",u=mf,f=pf,y=gf;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(l=t.identifierPrefix),t.onUncaughtError!==void 0&&(u=t.onUncaughtError),t.onCaughtError!==void 0&&(f=t.onCaughtError),t.onRecoverableError!==void 0&&(y=t.onRecoverableError)),t=Km(e,1,!1,null,null,n,l,null,u,f,y,ip),e[Er]=t.current,kc(e),new Wc(t)},As.hydrateRoot=function(e,t,n){if(!o(e))throw Error(s(299));var l=!1,u="",f=mf,y=pf,w=gf,N=null;return n!=null&&(n.unstable_strictMode===!0&&(l=!0),n.identifierPrefix!==void 0&&(u=n.identifierPrefix),n.onUncaughtError!==void 0&&(f=n.onUncaughtError),n.onCaughtError!==void 0&&(y=n.onCaughtError),n.onRecoverableError!==void 0&&(w=n.onRecoverableError),n.formState!==void 0&&(N=n.formState)),t=Km(e,1,!0,t,n??null,l,u,N,f,y,w,ip),t.context=Wm(null),n=t.current,l=Et(),l=ql(l),u=Ma(l),u.callback=null,Ua(n,u,l),n=l,t.current.lanes=n,Un(t,n),ta(t),e[Er]=t.current,kc(e),new sl(t)},As.version="19.2.0",As}var gp;function qb(){if(gp)return eu.exports;gp=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(a){console.error(a)}}return i(),eu.exports=Bb(),eu.exports}var Pb=qb();const $b=xg(Pb);var yp="popstate";function Hb(i={}){function a(s,o){let{pathname:c,search:h,hash:m}=s.location;return wu("",{pathname:c,search:h,hash:m},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function r(s,o){return typeof o=="string"?o:Ds(o)}return Fb(a,r,null,i)}function Pe(i,a){if(i===!1||i===null||typeof i>"u")throw new Error(a)}function Kt(i,a){if(!i){typeof console<"u"&&console.warn(a);try{throw new Error(a)}catch{}}}function Vb(){return Math.random().toString(36).substring(2,10)}function vp(i,a){return{usr:i.state,key:i.key,idx:a}}function wu(i,a,r=null,s){return{pathname:typeof i=="string"?i:i.pathname,search:"",hash:"",...typeof a=="string"?jn(a):a,state:r,key:a&&a.key||s||Vb()}}function Ds({pathname:i="/",search:a="",hash:r=""}){return a&&a!=="?"&&(i+=a.charAt(0)==="?"?a:"?"+a),r&&r!=="#"&&(i+=r.charAt(0)==="#"?r:"#"+r),i}function jn(i){let a={};if(i){let r=i.indexOf("#");r>=0&&(a.hash=i.substring(r),i=i.substring(0,r));let s=i.indexOf("?");s>=0&&(a.search=i.substring(s),i=i.substring(0,s)),i&&(a.pathname=i)}return a}function Fb(i,a,r,s={}){let{window:o=document.defaultView,v5Compat:c=!1}=s,h=o.history,m="POP",p=null,g=v();g==null&&(g=0,h.replaceState({...h.state,idx:g},""));function v(){return(h.state||{idx:null}).idx}function b(){m="POP";let A=v(),R=A==null?null:A-g;g=A,p&&p({action:m,location:j.location,delta:R})}function x(A,R){m="PUSH";let k=wu(j.location,A,R);g=v()+1;let O=vp(k,g),H=j.createHref(k);try{h.pushState(O,"",H)}catch(I){if(I instanceof DOMException&&I.name==="DataCloneError")throw I;o.location.assign(H)}c&&p&&p({action:m,location:j.location,delta:1})}function _(A,R){m="REPLACE";let k=wu(j.location,A,R);g=v();let O=vp(k,g),H=j.createHref(k);h.replaceState(O,"",H),c&&p&&p({action:m,location:j.location,delta:0})}function C(A){return Gb(A)}let j={get action(){return m},get location(){return i(o,h)},listen(A){if(p)throw new Error("A history only accepts one active listener");return o.addEventListener(yp,b),p=A,()=>{o.removeEventListener(yp,b),p=null}},createHref(A){return a(o,A)},createURL:C,encodeLocation(A){let R=C(A);return{pathname:R.pathname,search:R.search,hash:R.hash}},push:x,replace:_,go(A){return h.go(A)}};return j}function Gb(i,a=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Pe(r,"No window.location.(origin|href) available to create URL");let s=typeof i=="string"?i:Ds(i);return s=s.replace(/ $/,"%20"),!a&&s.startsWith("//")&&(s=r+s),new URL(s,r)}function _g(i,a,r="/"){return Ib(i,a,r,!1)}function Ib(i,a,r,s){let o=typeof a=="string"?jn(a):a,c=ja(o.pathname||"/",r);if(c==null)return null;let h=wg(i);Yb(h);let m=null;for(let p=0;m==null&&p<h.length;++p){let g=nx(c);m=ax(h[p],g,s)}return m}function wg(i,a=[],r=[],s="",o=!1){let c=(h,m,p=o,g)=>{let v={relativePath:g===void 0?h.path||"":g,caseSensitive:h.caseSensitive===!0,childrenIndex:m,route:h};if(v.relativePath.startsWith("/")){if(!v.relativePath.startsWith(s)&&p)return;Pe(v.relativePath.startsWith(s),`Absolute route path "${v.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),v.relativePath=v.relativePath.slice(s.length)}let b=Ca([s,v.relativePath]),x=r.concat(v);h.children&&h.children.length>0&&(Pe(h.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${b}".`),wg(h.children,a,x,b,p)),!(h.path==null&&!h.index)&&a.push({path:b,score:ex(b,h.index),routesMeta:x})};return i.forEach((h,m)=>{if(h.path===""||!h.path?.includes("?"))c(h,m);else for(let p of Sg(h.path))c(h,m,!0,p)}),a}function Sg(i){let a=i.split("/");if(a.length===0)return[];let[r,...s]=a,o=r.endsWith("?"),c=r.replace(/\?$/,"");if(s.length===0)return o?[c,""]:[c];let h=Sg(s.join("/")),m=[];return m.push(...h.map(p=>p===""?c:[c,p].join("/"))),o&&m.push(...h),m.map(p=>i.startsWith("/")&&p===""?"/":p)}function Yb(i){i.sort((a,r)=>a.score!==r.score?r.score-a.score:tx(a.routesMeta.map(s=>s.childrenIndex),r.routesMeta.map(s=>s.childrenIndex)))}var Qb=/^:[\w-]+$/,Kb=3,Wb=2,Jb=1,Xb=10,Zb=-2,bp=i=>i==="*";function ex(i,a){let r=i.split("/"),s=r.length;return r.some(bp)&&(s+=Zb),a&&(s+=Wb),r.filter(o=>!bp(o)).reduce((o,c)=>o+(Qb.test(c)?Kb:c===""?Jb:Xb),s)}function tx(i,a){return i.length===a.length&&i.slice(0,-1).every((s,o)=>s===a[o])?i[i.length-1]-a[a.length-1]:0}function ax(i,a,r=!1){let{routesMeta:s}=i,o={},c="/",h=[];for(let m=0;m<s.length;++m){let p=s[m],g=m===s.length-1,v=c==="/"?a:a.slice(c.length)||"/",b=xl({path:p.relativePath,caseSensitive:p.caseSensitive,end:g},v),x=p.route;if(!b&&g&&r&&!s[s.length-1].route.index&&(b=xl({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},v)),!b)return null;Object.assign(o,b.params),h.push({params:o,pathname:Ca([c,b.pathname]),pathnameBase:ox(Ca([c,b.pathnameBase])),route:x}),b.pathnameBase!=="/"&&(c=Ca([c,b.pathnameBase]))}return h}function xl(i,a){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[r,s]=rx(i.path,i.caseSensitive,i.end),o=a.match(r);if(!o)return null;let c=o[0],h=c.replace(/(.)\/+$/,"$1"),m=o.slice(1);return{params:s.reduce((g,{paramName:v,isOptional:b},x)=>{if(v==="*"){let C=m[x]||"";h=c.slice(0,c.length-C.length).replace(/(.)\/+$/,"$1")}const _=m[x];return b&&!_?g[v]=void 0:g[v]=(_||"").replace(/%2F/g,"/"),g},{}),pathname:c,pathnameBase:h,pattern:i}}function rx(i,a=!1,r=!0){Kt(i==="*"||!i.endsWith("*")||i.endsWith("/*"),`Route path "${i}" will be treated as if it were "${i.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${i.replace(/\*$/,"/*")}".`);let s=[],o="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(h,m,p)=>(s.push({paramName:m,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return i.endsWith("*")?(s.push({paramName:"*"}),o+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?o+="\\/*$":i!==""&&i!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,a?void 0:"i"),s]}function nx(i){try{return i.split("/").map(a=>decodeURIComponent(a).replace(/\//g,"%2F")).join("/")}catch(a){return Kt(!1,`The URL path "${i}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${a}).`),i}}function ja(i,a){if(a==="/")return i;if(!i.toLowerCase().startsWith(a.toLowerCase()))return null;let r=a.endsWith("/")?a.length-1:a.length,s=i.charAt(r);return s&&s!=="/"?null:i.slice(r)||"/"}function sx(i,a="/"){let{pathname:r,search:s="",hash:o=""}=typeof i=="string"?jn(i):i;return{pathname:r?r.startsWith("/")?r:ix(r,a):a,search:cx(s),hash:ux(o)}}function ix(i,a){let r=a.replace(/\/+$/,"").split("/");return i.split("/").forEach(o=>{o===".."?r.length>1&&r.pop():o!=="."&&r.push(o)}),r.length>1?r.join("/"):"/"}function ru(i,a,r,s){return`Cannot include a '${i}' character in a manually specified \`to.${a}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function lx(i){return i.filter((a,r)=>r===0||a.route.path&&a.route.path.length>0)}function Hu(i){let a=lx(i);return a.map((r,s)=>s===a.length-1?r.pathname:r.pathnameBase)}function Vu(i,a,r,s=!1){let o;typeof i=="string"?o=jn(i):(o={...i},Pe(!o.pathname||!o.pathname.includes("?"),ru("?","pathname","search",o)),Pe(!o.pathname||!o.pathname.includes("#"),ru("#","pathname","hash",o)),Pe(!o.search||!o.search.includes("#"),ru("#","search","hash",o)));let c=i===""||o.pathname==="",h=c?"/":o.pathname,m;if(h==null)m=r;else{let b=a.length-1;if(!s&&h.startsWith("..")){let x=h.split("/");for(;x[0]==="..";)x.shift(),b-=1;o.pathname=x.join("/")}m=b>=0?a[b]:"/"}let p=sx(o,m),g=h&&h!=="/"&&h.endsWith("/"),v=(c||h===".")&&r.endsWith("/");return!p.pathname.endsWith("/")&&(g||v)&&(p.pathname+="/"),p}var Ca=i=>i.join("/").replace(/\/\/+/g,"/"),ox=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),cx=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,ux=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;function dx(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Cg=["POST","PUT","PATCH","DELETE"];new Set(Cg);var hx=["GET",...Cg];new Set(hx);var An=S.createContext(null);An.displayName="DataRouter";var Rl=S.createContext(null);Rl.displayName="DataRouterState";S.createContext(!1);var jg=S.createContext({isTransitioning:!1});jg.displayName="ViewTransition";var fx=S.createContext(new Map);fx.displayName="Fetchers";var mx=S.createContext(null);mx.displayName="Await";var Wt=S.createContext(null);Wt.displayName="Navigation";var qs=S.createContext(null);qs.displayName="Location";var Jt=S.createContext({outlet:null,matches:[],isDataRoute:!1});Jt.displayName="Route";var Fu=S.createContext(null);Fu.displayName="RouteError";function px(i,{relative:a}={}){Pe(Nn(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:s}=S.useContext(Wt),{hash:o,pathname:c,search:h}=$s(i,{relative:a}),m=c;return r!=="/"&&(m=c==="/"?r:Ca([r,c])),s.createHref({pathname:m,search:h,hash:o})}function Nn(){return S.useContext(qs)!=null}function aa(){return Pe(Nn(),"useLocation() may be used only in the context of a <Router> component."),S.useContext(qs).location}var Ag="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Ng(i){S.useContext(Wt).static||S.useLayoutEffect(i)}function Ps(){let{isDataRoute:i}=S.useContext(Jt);return i?Rx():gx()}function gx(){Pe(Nn(),"useNavigate() may be used only in the context of a <Router> component.");let i=S.useContext(An),{basename:a,navigator:r}=S.useContext(Wt),{matches:s}=S.useContext(Jt),{pathname:o}=aa(),c=JSON.stringify(Hu(s)),h=S.useRef(!1);return Ng(()=>{h.current=!0}),S.useCallback((p,g={})=>{if(Kt(h.current,Ag),!h.current)return;if(typeof p=="number"){r.go(p);return}let v=Vu(p,JSON.parse(c),o,g.relative==="path");i==null&&a!=="/"&&(v.pathname=v.pathname==="/"?a:Ca([a,v.pathname])),(g.replace?r.replace:r.push)(v,g.state,g)},[a,r,c,o,i])}S.createContext(null);function yx(){let{matches:i}=S.useContext(Jt),a=i[i.length-1];return a?a.params:{}}function $s(i,{relative:a}={}){let{matches:r}=S.useContext(Jt),{pathname:s}=aa(),o=JSON.stringify(Hu(r));return S.useMemo(()=>Vu(i,JSON.parse(o),s,a==="path"),[i,o,s,a])}function vx(i,a){return Eg(i,a)}function Eg(i,a,r,s,o){Pe(Nn(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:c}=S.useContext(Wt),{matches:h}=S.useContext(Jt),m=h[h.length-1],p=m?m.params:{},g=m?m.pathname:"/",v=m?m.pathnameBase:"/",b=m&&m.route;{let k=b&&b.path||"";Rg(g,!b||k.endsWith("*")||k.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${g}" (under <Route path="${k}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${k}"> to <Route path="${k==="/"?"*":`${k}/*`}">.`)}let x=aa(),_;if(a){let k=typeof a=="string"?jn(a):a;Pe(v==="/"||k.pathname?.startsWith(v),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${v}" but pathname "${k.pathname}" was given in the \`location\` prop.`),_=k}else _=x;let C=_.pathname||"/",j=C;if(v!=="/"){let k=v.replace(/^\//,"").split("/");j="/"+C.replace(/^\//,"").split("/").slice(k.length).join("/")}let A=_g(i,{pathname:j});Kt(b||A!=null,`No routes matched location "${_.pathname}${_.search}${_.hash}" `),Kt(A==null||A[A.length-1].route.element!==void 0||A[A.length-1].route.Component!==void 0||A[A.length-1].route.lazy!==void 0,`Matched leaf route at location "${_.pathname}${_.search}${_.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let R=Sx(A&&A.map(k=>Object.assign({},k,{params:Object.assign({},p,k.params),pathname:Ca([v,c.encodeLocation?c.encodeLocation(k.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:k.pathname]),pathnameBase:k.pathnameBase==="/"?v:Ca([v,c.encodeLocation?c.encodeLocation(k.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:k.pathnameBase])})),h,r,s,o);return a&&R?S.createElement(qs.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",..._},navigationType:"POP"}},R):R}function bx(){let i=Ex(),a=dx(i)?`${i.status} ${i.statusText}`:i instanceof Error?i.message:JSON.stringify(i),r=i instanceof Error?i.stack:null,s="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:s},c={padding:"2px 4px",backgroundColor:s},h=null;return console.error("Error handled by React Router default ErrorBoundary:",i),h=S.createElement(S.Fragment,null,S.createElement("p",null," Hey developer "),S.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",S.createElement("code",{style:c},"ErrorBoundary")," or"," ",S.createElement("code",{style:c},"errorElement")," prop on your route.")),S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},a),r?S.createElement("pre",{style:o},r):null,h)}var xx=S.createElement(bx,null),_x=class extends S.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,a){return a.location!==i.location||a.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:a.error,location:a.location,revalidation:i.revalidation||a.revalidation}}componentDidCatch(i,a){this.props.unstable_onError?this.props.unstable_onError(i,a):console.error("React Router caught the following error during render",i)}render(){return this.state.error!==void 0?S.createElement(Jt.Provider,{value:this.props.routeContext},S.createElement(Fu.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function wx({routeContext:i,match:a,children:r}){let s=S.useContext(An);return s&&s.static&&s.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=a.route.id),S.createElement(Jt.Provider,{value:i},r)}function Sx(i,a=[],r=null,s=null,o=null){if(i==null){if(!r)return null;if(r.errors)i=r.matches;else if(a.length===0&&!r.initialized&&r.matches.length>0)i=r.matches;else return null}let c=i,h=r?.errors;if(h!=null){let g=c.findIndex(v=>v.route.id&&h?.[v.route.id]!==void 0);Pe(g>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(h).join(",")}`),c=c.slice(0,Math.min(c.length,g+1))}let m=!1,p=-1;if(r)for(let g=0;g<c.length;g++){let v=c[g];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(p=g),v.route.id){let{loaderData:b,errors:x}=r,_=v.route.loader&&!b.hasOwnProperty(v.route.id)&&(!x||x[v.route.id]===void 0);if(v.route.lazy||_){m=!0,p>=0?c=c.slice(0,p+1):c=[c[0]];break}}}return c.reduceRight((g,v,b)=>{let x,_=!1,C=null,j=null;r&&(x=h&&v.route.id?h[v.route.id]:void 0,C=v.route.errorElement||xx,m&&(p<0&&b===0?(Rg("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,j=null):p===b&&(_=!0,j=v.route.hydrateFallbackElement||null)));let A=a.concat(c.slice(0,b+1)),R=()=>{let k;return x?k=C:_?k=j:v.route.Component?k=S.createElement(v.route.Component,null):v.route.element?k=v.route.element:k=g,S.createElement(wx,{match:v,routeContext:{outlet:g,matches:A,isDataRoute:r!=null},children:k})};return r&&(v.route.ErrorBoundary||v.route.errorElement||b===0)?S.createElement(_x,{location:r.location,revalidation:r.revalidation,component:C,error:x,children:R(),routeContext:{outlet:null,matches:A,isDataRoute:!0},unstable_onError:s}):R()},null)}function Gu(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Cx(i){let a=S.useContext(An);return Pe(a,Gu(i)),a}function jx(i){let a=S.useContext(Rl);return Pe(a,Gu(i)),a}function Ax(i){let a=S.useContext(Jt);return Pe(a,Gu(i)),a}function Iu(i){let a=Ax(i),r=a.matches[a.matches.length-1];return Pe(r.route.id,`${i} can only be used on routes that contain a unique "id"`),r.route.id}function Nx(){return Iu("useRouteId")}function Ex(){let i=S.useContext(Fu),a=jx("useRouteError"),r=Iu("useRouteError");return i!==void 0?i:a.errors?.[r]}function Rx(){let{router:i}=Cx("useNavigate"),a=Iu("useNavigate"),r=S.useRef(!1);return Ng(()=>{r.current=!0}),S.useCallback(async(o,c={})=>{Kt(r.current,Ag),r.current&&(typeof o=="number"?i.navigate(o):await i.navigate(o,{fromRouteId:a,...c}))},[i,a])}var xp={};function Rg(i,a,r){!a&&!xp[i]&&(xp[i]=!0,Kt(!1,r))}S.memo(Tx);function Tx({routes:i,future:a,state:r,unstable_onError:s}){return Eg(i,void 0,r,s,a)}function kx({to:i,replace:a,state:r,relative:s}){Pe(Nn(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=S.useContext(Wt);Kt(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:c}=S.useContext(Jt),{pathname:h}=aa(),m=Ps(),p=Vu(i,Hu(c),h,s==="path"),g=JSON.stringify(p);return S.useEffect(()=>{m(JSON.parse(g),{replace:a,state:r,relative:s})},[m,g,s,a,r]),null}function vn(i){Pe(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Ox({basename:i="/",children:a=null,location:r,navigationType:s="POP",navigator:o,static:c=!1}){Pe(!Nn(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let h=i.replace(/^\/*/,"/"),m=S.useMemo(()=>({basename:h,navigator:o,static:c,future:{}}),[h,o,c]);typeof r=="string"&&(r=jn(r));let{pathname:p="/",search:g="",hash:v="",state:b=null,key:x="default"}=r,_=S.useMemo(()=>{let C=ja(p,h);return C==null?null:{location:{pathname:C,search:g,hash:v,state:b,key:x},navigationType:s}},[h,p,g,v,b,x,s]);return Kt(_!=null,`<Router basename="${h}"> is not able to match the URL "${p}${g}${v}" because it does not start with the basename, so the <Router> won't render anything.`),_==null?null:S.createElement(Wt.Provider,{value:m},S.createElement(qs.Provider,{children:a,value:_}))}function Dx({children:i,location:a}){return vx(Su(i),a)}function Su(i,a=[]){let r=[];return S.Children.forEach(i,(s,o)=>{if(!S.isValidElement(s))return;let c=[...a,o];if(s.type===S.Fragment){r.push.apply(r,Su(s.props.children,c));return}Pe(s.type===vn,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Pe(!s.props.index||!s.props.children,"An index route cannot have child routes.");let h={id:s.props.id||c.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(h.children=Su(s.props.children,c)),r.push(h)}),r}var yl="get",vl="application/x-www-form-urlencoded";function Tl(i){return i!=null&&typeof i.tagName=="string"}function Mx(i){return Tl(i)&&i.tagName.toLowerCase()==="button"}function Ux(i){return Tl(i)&&i.tagName.toLowerCase()==="form"}function zx(i){return Tl(i)&&i.tagName.toLowerCase()==="input"}function Lx(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function Bx(i,a){return i.button===0&&(!a||a==="_self")&&!Lx(i)}var ll=null;function qx(){if(ll===null)try{new FormData(document.createElement("form"),0),ll=!1}catch{ll=!0}return ll}var Px=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function nu(i){return i!=null&&!Px.has(i)?(Kt(!1,`"${i}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${vl}"`),null):i}function $x(i,a){let r,s,o,c,h;if(Ux(i)){let m=i.getAttribute("action");s=m?ja(m,a):null,r=i.getAttribute("method")||yl,o=nu(i.getAttribute("enctype"))||vl,c=new FormData(i)}else if(Mx(i)||zx(i)&&(i.type==="submit"||i.type==="image")){let m=i.form;if(m==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let p=i.getAttribute("formaction")||m.getAttribute("action");if(s=p?ja(p,a):null,r=i.getAttribute("formmethod")||m.getAttribute("method")||yl,o=nu(i.getAttribute("formenctype"))||nu(m.getAttribute("enctype"))||vl,c=new FormData(m,i),!qx()){let{name:g,type:v,value:b}=i;if(v==="image"){let x=g?`${g}.`:"";c.append(`${x}x`,"0"),c.append(`${x}y`,"0")}else g&&c.append(g,b)}}else{if(Tl(i))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=yl,s=null,o=vl,h=i}return c&&o==="text/plain"&&(h=c,c=void 0),{action:s,method:r.toLowerCase(),encType:o,formData:c,body:h}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Yu(i,a){if(i===!1||i===null||typeof i>"u")throw new Error(a)}function Hx(i,a,r){let s=typeof i=="string"?new URL(i,typeof window>"u"?"server://singlefetch/":window.location.origin):i;return s.pathname==="/"?s.pathname=`_root.${r}`:a&&ja(s.pathname,a)==="/"?s.pathname=`${a.replace(/\/$/,"")}/_root.${r}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${r}`,s}async function Vx(i,a){if(i.id in a)return a[i.id];try{let r=await import(i.module);return a[i.id]=r,r}catch(r){return console.error(`Error loading route module \`${i.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Fx(i){return i==null?!1:i.href==null?i.rel==="preload"&&typeof i.imageSrcSet=="string"&&typeof i.imageSizes=="string":typeof i.rel=="string"&&typeof i.href=="string"}async function Gx(i,a,r){let s=await Promise.all(i.map(async o=>{let c=a.routes[o.route.id];if(c){let h=await Vx(c,r);return h.links?h.links():[]}return[]}));return Kx(s.flat(1).filter(Fx).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function _p(i,a,r,s,o,c){let h=(p,g)=>r[g]?p.route.id!==r[g].route.id:!0,m=(p,g)=>r[g].pathname!==p.pathname||r[g].route.path?.endsWith("*")&&r[g].params["*"]!==p.params["*"];return c==="assets"?a.filter((p,g)=>h(p,g)||m(p,g)):c==="data"?a.filter((p,g)=>{let v=s.routes[p.route.id];if(!v||!v.hasLoader)return!1;if(h(p,g)||m(p,g))return!0;if(p.route.shouldRevalidate){let b=p.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(i,window.origin),nextParams:p.params,defaultShouldRevalidate:!0});if(typeof b=="boolean")return b}return!0}):[]}function Ix(i,a,{includeHydrateFallback:r}={}){return Yx(i.map(s=>{let o=a.routes[s.route.id];if(!o)return[];let c=[o.module];return o.clientActionModule&&(c=c.concat(o.clientActionModule)),o.clientLoaderModule&&(c=c.concat(o.clientLoaderModule)),r&&o.hydrateFallbackModule&&(c=c.concat(o.hydrateFallbackModule)),o.imports&&(c=c.concat(o.imports)),c}).flat(1))}function Yx(i){return[...new Set(i)]}function Qx(i){let a={},r=Object.keys(i).sort();for(let s of r)a[s]=i[s];return a}function Kx(i,a){let r=new Set;return new Set(a),i.reduce((s,o)=>{let c=JSON.stringify(Qx(o));return r.has(c)||(r.add(c),s.push({key:c,link:o})),s},[])}function Tg(){let i=S.useContext(An);return Yu(i,"You must render this element inside a <DataRouterContext.Provider> element"),i}function Wx(){let i=S.useContext(Rl);return Yu(i,"You must render this element inside a <DataRouterStateContext.Provider> element"),i}var Qu=S.createContext(void 0);Qu.displayName="FrameworkContext";function kg(){let i=S.useContext(Qu);return Yu(i,"You must render this element inside a <HydratedRouter> element"),i}function Jx(i,a){let r=S.useContext(Qu),[s,o]=S.useState(!1),[c,h]=S.useState(!1),{onFocus:m,onBlur:p,onMouseEnter:g,onMouseLeave:v,onTouchStart:b}=a,x=S.useRef(null);S.useEffect(()=>{if(i==="render"&&h(!0),i==="viewport"){let j=R=>{R.forEach(k=>{h(k.isIntersecting)})},A=new IntersectionObserver(j,{threshold:.5});return x.current&&A.observe(x.current),()=>{A.disconnect()}}},[i]),S.useEffect(()=>{if(s){let j=setTimeout(()=>{h(!0)},100);return()=>{clearTimeout(j)}}},[s]);let _=()=>{o(!0)},C=()=>{o(!1),h(!1)};return r?i!=="intent"?[c,x,{}]:[c,x,{onFocus:Ns(m,_),onBlur:Ns(p,C),onMouseEnter:Ns(g,_),onMouseLeave:Ns(v,C),onTouchStart:Ns(b,_)}]:[!1,x,{}]}function Ns(i,a){return r=>{i&&i(r),r.defaultPrevented||a(r)}}function Xx({page:i,...a}){let{router:r}=Tg(),s=S.useMemo(()=>_g(r.routes,i,r.basename),[r.routes,i,r.basename]);return s?S.createElement(e_,{page:i,matches:s,...a}):null}function Zx(i){let{manifest:a,routeModules:r}=kg(),[s,o]=S.useState([]);return S.useEffect(()=>{let c=!1;return Gx(i,a,r).then(h=>{c||o(h)}),()=>{c=!0}},[i,a,r]),s}function e_({page:i,matches:a,...r}){let s=aa(),{manifest:o,routeModules:c}=kg(),{basename:h}=Tg(),{loaderData:m,matches:p}=Wx(),g=S.useMemo(()=>_p(i,a,p,o,s,"data"),[i,a,p,o,s]),v=S.useMemo(()=>_p(i,a,p,o,s,"assets"),[i,a,p,o,s]),b=S.useMemo(()=>{if(i===s.pathname+s.search+s.hash)return[];let C=new Set,j=!1;if(a.forEach(R=>{let k=o.routes[R.route.id];!k||!k.hasLoader||(!g.some(O=>O.route.id===R.route.id)&&R.route.id in m&&c[R.route.id]?.shouldRevalidate||k.hasClientLoader?j=!0:C.add(R.route.id))}),C.size===0)return[];let A=Hx(i,h,"data");return j&&C.size>0&&A.searchParams.set("_routes",a.filter(R=>C.has(R.route.id)).map(R=>R.route.id).join(",")),[A.pathname+A.search]},[h,m,s,o,g,a,i,c]),x=S.useMemo(()=>Ix(v,o),[v,o]),_=Zx(v);return S.createElement(S.Fragment,null,b.map(C=>S.createElement("link",{key:C,rel:"prefetch",as:"fetch",href:C,...r})),x.map(C=>S.createElement("link",{key:C,rel:"modulepreload",href:C,...r})),_.map(({key:C,link:j})=>S.createElement("link",{key:C,nonce:r.nonce,...j})))}function t_(...i){return a=>{i.forEach(r=>{typeof r=="function"?r(a):r!=null&&(r.current=a)})}}var Og=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Og&&(window.__reactRouterVersion="7.9.5")}catch{}function a_({basename:i,children:a,window:r}){let s=S.useRef();s.current==null&&(s.current=Hb({window:r,v5Compat:!0}));let o=s.current,[c,h]=S.useState({action:o.action,location:o.location}),m=S.useCallback(p=>{S.startTransition(()=>h(p))},[h]);return S.useLayoutEffect(()=>o.listen(m),[o,m]),S.createElement(Ox,{basename:i,children:a,location:c.location,navigationType:c.action,navigator:o})}var Dg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Mg=S.forwardRef(function({onClick:a,discover:r="render",prefetch:s="none",relative:o,reloadDocument:c,replace:h,state:m,target:p,to:g,preventScrollReset:v,viewTransition:b,...x},_){let{basename:C}=S.useContext(Wt),j=typeof g=="string"&&Dg.test(g),A,R=!1;if(typeof g=="string"&&j&&(A=g,Og))try{let q=new URL(window.location.href),K=g.startsWith("//")?new URL(q.protocol+g):new URL(g),de=ja(K.pathname,C);K.origin===q.origin&&de!=null?g=de+K.search+K.hash:R=!0}catch{Kt(!1,`<Link to="${g}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let k=px(g,{relative:o}),[O,H,I]=Jx(s,x),V=i_(g,{replace:h,state:m,target:p,preventScrollReset:v,relative:o,viewTransition:b});function re(q){a&&a(q),q.defaultPrevented||V(q)}let G=S.createElement("a",{...x,...I,href:A||k,onClick:R||c?a:re,ref:t_(_,H),target:p,"data-discover":!j&&r==="render"?"true":void 0});return O&&!j?S.createElement(S.Fragment,null,G,S.createElement(Xx,{page:k})):G});Mg.displayName="Link";var r_=S.forwardRef(function({"aria-current":a="page",caseSensitive:r=!1,className:s="",end:o=!1,style:c,to:h,viewTransition:m,children:p,...g},v){let b=$s(h,{relative:g.relative}),x=aa(),_=S.useContext(Rl),{navigator:C,basename:j}=S.useContext(Wt),A=_!=null&&d_(b)&&m===!0,R=C.encodeLocation?C.encodeLocation(b).pathname:b.pathname,k=x.pathname,O=_&&_.navigation&&_.navigation.location?_.navigation.location.pathname:null;r||(k=k.toLowerCase(),O=O?O.toLowerCase():null,R=R.toLowerCase()),O&&j&&(O=ja(O,j)||O);const H=R!=="/"&&R.endsWith("/")?R.length-1:R.length;let I=k===R||!o&&k.startsWith(R)&&k.charAt(H)==="/",V=O!=null&&(O===R||!o&&O.startsWith(R)&&O.charAt(R.length)==="/"),re={isActive:I,isPending:V,isTransitioning:A},G=I?a:void 0,q;typeof s=="function"?q=s(re):q=[s,I?"active":null,V?"pending":null,A?"transitioning":null].filter(Boolean).join(" ");let K=typeof c=="function"?c(re):c;return S.createElement(Mg,{...g,"aria-current":G,className:q,ref:v,style:K,to:h,viewTransition:m},typeof p=="function"?p(re):p)});r_.displayName="NavLink";var n_=S.forwardRef(({discover:i="render",fetcherKey:a,navigate:r,reloadDocument:s,replace:o,state:c,method:h=yl,action:m,onSubmit:p,relative:g,preventScrollReset:v,viewTransition:b,...x},_)=>{let C=c_(),j=u_(m,{relative:g}),A=h.toLowerCase()==="get"?"get":"post",R=typeof m=="string"&&Dg.test(m),k=O=>{if(p&&p(O),O.defaultPrevented)return;O.preventDefault();let H=O.nativeEvent.submitter,I=H?.getAttribute("formmethod")||h;C(H||O.currentTarget,{fetcherKey:a,method:I,navigate:r,replace:o,state:c,relative:g,preventScrollReset:v,viewTransition:b})};return S.createElement("form",{ref:_,method:A,action:j,onSubmit:s?p:k,...x,"data-discover":!R&&i==="render"?"true":void 0})});n_.displayName="Form";function s_(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Ug(i){let a=S.useContext(An);return Pe(a,s_(i)),a}function i_(i,{target:a,replace:r,state:s,preventScrollReset:o,relative:c,viewTransition:h}={}){let m=Ps(),p=aa(),g=$s(i,{relative:c});return S.useCallback(v=>{if(Bx(v,a)){v.preventDefault();let b=r!==void 0?r:Ds(p)===Ds(g);m(i,{replace:b,state:s,preventScrollReset:o,relative:c,viewTransition:h})}},[p,m,g,r,s,a,i,o,c,h])}var l_=0,o_=()=>`__${String(++l_)}__`;function c_(){let{router:i}=Ug("useSubmit"),{basename:a}=S.useContext(Wt),r=Nx();return S.useCallback(async(s,o={})=>{let{action:c,method:h,encType:m,formData:p,body:g}=$x(s,a);if(o.navigate===!1){let v=o.fetcherKey||o_();await i.fetch(v,r,o.action||c,{preventScrollReset:o.preventScrollReset,formData:p,body:g,formMethod:o.method||h,formEncType:o.encType||m,flushSync:o.flushSync})}else await i.navigate(o.action||c,{preventScrollReset:o.preventScrollReset,formData:p,body:g,formMethod:o.method||h,formEncType:o.encType||m,replace:o.replace,state:o.state,fromRouteId:r,flushSync:o.flushSync,viewTransition:o.viewTransition})},[i,a,r])}function u_(i,{relative:a}={}){let{basename:r}=S.useContext(Wt),s=S.useContext(Jt);Pe(s,"useFormAction must be used inside a RouteContext");let[o]=s.matches.slice(-1),c={...$s(i||".",{relative:a})},h=aa();if(i==null){c.search=h.search;let m=new URLSearchParams(c.search),p=m.getAll("index");if(p.some(v=>v==="")){m.delete("index"),p.filter(b=>b).forEach(b=>m.append("index",b));let v=m.toString();c.search=v?`?${v}`:""}}return(!i||i===".")&&o.route.index&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(c.pathname=c.pathname==="/"?r:Ca([r,c.pathname])),Ds(c)}function d_(i,{relative:a}={}){let r=S.useContext(jg);Pe(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=Ug("useViewTransitionState"),o=$s(i,{relative:a});if(!r.isTransitioning)return!1;let c=ja(r.currentLocation.pathname,s)||r.currentLocation.pathname,h=ja(r.nextLocation.pathname,s)||r.nextLocation.pathname;return xl(o.pathname,h)!=null||xl(o.pathname,c)!=null}function _l(i){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i)}function wp(i){if(!i?.trim())return{isValid:!1,error:"Username is required"};const a=i.trim();return a.length<3||a.length>30?{isValid:!1,error:"Username must be between 3 and 30 characters"}:/^[a-zA-Z0-9_-]+$/.test(a)?{isValid:!0}:{isValid:!1,error:"Username can only contain letters, numbers, hyphens, and underscores"}}function h_(i){if(!i)return{isValid:!1,error:"Password is required"};if(i.length<8)return{isValid:!1,error:"Password must be at least 8 characters long"};const a=/[a-z]/.test(i),r=/[A-Z]/.test(i),s=/\d/.test(i),o=/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]/.test(i);return!a||!r||!s||!o?{isValid:!1,error:"Password must contain at least one uppercase letter, one lowercase letter, one number, and one special character"}:{isValid:!0}}function Sp(i){return i?.trim()?i.length>100?{isValid:!1,error:"Campaign name must be 100 characters or less"}:{isValid:!0}:{isValid:!1,error:"Campaign name is required"}}function Cp(i){return["admin","gm","player"].includes(i)}function zg(i){const{isAdmin:a,isGm:r,isPlayer:s}=i;return!(!a&&!r&&!s||r&&s&&!a)}function su(i){return typeof i=="string"?["admin","gm"].includes(i):i.isAdmin||i.isGm}function f_(i){return typeof i=="string"?i==="admin":i.isAdmin}function m_(i){return typeof i=="string"?i==="admin":i.isAdmin}function kl(i){const a=[];return i.isAdmin&&a.push("Admin"),i.isGm&&a.push("GM"),i.isPlayer&&a.push("Player"),a.length===0?"No roles":a.length===1?a[0]:a.length===2?a.join(" + "):`${a.slice(0,-1).join(", ")} + ${a[a.length-1]}`}function Es(i,a){return`Only ${a.length===1?`${a[0]}s`:`${a.slice(0,-1).join(", ")} and ${a[a.length-1]}s`} can ${i}`}class p_{authRepository;constructor(a){this.authRepository=a}async getCurrentUser(){return this.authRepository.getCurrentUser()}async signIn(a,r){return!a||!r?{success:!1,error:"Email and password are required"}:_l(a)?this.authRepository.signIn(a,r):{success:!1,error:"Invalid email format"}}async signUp(a,r){return!a||!r?{success:!1,error:"Email and password are required"}:_l(a)?r.length<6?{success:!1,error:"Password must be at least 6 characters"}:this.authRepository.signUp(a,r):{success:!1,error:"Invalid email format"}}async signOut(){return this.authRepository.signOut()}onAuthStateChange(a){return this.authRepository.onAuthStateChange(a)}async completeProfile(a){const r=await this.authRepository.getCurrentUser();if(!r)return{success:!1,error:"User not authenticated"};if(!a.displayName?.trim())return{success:!1,error:"Display name is required"};const s=wp(a.username);return s.isValid?this.authRepository.completeProfile(r.id,a.displayName.trim(),a.username.trim()):{success:!1,error:s.error}}async updateProfile(a){const r=await this.authRepository.getCurrentUser();if(!r)return{success:!1,error:"User not authenticated"};if(a.displayName!==void 0&&!a.displayName?.trim())return{success:!1,error:"Display name cannot be empty"};if(a.username!==void 0){const s=wp(a.username);if(!s.isValid)return{success:!1,error:s.error}}return this.authRepository.updateProfile(r.id,a.displayName?.trim(),a.username?.trim())}async changePassword(a){const r=await this.authRepository.getCurrentUser();if(!r)return{success:!1,error:"User not authenticated"};if(!a.currentPassword)return{success:!1,error:"Current password is required"};const s=h_(a.newPassword);return s.isValid?this.authRepository.changePassword(r.id,a.currentPassword,a.newPassword):{success:!1,error:s.error}}async deleteAccount(){const a=await this.authRepository.getCurrentUser();return a?this.authRepository.deleteAccount(a.id):{success:!1,error:"User not authenticated"}}}class g_{campaignRepository;authRepository;constructor(a,r){this.campaignRepository=a,this.authRepository=r}async getCampaigns(){const a=await this.authRepository.getCurrentUser();return a?this.campaignRepository.getCampaigns(a.id):{success:!1,error:"User not authenticated"}}async getCampaign(a){const r=await this.authRepository.getCurrentUser();if(!r)return{success:!1,error:"User not authenticated"};const s=await this.campaignRepository.canUserAccessCampaign(a,r.id);return!s.success||!s.data?{success:!1,error:"Access denied to this campaign"}:this.campaignRepository.getCampaign(a)}async createCampaign(a){const r=await this.authRepository.getCurrentUser();if(!r)return{success:!1,error:"User not authenticated"};const s=Sp(a.name);if(!s.isValid)return{success:!1,error:s.error};const o=a.creatorIsAlsoGM||!1;if(a.initialMembers)for(const h of a.initialMembers){if(!_l(h.email))return{success:!1,error:`Invalid email format: ${h.email}`};if(!Cp(h.role))return{success:!1,error:`Invalid role: ${h.role}`}}const c=await this.campaignRepository.createCampaign(r.id,{name:a.name.trim(),description:a.description?.trim()},o);if(!c.success)return c;if(a.initialMembers&&a.initialMembers.length>0&&c.data)for(const h of a.initialMembers)await this.campaignRepository.addMemberByEmail(c.data.id,h.email.trim(),h.role);return c}async updateCampaign(a,r){const s=await this.authRepository.getCurrentUser();if(!s)return{success:!1,error:"User not authenticated"};const o=await this.campaignRepository.getUserRole(a,s.id);if(!o.success||!o.data||!f_(o.data))return{success:!1,error:Es("update campaigns",["admin"])};if(r.name!==void 0){const h=Sp(r.name);if(!h.isValid)return{success:!1,error:h.error}}const c={};return r.name!==void 0&&(c.name=r.name.trim()),r.description!==void 0&&(c.description=r.description?.trim()),this.campaignRepository.updateCampaign(a,c)}async deleteCampaign(a){const r=await this.authRepository.getCurrentUser();if(!r)return{success:!1,error:"User not authenticated"};const s=await this.campaignRepository.getUserRole(a,r.id);return!s.success||!s.data||!m_(s.data)?{success:!1,error:Es("delete campaigns",["admin"])}:this.campaignRepository.deleteCampaign(a)}async getCampaignMembers(a){const r=await this.authRepository.getCurrentUser();if(!r)return{success:!1,error:"User not authenticated"};const s=await this.campaignRepository.canUserAccessCampaign(a,r.id);return!s.success||!s.data?{success:!1,error:"Access denied to this campaign"}:this.campaignRepository.getCampaignMembers(a)}async addMemberByEmail(a,r,s){const o=await this.authRepository.getCurrentUser();if(!o)return{success:!1,error:"User not authenticated"};const c=await this.campaignRepository.getUserRole(a,o.id);return!c.success||!c.data||!su(c.data)?{success:!1,error:Es("add members",["admin","gm"])}:r?.trim()?_l(r)?Cp(s)?this.campaignRepository.addMemberByEmail(a,r.trim(),s):{success:!1,error:"Invalid role specified"}:{success:!1,error:"Invalid email format"}:{success:!1,error:"Email is required"}}async updateMemberRole(a,r,s){const o=await this.authRepository.getCurrentUser();if(!o)return{success:!1,error:"User not authenticated"};const c=await this.campaignRepository.getUserRole(a,o.id);return!c.success||!c.data||!su(c.data)?{success:!1,error:Es("update member roles",["admin","gm"])}:zg(s)?this.campaignRepository.updateMemberRole(a,r,s):{success:!1,error:"Invalid role combination. Must have at least one role and cannot be GM+Player without Admin."}}async removeMember(a,r){const s=await this.authRepository.getCurrentUser();if(!s)return{success:!1,error:"User not authenticated"};const o=await this.campaignRepository.getUserRole(a,s.id);return!o.success||!o.data||!su(o.data)?{success:!1,error:Es("remove members",["admin","gm"])}:this.campaignRepository.removeMember(a,r)}}class Qt{static instance;_authRepository;_campaignRepository;_campaignDataRepository;_characterRepository;_authService;_campaignService;constructor(){}static getInstance(){return Qt.instance||(Qt.instance=new Qt),Qt.instance}init(a){this._authRepository=a.authRepository,this._campaignRepository=a.campaignRepository,this._campaignDataRepository=a.campaignDataRepository,this._characterRepository=a.characterRepository,this._authService=new p_(this._authRepository),this._campaignService=new g_(this._campaignRepository,this._authRepository)}ensureInitialized(){if(!this._authService)throw new Error("ServiceContainer not initialized. Call init() first.")}get authService(){return this.ensureInitialized(),this._authService}get campaignService(){return this.ensureInitialized(),this._campaignService}get authRepository(){return this.ensureInitialized(),this._authRepository}get campaignRepository(){return this.ensureInitialized(),this._campaignRepository}get campaignDataRepository(){return this.ensureInitialized(),this._campaignDataRepository}get characterRepository(){return this.ensureInitialized(),this._characterRepository}}const y_=()=>Qt.getInstance().authService,Lg=()=>Qt.getInstance().campaignService,Ku=()=>Qt.getInstance().campaignRepository,v_=()=>Qt.getInstance().characterRepository,b_=()=>Qt.getInstance().campaignDataRepository,Za=()=>{const[i,a]=S.useState(null),[r,s]=S.useState(!0),o=y_();return S.useEffect(()=>((async()=>{const C=await o.getCurrentUser();a(C),s(!1)})(),o.onAuthStateChange(C=>{a(C),s(!1)})),[o]),{user:i,loading:r,signIn:async(x,_)=>{const C=await o.signIn(x,_);return C.success&&C.data?(a(C.data),{success:!0}):{success:!1,error:C.error}},signUp:async(x,_)=>{const C=await o.signUp(x,_);return C.success&&C.data?(a(C.data),{success:!0}):{success:!1,error:C.error}},signOut:async()=>{const x=await o.signOut();return x.success?(a(null),{success:!0}):{success:!1,error:x.error}},completeProfile:async x=>{const _=await o.completeProfile(x);return _.success&&_.data?(a(_.data),{success:!0,user:_.data}):{success:!1,error:_.error}},updateProfile:async x=>{const _=await o.updateProfile(x);return _.success&&_.data?(a(_.data),{success:!0,user:_.data}):{success:!1,error:_.error}},changePassword:async x=>{const _=await o.changePassword(x);return _.success?{success:!0}:{success:!1,error:_.error}},deleteAccount:async()=>{const x=await o.deleteAccount();return x.success?(a(null),{success:!0}):{success:!1,error:x.error}}}};var Cu=function(i,a){return Cu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(r[o]=s[o])},Cu(i,a)};function Bg(i,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");Cu(i,a);function r(){this.constructor=i}i.prototype=a===null?Object.create(a):(r.prototype=a.prototype,new r)}var wl=function(){return wl=Object.assign||function(a){for(var r,s=1,o=arguments.length;s<o;s++){r=arguments[s];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(a[c]=r[c])}return a},wl.apply(this,arguments)};function En(i,a){var r={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&a.indexOf(s)<0&&(r[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)a.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(r[s[o]]=i[s[o]]);return r}function qg(i,a,r,s){var o=arguments.length,c=o<3?a:s===null?s=Object.getOwnPropertyDescriptor(a,r):s,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,a,r,s);else for(var m=i.length-1;m>=0;m--)(h=i[m])&&(c=(o<3?h(c):o>3?h(a,r,c):h(a,r))||c);return o>3&&c&&Object.defineProperty(a,r,c),c}function Pg(i,a){return function(r,s){a(r,s,i)}}function $g(i,a,r,s,o,c){function h(R){if(R!==void 0&&typeof R!="function")throw new TypeError("Function expected");return R}for(var m=s.kind,p=m==="getter"?"get":m==="setter"?"set":"value",g=!a&&i?s.static?i:i.prototype:null,v=a||(g?Object.getOwnPropertyDescriptor(g,s.name):{}),b,x=!1,_=r.length-1;_>=0;_--){var C={};for(var j in s)C[j]=j==="access"?{}:s[j];for(var j in s.access)C.access[j]=s.access[j];C.addInitializer=function(R){if(x)throw new TypeError("Cannot add initializers after decoration has completed");c.push(h(R||null))};var A=(0,r[_])(m==="accessor"?{get:v.get,set:v.set}:v[p],C);if(m==="accessor"){if(A===void 0)continue;if(A===null||typeof A!="object")throw new TypeError("Object expected");(b=h(A.get))&&(v.get=b),(b=h(A.set))&&(v.set=b),(b=h(A.init))&&o.unshift(b)}else(b=h(A))&&(m==="field"?o.unshift(b):v[p]=b)}g&&Object.defineProperty(g,s.name,v),x=!0}function Hg(i,a,r){for(var s=arguments.length>2,o=0;o<a.length;o++)r=s?a[o].call(i,r):a[o].call(i);return s?r:void 0}function Vg(i){return typeof i=="symbol"?i:"".concat(i)}function Fg(i,a,r){return typeof a=="symbol"&&(a=a.description?"[".concat(a.description,"]"):""),Object.defineProperty(i,"name",{configurable:!0,value:r?"".concat(r," ",a):a})}function Gg(i,a){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,a)}function te(i,a,r,s){function o(c){return c instanceof r?c:new r(function(h){h(c)})}return new(r||(r=Promise))(function(c,h){function m(v){try{g(s.next(v))}catch(b){h(b)}}function p(v){try{g(s.throw(v))}catch(b){h(b)}}function g(v){v.done?c(v.value):o(v.value).then(m,p)}g((s=s.apply(i,a||[])).next())})}function Ig(i,a){var r={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,h=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return h.next=m(0),h.throw=m(1),h.return=m(2),typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function m(g){return function(v){return p([g,v])}}function p(g){if(s)throw new TypeError("Generator is already executing.");for(;h&&(h=0,g[0]&&(r=0)),r;)try{if(s=1,o&&(c=g[0]&2?o.return:g[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,g[1])).done)return c;switch(o=0,c&&(g=[g[0]&2,c.value]),g[0]){case 0:case 1:c=g;break;case 4:return r.label++,{value:g[1],done:!1};case 5:r.label++,o=g[1],g=[0];continue;case 7:g=r.ops.pop(),r.trys.pop();continue;default:if(c=r.trys,!(c=c.length>0&&c[c.length-1])&&(g[0]===6||g[0]===2)){r=0;continue}if(g[0]===3&&(!c||g[1]>c[0]&&g[1]<c[3])){r.label=g[1];break}if(g[0]===6&&r.label<c[1]){r.label=c[1],c=g;break}if(c&&r.label<c[2]){r.label=c[2],r.ops.push(g);break}c[2]&&r.ops.pop(),r.trys.pop();continue}g=a.call(i,r)}catch(v){g=[6,v],o=0}finally{s=c=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}}var Ol=Object.create?(function(i,a,r,s){s===void 0&&(s=r);var o=Object.getOwnPropertyDescriptor(a,r);(!o||("get"in o?!a.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return a[r]}}),Object.defineProperty(i,s,o)}):(function(i,a,r,s){s===void 0&&(s=r),i[s]=a[r]});function Yg(i,a){for(var r in i)r!=="default"&&!Object.prototype.hasOwnProperty.call(a,r)&&Ol(a,i,r)}function Sl(i){var a=typeof Symbol=="function"&&Symbol.iterator,r=a&&i[a],s=0;if(r)return r.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")}function Wu(i,a){var r=typeof Symbol=="function"&&i[Symbol.iterator];if(!r)return i;var s=r.call(i),o,c=[],h;try{for(;(a===void 0||a-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(m){h={error:m}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(h)throw h.error}}return c}function Qg(){for(var i=[],a=0;a<arguments.length;a++)i=i.concat(Wu(arguments[a]));return i}function Kg(){for(var i=0,a=0,r=arguments.length;a<r;a++)i+=arguments[a].length;for(var s=Array(i),o=0,a=0;a<r;a++)for(var c=arguments[a],h=0,m=c.length;h<m;h++,o++)s[o]=c[h];return s}function Wg(i,a,r){if(r||arguments.length===2)for(var s=0,o=a.length,c;s<o;s++)(c||!(s in a))&&(c||(c=Array.prototype.slice.call(a,0,s)),c[s]=a[s]);return i.concat(c||Array.prototype.slice.call(a))}function Sn(i){return this instanceof Sn?(this.v=i,this):new Sn(i)}function Jg(i,a,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=r.apply(i,a||[]),o,c=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),m("next"),m("throw"),m("return",h),o[Symbol.asyncIterator]=function(){return this},o;function h(_){return function(C){return Promise.resolve(C).then(_,b)}}function m(_,C){s[_]&&(o[_]=function(j){return new Promise(function(A,R){c.push([_,j,A,R])>1||p(_,j)})},C&&(o[_]=C(o[_])))}function p(_,C){try{g(s[_](C))}catch(j){x(c[0][3],j)}}function g(_){_.value instanceof Sn?Promise.resolve(_.value.v).then(v,b):x(c[0][2],_)}function v(_){p("next",_)}function b(_){p("throw",_)}function x(_,C){_(C),c.shift(),c.length&&p(c[0][0],c[0][1])}}function Xg(i){var a,r;return a={},s("next"),s("throw",function(o){throw o}),s("return"),a[Symbol.iterator]=function(){return this},a;function s(o,c){a[o]=i[o]?function(h){return(r=!r)?{value:Sn(i[o](h)),done:!1}:c?c(h):h}:c}}function Zg(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=i[Symbol.asyncIterator],r;return a?a.call(i):(i=typeof Sl=="function"?Sl(i):i[Symbol.iterator](),r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r);function s(c){r[c]=i[c]&&function(h){return new Promise(function(m,p){h=i[c](h),o(m,p,h.done,h.value)})}}function o(c,h,m,p){Promise.resolve(p).then(function(g){c({value:g,done:m})},h)}}function ey(i,a){return Object.defineProperty?Object.defineProperty(i,"raw",{value:a}):i.raw=a,i}var x_=Object.create?(function(i,a){Object.defineProperty(i,"default",{enumerable:!0,value:a})}):function(i,a){i.default=a},ju=function(i){return ju=Object.getOwnPropertyNames||function(a){var r=[];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(r[r.length]=s);return r},ju(i)};function ty(i){if(i&&i.__esModule)return i;var a={};if(i!=null)for(var r=ju(i),s=0;s<r.length;s++)r[s]!=="default"&&Ol(a,i,r[s]);return x_(a,i),a}function ay(i){return i&&i.__esModule?i:{default:i}}function ry(i,a,r,s){if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?i!==a||!s:!a.has(i))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?s:r==="a"?s.call(i):s?s.value:a.get(i)}function ny(i,a,r,s,o){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof a=="function"?i!==a||!o:!a.has(i))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?o.call(i,r):o?o.value=r:a.set(i,r),r}function sy(i,a){if(a===null||typeof a!="object"&&typeof a!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof i=="function"?a===i:i.has(a)}function iy(i,a,r){if(a!=null){if(typeof a!="object"&&typeof a!="function")throw new TypeError("Object expected.");var s,o;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");s=a[Symbol.asyncDispose]}if(s===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=a[Symbol.dispose],r&&(o=s)}if(typeof s!="function")throw new TypeError("Object not disposable.");o&&(s=function(){try{o.call(this)}catch(c){return Promise.reject(c)}}),i.stack.push({value:a,dispose:s,async:r})}else r&&i.stack.push({async:!0});return a}var __=typeof SuppressedError=="function"?SuppressedError:function(i,a,r){var s=new Error(r);return s.name="SuppressedError",s.error=i,s.suppressed=a,s};function ly(i){function a(c){i.error=i.hasError?new __(c,i.error,"An error was suppressed during disposal."):c,i.hasError=!0}var r,s=0;function o(){for(;r=i.stack.pop();)try{if(!r.async&&s===1)return s=0,i.stack.push(r),Promise.resolve().then(o);if(r.dispose){var c=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(c).then(o,function(h){return a(h),o()})}else s|=1}catch(h){a(h)}if(s===1)return i.hasError?Promise.reject(i.error):Promise.resolve();if(i.hasError)throw i.error}return o()}function oy(i,a){return typeof i=="string"&&/^\.\.?\//.test(i)?i.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,s,o,c,h){return s?a?".jsx":".js":o&&(!c||!h)?r:o+c+"."+h.toLowerCase()+"js"}):i}const w_={__extends:Bg,__assign:wl,__rest:En,__decorate:qg,__param:Pg,__esDecorate:$g,__runInitializers:Hg,__propKey:Vg,__setFunctionName:Fg,__metadata:Gg,__awaiter:te,__generator:Ig,__createBinding:Ol,__exportStar:Yg,__values:Sl,__read:Wu,__spread:Qg,__spreadArrays:Kg,__spreadArray:Wg,__await:Sn,__asyncGenerator:Jg,__asyncDelegator:Xg,__asyncValues:Zg,__makeTemplateObject:ey,__importStar:ty,__importDefault:ay,__classPrivateFieldGet:ry,__classPrivateFieldSet:ny,__classPrivateFieldIn:sy,__addDisposableResource:iy,__disposeResources:ly,__rewriteRelativeImportExtension:oy},S_=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:iy,get __assign(){return wl},__asyncDelegator:Xg,__asyncGenerator:Jg,__asyncValues:Zg,__await:Sn,__awaiter:te,__classPrivateFieldGet:ry,__classPrivateFieldIn:sy,__classPrivateFieldSet:ny,__createBinding:Ol,__decorate:qg,__disposeResources:ly,__esDecorate:$g,__exportStar:Yg,__extends:Bg,__generator:Ig,__importDefault:ay,__importStar:ty,__makeTemplateObject:ey,__metadata:Gg,__param:Pg,__propKey:Vg,__read:Wu,__rest:En,__rewriteRelativeImportExtension:oy,__runInitializers:Hg,__setFunctionName:Fg,__spread:Qg,__spreadArray:Wg,__spreadArrays:Kg,__values:Sl,default:w_},Symbol.toStringTag,{value:"Module"})),C_=i=>i?(...a)=>i(...a):(...a)=>fetch(...a);class Ju extends Error{constructor(a,r="FunctionsError",s){super(a),this.name=r,this.context=s}}class jp extends Ju{constructor(a){super("Failed to send a request to the Edge Function","FunctionsFetchError",a)}}class Ap extends Ju{constructor(a){super("Relay Error invoking the Edge Function","FunctionsRelayError",a)}}class Np extends Ju{constructor(a){super("Edge Function returned a non-2xx status code","FunctionsHttpError",a)}}var Au;(function(i){i.Any="any",i.ApNortheast1="ap-northeast-1",i.ApNortheast2="ap-northeast-2",i.ApSouth1="ap-south-1",i.ApSoutheast1="ap-southeast-1",i.ApSoutheast2="ap-southeast-2",i.CaCentral1="ca-central-1",i.EuCentral1="eu-central-1",i.EuWest1="eu-west-1",i.EuWest2="eu-west-2",i.EuWest3="eu-west-3",i.SaEast1="sa-east-1",i.UsEast1="us-east-1",i.UsWest1="us-west-1",i.UsWest2="us-west-2"})(Au||(Au={}));class j_{constructor(a,{headers:r={},customFetch:s,region:o=Au.Any}={}){this.url=a,this.headers=r,this.region=o,this.fetch=C_(s)}setAuth(a){this.headers.Authorization=`Bearer ${a}`}invoke(a){return te(this,arguments,void 0,function*(r,s={}){var o;try{const{headers:c,method:h,body:m,signal:p}=s;let g={},{region:v}=s;v||(v=this.region);const b=new URL(`${this.url}/${r}`);v&&v!=="any"&&(g["x-region"]=v,b.searchParams.set("forceFunctionRegion",v));let x;m&&(c&&!Object.prototype.hasOwnProperty.call(c,"Content-Type")||!c)?typeof Blob<"u"&&m instanceof Blob||m instanceof ArrayBuffer?(g["Content-Type"]="application/octet-stream",x=m):typeof m=="string"?(g["Content-Type"]="text/plain",x=m):typeof FormData<"u"&&m instanceof FormData?x=m:(g["Content-Type"]="application/json",x=JSON.stringify(m)):x=m;const _=yield this.fetch(b.toString(),{method:h||"POST",headers:Object.assign(Object.assign(Object.assign({},g),this.headers),c),body:x,signal:p}).catch(R=>{throw R.name==="AbortError"?R:new jp(R)}),C=_.headers.get("x-relay-error");if(C&&C==="true")throw new Ap(_);if(!_.ok)throw new Np(_);let j=((o=_.headers.get("Content-Type"))!==null&&o!==void 0?o:"text/plain").split(";")[0].trim(),A;return j==="application/json"?A=yield _.json():j==="application/octet-stream"||j==="application/pdf"?A=yield _.blob():j==="text/event-stream"?A=_:j==="multipart/form-data"?A=yield _.formData():A=yield _.text(),{data:A,error:null,response:_}}catch(c){return c instanceof Error&&c.name==="AbortError"?{data:null,error:new jp(c)}:{data:null,error:c,response:c instanceof Np||c instanceof Ap?c.context:void 0}}})}}var ct={};const Rn=Tb(S_);var ol={},cl={},ul={},dl={},hl={},fl={},Ep;function cy(){if(Ep)return fl;Ep=1,Object.defineProperty(fl,"__esModule",{value:!0});class i extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return fl.default=i,fl}var Rp;function uy(){if(Rp)return hl;Rp=1,Object.defineProperty(hl,"__esModule",{value:!0});const a=Rn.__importDefault(cy());class r{constructor(o){var c,h;this.shouldThrowOnError=!1,this.method=o.method,this.url=o.url,this.headers=new Headers(o.headers),this.schema=o.schema,this.body=o.body,this.shouldThrowOnError=(c=o.shouldThrowOnError)!==null&&c!==void 0?c:!1,this.signal=o.signal,this.isMaybeSingle=(h=o.isMaybeSingle)!==null&&h!==void 0?h:!1,o.fetch?this.fetch=o.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(o,c){return this.headers=new Headers(this.headers),this.headers.set(o,c),this}then(o,c){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const h=this.fetch;let m=h(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async p=>{var g,v,b,x;let _=null,C=null,j=null,A=p.status,R=p.statusText;if(p.ok){if(this.method!=="HEAD"){const I=await p.text();I===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((g=this.headers.get("Accept"))===null||g===void 0)&&g.includes("application/vnd.pgrst.plan+text"))?C=I:C=JSON.parse(I))}const O=(v=this.headers.get("Prefer"))===null||v===void 0?void 0:v.match(/count=(exact|planned|estimated)/),H=(b=p.headers.get("content-range"))===null||b===void 0?void 0:b.split("/");O&&H&&H.length>1&&(j=parseInt(H[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(C)&&(C.length>1?(_={code:"PGRST116",details:`Results contain ${C.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},C=null,j=null,A=406,R="Not Acceptable"):C.length===1?C=C[0]:C=null)}else{const O=await p.text();try{_=JSON.parse(O),Array.isArray(_)&&p.status===404&&(C=[],_=null,A=200,R="OK")}catch{p.status===404&&O===""?(A=204,R="No Content"):_={message:O}}if(_&&this.isMaybeSingle&&(!((x=_?.details)===null||x===void 0)&&x.includes("0 rows"))&&(_=null,A=200,R="OK"),_&&this.shouldThrowOnError)throw new a.default(_)}return{error:_,data:C,count:j,status:A,statusText:R}});return this.shouldThrowOnError||(m=m.catch(p=>{var g,v,b;return{error:{message:`${(g=p?.name)!==null&&g!==void 0?g:"FetchError"}: ${p?.message}`,details:`${(v=p?.stack)!==null&&v!==void 0?v:""}`,hint:"",code:`${(b=p?.code)!==null&&b!==void 0?b:""}`},data:null,count:null,status:0,statusText:""}})),m.then(o,c)}returns(){return this}overrideTypes(){return this}}return hl.default=r,hl}var Tp;function dy(){if(Tp)return dl;Tp=1,Object.defineProperty(dl,"__esModule",{value:!0});const a=Rn.__importDefault(uy());class r extends a.default{select(o){let c=!1;const h=(o??"*").split("").map(m=>/\s/.test(m)&&!c?"":(m==='"'&&(c=!c),m)).join("");return this.url.searchParams.set("select",h),this.headers.append("Prefer","return=representation"),this}order(o,{ascending:c=!0,nullsFirst:h,foreignTable:m,referencedTable:p=m}={}){const g=p?`${p}.order`:"order",v=this.url.searchParams.get(g);return this.url.searchParams.set(g,`${v?`${v},`:""}${o}.${c?"asc":"desc"}${h===void 0?"":h?".nullsfirst":".nullslast"}`),this}limit(o,{foreignTable:c,referencedTable:h=c}={}){const m=typeof h>"u"?"limit":`${h}.limit`;return this.url.searchParams.set(m,`${o}`),this}range(o,c,{foreignTable:h,referencedTable:m=h}={}){const p=typeof m>"u"?"offset":`${m}.offset`,g=typeof m>"u"?"limit":`${m}.limit`;return this.url.searchParams.set(p,`${o}`),this.url.searchParams.set(g,`${c-o+1}`),this}abortSignal(o){return this.signal=o,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:o=!1,verbose:c=!1,settings:h=!1,buffers:m=!1,wal:p=!1,format:g="text"}={}){var v;const b=[o?"analyze":null,c?"verbose":null,h?"settings":null,m?"buffers":null,p?"wal":null].filter(Boolean).join("|"),x=(v=this.headers.get("Accept"))!==null&&v!==void 0?v:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${g}; for="${x}"; options=${b};`),g==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(o){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${o}`),this}}return dl.default=r,dl}var kp;function Xu(){if(kp)return ul;kp=1,Object.defineProperty(ul,"__esModule",{value:!0});const a=Rn.__importDefault(dy()),r=new RegExp("[,()]");class s extends a.default{eq(c,h){return this.url.searchParams.append(c,`eq.${h}`),this}neq(c,h){return this.url.searchParams.append(c,`neq.${h}`),this}gt(c,h){return this.url.searchParams.append(c,`gt.${h}`),this}gte(c,h){return this.url.searchParams.append(c,`gte.${h}`),this}lt(c,h){return this.url.searchParams.append(c,`lt.${h}`),this}lte(c,h){return this.url.searchParams.append(c,`lte.${h}`),this}like(c,h){return this.url.searchParams.append(c,`like.${h}`),this}likeAllOf(c,h){return this.url.searchParams.append(c,`like(all).{${h.join(",")}}`),this}likeAnyOf(c,h){return this.url.searchParams.append(c,`like(any).{${h.join(",")}}`),this}ilike(c,h){return this.url.searchParams.append(c,`ilike.${h}`),this}ilikeAllOf(c,h){return this.url.searchParams.append(c,`ilike(all).{${h.join(",")}}`),this}ilikeAnyOf(c,h){return this.url.searchParams.append(c,`ilike(any).{${h.join(",")}}`),this}is(c,h){return this.url.searchParams.append(c,`is.${h}`),this}in(c,h){const m=Array.from(new Set(h)).map(p=>typeof p=="string"&&r.test(p)?`"${p}"`:`${p}`).join(",");return this.url.searchParams.append(c,`in.(${m})`),this}contains(c,h){return typeof h=="string"?this.url.searchParams.append(c,`cs.${h}`):Array.isArray(h)?this.url.searchParams.append(c,`cs.{${h.join(",")}}`):this.url.searchParams.append(c,`cs.${JSON.stringify(h)}`),this}containedBy(c,h){return typeof h=="string"?this.url.searchParams.append(c,`cd.${h}`):Array.isArray(h)?this.url.searchParams.append(c,`cd.{${h.join(",")}}`):this.url.searchParams.append(c,`cd.${JSON.stringify(h)}`),this}rangeGt(c,h){return this.url.searchParams.append(c,`sr.${h}`),this}rangeGte(c,h){return this.url.searchParams.append(c,`nxl.${h}`),this}rangeLt(c,h){return this.url.searchParams.append(c,`sl.${h}`),this}rangeLte(c,h){return this.url.searchParams.append(c,`nxr.${h}`),this}rangeAdjacent(c,h){return this.url.searchParams.append(c,`adj.${h}`),this}overlaps(c,h){return typeof h=="string"?this.url.searchParams.append(c,`ov.${h}`):this.url.searchParams.append(c,`ov.{${h.join(",")}}`),this}textSearch(c,h,{config:m,type:p}={}){let g="";p==="plain"?g="pl":p==="phrase"?g="ph":p==="websearch"&&(g="w");const v=m===void 0?"":`(${m})`;return this.url.searchParams.append(c,`${g}fts${v}.${h}`),this}match(c){return Object.entries(c).forEach(([h,m])=>{this.url.searchParams.append(h,`eq.${m}`)}),this}not(c,h,m){return this.url.searchParams.append(c,`not.${h}.${m}`),this}or(c,{foreignTable:h,referencedTable:m=h}={}){const p=m?`${m}.or`:"or";return this.url.searchParams.append(p,`(${c})`),this}filter(c,h,m){return this.url.searchParams.append(c,`${h}.${m}`),this}}return ul.default=s,ul}var Op;function hy(){if(Op)return cl;Op=1,Object.defineProperty(cl,"__esModule",{value:!0});const a=Rn.__importDefault(Xu());class r{constructor(o,{headers:c={},schema:h,fetch:m}){this.url=o,this.headers=new Headers(c),this.schema=h,this.fetch=m}select(o,c){const{head:h=!1,count:m}=c??{},p=h?"HEAD":"GET";let g=!1;const v=(o??"*").split("").map(b=>/\s/.test(b)&&!g?"":(b==='"'&&(g=!g),b)).join("");return this.url.searchParams.set("select",v),m&&this.headers.append("Prefer",`count=${m}`),new a.default({method:p,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(o,{count:c,defaultToNull:h=!0}={}){var m;const p="POST";if(c&&this.headers.append("Prefer",`count=${c}`),h||this.headers.append("Prefer","missing=default"),Array.isArray(o)){const g=o.reduce((v,b)=>v.concat(Object.keys(b)),[]);if(g.length>0){const v=[...new Set(g)].map(b=>`"${b}"`);this.url.searchParams.set("columns",v.join(","))}}return new a.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}upsert(o,{onConflict:c,ignoreDuplicates:h=!1,count:m,defaultToNull:p=!0}={}){var g;const v="POST";if(this.headers.append("Prefer",`resolution=${h?"ignore":"merge"}-duplicates`),c!==void 0&&this.url.searchParams.set("on_conflict",c),m&&this.headers.append("Prefer",`count=${m}`),p||this.headers.append("Prefer","missing=default"),Array.isArray(o)){const b=o.reduce((x,_)=>x.concat(Object.keys(_)),[]);if(b.length>0){const x=[...new Set(b)].map(_=>`"${_}"`);this.url.searchParams.set("columns",x.join(","))}}return new a.default({method:v,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}update(o,{count:c}={}){var h;const m="PATCH";return c&&this.headers.append("Prefer",`count=${c}`),new a.default({method:m,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}delete({count:o}={}){var c;const h="DELETE";return o&&this.headers.append("Prefer",`count=${o}`),new a.default({method:h,url:this.url,headers:this.headers,schema:this.schema,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}}return cl.default=r,cl}var Dp;function A_(){if(Dp)return ol;Dp=1,Object.defineProperty(ol,"__esModule",{value:!0});const i=Rn,a=i.__importDefault(hy()),r=i.__importDefault(Xu());class s{constructor(c,{headers:h={},schema:m,fetch:p}={}){this.url=c,this.headers=new Headers(h),this.schemaName=m,this.fetch=p}from(c){const h=new URL(`${this.url}/${c}`);return new a.default(h,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(c){return new s(this.url,{headers:this.headers,schema:c,fetch:this.fetch})}rpc(c,h={},{head:m=!1,get:p=!1,count:g}={}){var v;let b;const x=new URL(`${this.url}/rpc/${c}`);let _;m||p?(b=m?"HEAD":"GET",Object.entries(h).filter(([j,A])=>A!==void 0).map(([j,A])=>[j,Array.isArray(A)?`{${A.join(",")}}`:`${A}`]).forEach(([j,A])=>{x.searchParams.append(j,A)})):(b="POST",_=h);const C=new Headers(this.headers);return g&&C.set("Prefer",`count=${g}`),new r.default({method:b,url:x,headers:C,schema:this.schemaName,body:_,fetch:(v=this.fetch)!==null&&v!==void 0?v:fetch})}}return ol.default=s,ol}var Mp;function N_(){if(Mp)return ct;Mp=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.PostgrestError=ct.PostgrestBuilder=ct.PostgrestTransformBuilder=ct.PostgrestFilterBuilder=ct.PostgrestQueryBuilder=ct.PostgrestClient=void 0;const i=Rn,a=i.__importDefault(A_());ct.PostgrestClient=a.default;const r=i.__importDefault(hy());ct.PostgrestQueryBuilder=r.default;const s=i.__importDefault(Xu());ct.PostgrestFilterBuilder=s.default;const o=i.__importDefault(dy());ct.PostgrestTransformBuilder=o.default;const c=i.__importDefault(uy());ct.PostgrestBuilder=c.default;const h=i.__importDefault(cy());return ct.PostgrestError=h.default,ct.default={PostgrestClient:a.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:c.default,PostgrestError:h.default},ct}var fy=N_();const my=xg(fy),E_=Db({__proto__:null,default:my},[fy]),{PostgrestClient:R_,PostgrestQueryBuilder:pj,PostgrestFilterBuilder:gj,PostgrestTransformBuilder:yj,PostgrestBuilder:vj,PostgrestError:bj}=my||E_;class T_{static detectEnvironment(){var a;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((a=navigator.userAgent)===null||a===void 0)&&a.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const s=r.node,o=parseInt(s.replace(/^v/,"").split(".")[0]);return o>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${o} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${o} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const a=this.detectEnvironment();if(a.constructor)return a.constructor;let r=a.error||"WebSocket not supported in this environment.";throw a.workaround&&(r+=`

Suggested solution: ${a.workaround}`),new Error(r)}static createWebSocket(a,r){const s=this.getWebSocketConstructor();return new s(a,r)}static isWebSocketSupported(){try{const a=this.detectEnvironment();return a.type==="native"||a.type==="ws"}catch{return!1}}}const k_="2.80.0",O_=`realtime-js/${k_}`,D_="1.0.0",Nu=1e4,M_=1e3,U_=100;var Ts;(function(i){i[i.connecting=0]="connecting",i[i.open=1]="open",i[i.closing=2]="closing",i[i.closed=3]="closed"})(Ts||(Ts={}));var Ze;(function(i){i.closed="closed",i.errored="errored",i.joined="joined",i.joining="joining",i.leaving="leaving"})(Ze||(Ze={}));var Yt;(function(i){i.close="phx_close",i.error="phx_error",i.join="phx_join",i.reply="phx_reply",i.leave="phx_leave",i.access_token="access_token"})(Yt||(Yt={}));var Eu;(function(i){i.websocket="websocket"})(Eu||(Eu={}));var wr;(function(i){i.Connecting="connecting",i.Open="open",i.Closing="closing",i.Closed="closed"})(wr||(wr={}));class z_{constructor(){this.HEADER_LENGTH=1}decode(a,r){return a.constructor===ArrayBuffer?r(this._binaryDecode(a)):r(typeof a=="string"?JSON.parse(a):{})}_binaryDecode(a){const r=new DataView(a),s=new TextDecoder;return this._decodeBroadcast(a,r,s)}_decodeBroadcast(a,r,s){const o=r.getUint8(1),c=r.getUint8(2);let h=this.HEADER_LENGTH+2;const m=s.decode(a.slice(h,h+o));h=h+o;const p=s.decode(a.slice(h,h+c));h=h+c;const g=JSON.parse(s.decode(a.slice(h,a.byteLength)));return{ref:null,topic:m,event:p,payload:g}}}class py{constructor(a,r){this.callback=a,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=a,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ue;(function(i){i.abstime="abstime",i.bool="bool",i.date="date",i.daterange="daterange",i.float4="float4",i.float8="float8",i.int2="int2",i.int4="int4",i.int4range="int4range",i.int8="int8",i.int8range="int8range",i.json="json",i.jsonb="jsonb",i.money="money",i.numeric="numeric",i.oid="oid",i.reltime="reltime",i.text="text",i.time="time",i.timestamp="timestamp",i.timestamptz="timestamptz",i.timetz="timetz",i.tsrange="tsrange",i.tstzrange="tstzrange"})(Ue||(Ue={}));const Up=(i,a,r={})=>{var s;const o=(s=r.skipTypes)!==null&&s!==void 0?s:[];return a?Object.keys(a).reduce((c,h)=>(c[h]=L_(h,i,a,o),c),{}):{}},L_=(i,a,r,s)=>{const o=a.find(m=>m.name===i),c=o?.type,h=r[i];return c&&!s.includes(c)?gy(c,h):Ru(h)},gy=(i,a)=>{if(i.charAt(0)==="_"){const r=i.slice(1,i.length);return $_(a,r)}switch(i){case Ue.bool:return B_(a);case Ue.float4:case Ue.float8:case Ue.int2:case Ue.int4:case Ue.int8:case Ue.numeric:case Ue.oid:return q_(a);case Ue.json:case Ue.jsonb:return P_(a);case Ue.timestamp:return H_(a);case Ue.abstime:case Ue.date:case Ue.daterange:case Ue.int4range:case Ue.int8range:case Ue.money:case Ue.reltime:case Ue.text:case Ue.time:case Ue.timestamptz:case Ue.timetz:case Ue.tsrange:case Ue.tstzrange:return Ru(a);default:return Ru(a)}},Ru=i=>i,B_=i=>{switch(i){case"t":return!0;case"f":return!1;default:return i}},q_=i=>{if(typeof i=="string"){const a=parseFloat(i);if(!Number.isNaN(a))return a}return i},P_=i=>{if(typeof i=="string")try{return JSON.parse(i)}catch(a){return console.log(`JSON parse error: ${a}`),i}return i},$_=(i,a)=>{if(typeof i!="string")return i;const r=i.length-1,s=i[r];if(i[0]==="{"&&s==="}"){let c;const h=i.slice(1,r);try{c=JSON.parse("["+h+"]")}catch{c=h?h.split(","):[]}return c.map(m=>gy(a,m))}return i},H_=i=>typeof i=="string"?i.replace(" ","T"):i,yy=i=>{const a=new URL(i);return a.protocol=a.protocol.replace(/^ws/i,"http"),a.pathname=a.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),a.pathname===""||a.pathname==="/"?a.pathname="/api/broadcast":a.pathname=a.pathname+"/api/broadcast",a.href};class iu{constructor(a,r,s={},o=Nu){this.channel=a,this.event=r,this.payload=s,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(a){this.timeout=a,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(a){this.payload=Object.assign(Object.assign({},this.payload),a)}receive(a,r){var s;return this._hasReceived(a)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:a,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const a=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},a),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(a,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:a,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:a,response:r}){this.recHooks.filter(s=>s.status===a).forEach(s=>s.callback(r))}_hasReceived(a){return this.receivedResp&&this.receivedResp.status===a}}var zp;(function(i){i.SYNC="sync",i.JOIN="join",i.LEAVE="leave"})(zp||(zp={}));class ks{constructor(a,r){this.channel=a,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},o=>{const{onJoin:c,onLeave:h,onSync:m}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ks.syncState(this.state,o,c,h),this.pendingDiffs.forEach(p=>{this.state=ks.syncDiff(this.state,p,c,h)}),this.pendingDiffs=[],m()}),this.channel._on(s.diff,{},o=>{const{onJoin:c,onLeave:h,onSync:m}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=ks.syncDiff(this.state,o,c,h),m())}),this.onJoin((o,c,h)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:c,newPresences:h})}),this.onLeave((o,c,h)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:c,leftPresences:h})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(a,r,s,o){const c=this.cloneDeep(a),h=this.transformState(r),m={},p={};return this.map(c,(g,v)=>{h[g]||(p[g]=v)}),this.map(h,(g,v)=>{const b=c[g];if(b){const x=v.map(A=>A.presence_ref),_=b.map(A=>A.presence_ref),C=v.filter(A=>_.indexOf(A.presence_ref)<0),j=b.filter(A=>x.indexOf(A.presence_ref)<0);C.length>0&&(m[g]=C),j.length>0&&(p[g]=j)}else m[g]=v}),this.syncDiff(c,{joins:m,leaves:p},s,o)}static syncDiff(a,r,s,o){const{joins:c,leaves:h}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),o||(o=()=>{}),this.map(c,(m,p)=>{var g;const v=(g=a[m])!==null&&g!==void 0?g:[];if(a[m]=this.cloneDeep(p),v.length>0){const b=a[m].map(_=>_.presence_ref),x=v.filter(_=>b.indexOf(_.presence_ref)<0);a[m].unshift(...x)}s(m,v,p)}),this.map(h,(m,p)=>{let g=a[m];if(!g)return;const v=p.map(b=>b.presence_ref);g=g.filter(b=>v.indexOf(b.presence_ref)<0),a[m]=g,o(m,g,p),g.length===0&&delete a[m]}),a}static map(a,r){return Object.getOwnPropertyNames(a).map(s=>r(s,a[s]))}static transformState(a){return a=this.cloneDeep(a),Object.getOwnPropertyNames(a).reduce((r,s)=>{const o=a[s];return"metas"in o?r[s]=o.metas.map(c=>(c.presence_ref=c.phx_ref,delete c.phx_ref,delete c.phx_ref_prev,c)):r[s]=o,r},{})}static cloneDeep(a){return JSON.parse(JSON.stringify(a))}onJoin(a){this.caller.onJoin=a}onLeave(a){this.caller.onLeave=a}onSync(a){this.caller.onSync=a}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Lp;(function(i){i.ALL="*",i.INSERT="INSERT",i.UPDATE="UPDATE",i.DELETE="DELETE"})(Lp||(Lp={}));var Os;(function(i){i.BROADCAST="broadcast",i.PRESENCE="presence",i.POSTGRES_CHANGES="postgres_changes",i.SYSTEM="system"})(Os||(Os={}));var Sa;(function(i){i.SUBSCRIBED="SUBSCRIBED",i.TIMED_OUT="TIMED_OUT",i.CLOSED="CLOSED",i.CHANNEL_ERROR="CHANNEL_ERROR"})(Sa||(Sa={}));class Zu{constructor(a,r={config:{}},s){var o,c;if(this.topic=a,this.params=r,this.socket=s,this.bindings={},this.state=Ze.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=a.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new iu(this,Yt.join,this.params,this.timeout),this.rejoinTimer=new py(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ze.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(h=>h.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ze.closed,this.socket._remove(this)}),this._onError(h=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,h),this.state=Ze.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ze.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",h=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,h),this.state=Ze.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Yt.reply,{},(h,m)=>{this._trigger(this._replyEventName(m),h)}),this.presence=new ks(this),this.broadcastEndpointURL=yy(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((c=(o=this.params.config)===null||o===void 0?void 0:o.broadcast)===null||c===void 0)&&c.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(a,r=this.timeout){var s,o,c;if(this.socket.isConnected()||this.socket.connect(),this.state==Ze.closed){const{config:{broadcast:h,presence:m,private:p}}=this.params,g=(o=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(_=>_.filter))!==null&&o!==void 0?o:[],v=!!this.bindings[Os.PRESENCE]&&this.bindings[Os.PRESENCE].length>0||((c=this.params.config.presence)===null||c===void 0?void 0:c.enabled)===!0,b={},x={broadcast:h,presence:Object.assign(Object.assign({},m),{enabled:v}),postgres_changes:g,private:p};this.socket.accessTokenValue&&(b.access_token=this.socket.accessTokenValue),this._onError(_=>a?.(Sa.CHANNEL_ERROR,_)),this._onClose(()=>a?.(Sa.CLOSED)),this.updateJoinPayload(Object.assign({config:x},b)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:_})=>{var C;if(this.socket.setAuth(),_===void 0){a?.(Sa.SUBSCRIBED);return}else{const j=this.bindings.postgres_changes,A=(C=j?.length)!==null&&C!==void 0?C:0,R=[];for(let k=0;k<A;k++){const O=j[k],{filter:{event:H,schema:I,table:V,filter:re}}=O,G=_&&_[k];if(G&&G.event===H&&G.schema===I&&G.table===V&&G.filter===re)R.push(Object.assign(Object.assign({},O),{id:G.id}));else{this.unsubscribe(),this.state=Ze.errored,a?.(Sa.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=R,a&&a(Sa.SUBSCRIBED);return}}).receive("error",_=>{this.state=Ze.errored,a?.(Sa.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(_).join(", ")||"error")))}).receive("timeout",()=>{a?.(Sa.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(a,r={}){return await this.send({type:"presence",event:"track",payload:a},r.timeout||this.timeout)}async untrack(a={}){return await this.send({type:"presence",event:"untrack"},a)}on(a,r,s){return this.state===Ze.joined&&a===Os.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(a,r,s)}async httpSend(a,r,s={}){var o;const c=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const h={method:"POST",headers:{Authorization:c,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:r,private:this.private}]})},m=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(o=s.timeout)!==null&&o!==void 0?o:this.timeout);if(m.status===202)return{success:!0};let p=m.statusText;try{const g=await m.json();p=g.error||g.message||p}catch{}return Promise.reject(new Error(p))}async send(a,r={}){var s,o;if(!this._canPush()&&a.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:c,payload:h}=a,p={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:c,payload:h,private:this.private}]})};try{const g=await this._fetchWithTimeout(this.broadcastEndpointURL,p,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((o=g.body)===null||o===void 0?void 0:o.cancel()),g.ok?"ok":"error"}catch(g){return g.name==="AbortError"?"timed out":"error"}}else return new Promise(c=>{var h,m,p;const g=this._push(a.type,a,r.timeout||this.timeout);a.type==="broadcast"&&!(!((p=(m=(h=this.params)===null||h===void 0?void 0:h.config)===null||m===void 0?void 0:m.broadcast)===null||p===void 0)&&p.ack)&&c("ok"),g.receive("ok",()=>c("ok")),g.receive("error",()=>c("error")),g.receive("timeout",()=>c("timed out"))})}updateJoinPayload(a){this.joinPush.updatePayload(a)}unsubscribe(a=this.timeout){this.state=Ze.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Yt.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(o=>{s=new iu(this,Yt.leave,{},a),s.receive("ok",()=>{r(),o("ok")}).receive("timeout",()=>{r(),o("timed out")}).receive("error",()=>{o("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s?.destroy()})}teardown(){this.pushBuffer.forEach(a=>a.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Ze.closed,this.bindings={}}async _fetchWithTimeout(a,r,s){const o=new AbortController,c=setTimeout(()=>o.abort(),s),h=await this.socket.fetch(a,Object.assign(Object.assign({},r),{signal:o.signal}));return clearTimeout(c),h}_push(a,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${a}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new iu(this,a,r,s);return this._canPush()?o.send():this._addToPushBuffer(o),o}_addToPushBuffer(a){if(a.startTimeout(),this.pushBuffer.push(a),this.pushBuffer.length>U_){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(a,r,s){return r}_isMember(a){return this.topic===a}_joinRef(){return this.joinPush.ref}_trigger(a,r,s){var o,c;const h=a.toLocaleLowerCase(),{close:m,error:p,leave:g,join:v}=Yt;if(s&&[m,p,g,v].indexOf(h)>=0&&s!==this._joinRef())return;let x=this._onMessage(h,r,s);if(r&&!x)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(h)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(_=>{var C,j,A;return((C=_.filter)===null||C===void 0?void 0:C.event)==="*"||((A=(j=_.filter)===null||j===void 0?void 0:j.event)===null||A===void 0?void 0:A.toLocaleLowerCase())===h}).map(_=>_.callback(x,s)):(c=this.bindings[h])===null||c===void 0||c.filter(_=>{var C,j,A,R,k,O;if(["broadcast","presence","postgres_changes"].includes(h))if("id"in _){const H=_.id,I=(C=_.filter)===null||C===void 0?void 0:C.event;return H&&((j=r.ids)===null||j===void 0?void 0:j.includes(H))&&(I==="*"||I?.toLocaleLowerCase()===((A=r.data)===null||A===void 0?void 0:A.type.toLocaleLowerCase()))}else{const H=(k=(R=_?.filter)===null||R===void 0?void 0:R.event)===null||k===void 0?void 0:k.toLocaleLowerCase();return H==="*"||H===((O=r?.event)===null||O===void 0?void 0:O.toLocaleLowerCase())}else return _.type.toLocaleLowerCase()===h}).map(_=>{if(typeof x=="object"&&"ids"in x){const C=x.data,{schema:j,table:A,commit_timestamp:R,type:k,errors:O}=C;x=Object.assign(Object.assign({},{schema:j,table:A,commit_timestamp:R,eventType:k,new:{},old:{},errors:O}),this._getPayloadRecords(C))}_.callback(x,s)})}_isClosed(){return this.state===Ze.closed}_isJoined(){return this.state===Ze.joined}_isJoining(){return this.state===Ze.joining}_isLeaving(){return this.state===Ze.leaving}_replyEventName(a){return`chan_reply_${a}`}_on(a,r,s){const o=a.toLocaleLowerCase(),c={type:o,filter:r,callback:s};return this.bindings[o]?this.bindings[o].push(c):this.bindings[o]=[c],this}_off(a,r){const s=a.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(o=>{var c;return!(((c=o.type)===null||c===void 0?void 0:c.toLocaleLowerCase())===s&&Zu.isEqual(o.filter,r))})),this}static isEqual(a,r){if(Object.keys(a).length!==Object.keys(r).length)return!1;for(const s in a)if(a[s]!==r[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(a){this._on(Yt.close,{},a)}_onError(a){this._on(Yt.error,{},r=>a(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(a=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ze.joining,this.joinPush.resend(a))}_getPayloadRecords(a){const r={new:{},old:{}};return(a.type==="INSERT"||a.type==="UPDATE")&&(r.new=Up(a.columns,a.record)),(a.type==="UPDATE"||a.type==="DELETE")&&(r.old=Up(a.columns,a.old_record)),r}}const lu=()=>{},ml={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},V_=[1e3,2e3,5e3,1e4],F_=1e4,G_=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class I_{constructor(a,r){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Nu,this.transport=null,this.heartbeatIntervalMs=ml.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=lu,this.ref=0,this.reconnectTimer=null,this.logger=lu,this.conn=null,this.sendBuffer=[],this.serializer=new z_,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=o=>o?(...c)=>o(...c):(...c)=>fetch(...c),!(!((s=r?.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${a}/${Eu.websocket}`,this.httpEndpoint=yy(a),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=T_.createWebSocket(this.endpointURL())}catch(a){this._setConnectionState("disconnected");const r=a.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:D_}))}disconnect(a,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},a?this.conn.close(a,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(a){const r=await a.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const a=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),a}log(a,r,s){this.logger(a,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Ts.connecting:return wr.Connecting;case Ts.open:return wr.Open;case Ts.closing:return wr.Closing;default:return wr.Closed}}isConnected(){return this.connectionState()===wr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(a,r={config:{}}){const s=`realtime:${a}`,o=this.getChannels().find(c=>c.topic===s);if(o)return o;{const c=new Zu(`realtime:${a}`,r,this);return this.channels.push(c),c}}push(a){const{topic:r,event:s,payload:o,ref:c}=a,h=()=>{this.encode(a,m=>{var p;(p=this.conn)===null||p===void 0||p.send(m)})};this.log("push",`${r} ${s} (${c})`,o),this.isConnected()?h():this.sendBuffer.push(h)}async setAuth(a=null){this._authPromise=this._performAuth(a);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var a;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(a=this.conn)===null||a===void 0||a.close(M_,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},ml.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(a){this.heartbeatCallback=a}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(a=>a()),this.sendBuffer=[])}_makeRef(){let a=this.ref+1;return a===this.ref?this.ref=0:this.ref=a,this.ref.toString()}_leaveOpenTopic(a){let r=this.channels.find(s=>s.topic===a&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${a}"`),r.unsubscribe())}_remove(a){this.channels=this.channels.filter(r=>r.topic!==a.topic)}_onConnMessage(a){this.decode(a.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(g){this.log("error","error in heartbeat callback",g)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:o,payload:c,ref:h}=r,m=h?`(${h})`:"",p=c.status||"";this.log("receive",`${p} ${s} ${o} ${m}`.trim(),c),this.channels.filter(g=>g._isMember(s)).forEach(g=>g._trigger(o,c,h)),this._triggerStateCallbacks("message",r)})}_clearTimer(a){var r;a==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):a==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=a=>this._onConnError(a),this.conn.onmessage=a=>this._onConnMessage(a),this.conn.onclose=a=>this._onConnClose(a))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(a=>a.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const a=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(a),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(a){var r;this._setConnectionState("disconnected"),this.log("transport","close",a),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",a)}_onConnError(a){this._setConnectionState("disconnected"),this.log("transport",`${a}`),this._triggerChanError(),this._triggerStateCallbacks("error",a)}_triggerChanError(){this.channels.forEach(a=>a._trigger(Yt.error))}_appendParams(a,r){if(Object.keys(r).length===0)return a;const s=a.match(/\?/)?"&":"?",o=new URLSearchParams(r);return`${a}${s}${o}`}_workerObjectUrl(a){let r;if(a)r=a;else{const s=new Blob([G_],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}_setConnectionState(a,r=!1){this._connectionState=a,a==="connecting"?this._wasManualDisconnect=!1:a==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(a=null){let r;a?r=a:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const o={access_token:r,version:O_};r&&s.updateJoinPayload(o),s.joinedOnce&&s._isJoined()&&s._push(Yt.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(a="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${a}`,r)})}_triggerStateCallbacks(a,r){try{this.stateChangeCallbacks[a].forEach(s=>{try{s(r)}catch(o){this.log("error",`error in ${a} callback`,o)}})}catch(s){this.log("error",`error triggering ${a} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new py(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},ml.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(a){var r,s,o,c,h,m,p,g,v;if(this.transport=(r=a?.transport)!==null&&r!==void 0?r:null,this.timeout=(s=a?.timeout)!==null&&s!==void 0?s:Nu,this.heartbeatIntervalMs=(o=a?.heartbeatIntervalMs)!==null&&o!==void 0?o:ml.HEARTBEAT_INTERVAL,this.worker=(c=a?.worker)!==null&&c!==void 0?c:!1,this.accessToken=(h=a?.accessToken)!==null&&h!==void 0?h:null,this.heartbeatCallback=(m=a?.heartbeatCallback)!==null&&m!==void 0?m:lu,a?.params&&(this.params=a.params),a?.logger&&(this.logger=a.logger),(a?.logLevel||a?.log_level)&&(this.logLevel=a.logLevel||a.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(p=a?.reconnectAfterMs)!==null&&p!==void 0?p:(b=>V_[b-1]||F_),this.encode=(g=a?.encode)!==null&&g!==void 0?g:((b,x)=>x(JSON.stringify(b))),this.decode=(v=a?.decode)!==null&&v!==void 0?v:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=a?.workerUrl}}}class ed extends Error{constructor(a){super(a),this.__isStorageError=!0,this.name="StorageError"}}function $e(i){return typeof i=="object"&&i!==null&&"__isStorageError"in i}class Y_ extends ed{constructor(a,r,s){super(a),this.name="StorageApiError",this.status=r,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Tu extends ed{constructor(a,r){super(a),this.name="StorageUnknownError",this.originalError=r}}const td=i=>i?(...a)=>i(...a):(...a)=>fetch(...a),Q_=()=>Response,ku=i=>{if(Array.isArray(i))return i.map(r=>ku(r));if(typeof i=="function"||i!==Object(i))return i;const a={};return Object.entries(i).forEach(([r,s])=>{const o=r.replace(/([-_][a-z])/gi,c=>c.toUpperCase().replace(/[-_]/g,""));a[o]=ku(s)}),a},K_=i=>{if(typeof i!="object"||i===null)return!1;const a=Object.getPrototypeOf(i);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(Symbol.toStringTag in i)&&!(Symbol.iterator in i)},ou=i=>{var a;return i.msg||i.message||i.error_description||(typeof i.error=="string"?i.error:(a=i.error)===null||a===void 0?void 0:a.message)||JSON.stringify(i)},W_=(i,a,r)=>te(void 0,void 0,void 0,function*(){const s=yield Q_();i instanceof s&&!r?.noResolveJson?i.json().then(o=>{const c=i.status||500,h=o?.statusCode||c+"";a(new Y_(ou(o),c,h))}).catch(o=>{a(new Tu(ou(o),o))}):a(new Tu(ou(i),i))}),J_=(i,a,r,s)=>{const o={method:i,headers:a?.headers||{}};return i==="GET"||!s?o:(K_(s)?(o.headers=Object.assign({"Content-Type":"application/json"},a?.headers),o.body=JSON.stringify(s)):o.body=s,a?.duplex&&(o.duplex=a.duplex),Object.assign(Object.assign({},o),r))};function Hs(i,a,r,s,o,c){return te(this,void 0,void 0,function*(){return new Promise((h,m)=>{i(r,J_(a,s,o,c)).then(p=>{if(!p.ok)throw p;return s?.noResolveJson?p:p.json()}).then(p=>h(p)).catch(p=>W_(p,m,s))})})}function Ms(i,a,r,s){return te(this,void 0,void 0,function*(){return Hs(i,"GET",a,r,s)})}function It(i,a,r,s,o){return te(this,void 0,void 0,function*(){return Hs(i,"POST",a,s,o,r)})}function Ou(i,a,r,s,o){return te(this,void 0,void 0,function*(){return Hs(i,"PUT",a,s,o,r)})}function X_(i,a,r,s){return te(this,void 0,void 0,function*(){return Hs(i,"HEAD",a,Object.assign(Object.assign({},r),{noResolveJson:!0}),s)})}function ad(i,a,r,s,o){return te(this,void 0,void 0,function*(){return Hs(i,"DELETE",a,s,o,r)})}class Z_{constructor(a,r){this.downloadFn=a,this.shouldThrowOnError=r}then(a,r){return this.execute().then(a,r)}execute(){return te(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if($e(a))return{data:null,error:a};throw a}})}}var vy;class ew{constructor(a,r){this.downloadFn=a,this.shouldThrowOnError=r,this[vy]="BlobDownloadBuilder",this.promise=null}asStream(){return new Z_(this.downloadFn,this.shouldThrowOnError)}then(a,r){return this.getPromise().then(a,r)}catch(a){return this.getPromise().catch(a)}finally(a){return this.getPromise().finally(a)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return te(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if($e(a))return{data:null,error:a};throw a}})}}vy=Symbol.toStringTag;const tw={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Bp={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class aw{constructor(a,r={},s,o){this.shouldThrowOnError=!1,this.url=a,this.headers=r,this.bucketId=s,this.fetch=td(o)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(a,r,s,o){return te(this,void 0,void 0,function*(){try{let c;const h=Object.assign(Object.assign({},Bp),o);let m=Object.assign(Object.assign({},this.headers),a==="POST"&&{"x-upsert":String(h.upsert)});const p=h.metadata;typeof Blob<"u"&&s instanceof Blob?(c=new FormData,c.append("cacheControl",h.cacheControl),p&&c.append("metadata",this.encodeMetadata(p)),c.append("",s)):typeof FormData<"u"&&s instanceof FormData?(c=s,c.has("cacheControl")||c.append("cacheControl",h.cacheControl),p&&!c.has("metadata")&&c.append("metadata",this.encodeMetadata(p))):(c=s,m["cache-control"]=`max-age=${h.cacheControl}`,m["content-type"]=h.contentType,p&&(m["x-metadata"]=this.toBase64(this.encodeMetadata(p))),(typeof ReadableStream<"u"&&c instanceof ReadableStream||c&&typeof c=="object"&&"pipe"in c&&typeof c.pipe=="function")&&!h.duplex&&(h.duplex="half")),o?.headers&&(m=Object.assign(Object.assign({},m),o.headers));const g=this._removeEmptyFolders(r),v=this._getFinalPath(g),b=yield(a=="PUT"?Ou:It)(this.fetch,`${this.url}/object/${v}`,c,Object.assign({headers:m},h?.duplex?{duplex:h.duplex}:{}));return{data:{path:g,id:b.Id,fullPath:b.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if($e(c))return{data:null,error:c};throw c}})}upload(a,r,s){return te(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",a,r,s)})}uploadToSignedUrl(a,r,s,o){return te(this,void 0,void 0,function*(){const c=this._removeEmptyFolders(a),h=this._getFinalPath(c),m=new URL(this.url+`/object/upload/sign/${h}`);m.searchParams.set("token",r);try{let p;const g=Object.assign({upsert:Bp.upsert},o),v=Object.assign(Object.assign({},this.headers),{"x-upsert":String(g.upsert)});typeof Blob<"u"&&s instanceof Blob?(p=new FormData,p.append("cacheControl",g.cacheControl),p.append("",s)):typeof FormData<"u"&&s instanceof FormData?(p=s,p.append("cacheControl",g.cacheControl)):(p=s,v["cache-control"]=`max-age=${g.cacheControl}`,v["content-type"]=g.contentType);const b=yield Ou(this.fetch,m.toString(),p,{headers:v});return{data:{path:c,fullPath:b.Key},error:null}}catch(p){if(this.shouldThrowOnError)throw p;if($e(p))return{data:null,error:p};throw p}})}createSignedUploadUrl(a,r){return te(this,void 0,void 0,function*(){try{let s=this._getFinalPath(a);const o=Object.assign({},this.headers);r?.upsert&&(o["x-upsert"]="true");const c=yield It(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:o}),h=new URL(this.url+c.url),m=h.searchParams.get("token");if(!m)throw new ed("No token returned by API");return{data:{signedUrl:h.toString(),path:a,token:m},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if($e(s))return{data:null,error:s};throw s}})}update(a,r,s){return te(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",a,r,s)})}move(a,r,s){return te(this,void 0,void 0,function*(){try{return{data:yield It(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:a,destinationKey:r,destinationBucket:s?.destinationBucket},{headers:this.headers}),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if($e(o))return{data:null,error:o};throw o}})}copy(a,r,s){return te(this,void 0,void 0,function*(){try{return{data:{path:(yield It(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:a,destinationKey:r,destinationBucket:s?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if($e(o))return{data:null,error:o};throw o}})}createSignedUrl(a,r,s){return te(this,void 0,void 0,function*(){try{let o=this._getFinalPath(a),c=yield It(this.fetch,`${this.url}/object/sign/${o}`,Object.assign({expiresIn:r},s?.transform?{transform:s.transform}:{}),{headers:this.headers});const h=s?.download?`&download=${s.download===!0?"":s.download}`:"";return c={signedUrl:encodeURI(`${this.url}${c.signedURL}${h}`)},{data:c,error:null}}catch(o){if(this.shouldThrowOnError)throw o;if($e(o))return{data:null,error:o};throw o}})}createSignedUrls(a,r,s){return te(this,void 0,void 0,function*(){try{const o=yield It(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:a},{headers:this.headers}),c=s?.download?`&download=${s.download===!0?"":s.download}`:"";return{data:o.map(h=>Object.assign(Object.assign({},h),{signedUrl:h.signedURL?encodeURI(`${this.url}${h.signedURL}${c}`):null})),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if($e(o))return{data:null,error:o};throw o}})}download(a,r){const o=typeof r?.transform<"u"?"render/image/authenticated":"object",c=this.transformOptsToQueryString(r?.transform||{}),h=c?`?${c}`:"",m=this._getFinalPath(a),p=()=>Ms(this.fetch,`${this.url}/${o}/${m}${h}`,{headers:this.headers,noResolveJson:!0});return new ew(p,this.shouldThrowOnError)}info(a){return te(this,void 0,void 0,function*(){const r=this._getFinalPath(a);try{const s=yield Ms(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:ku(s),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if($e(s))return{data:null,error:s};throw s}})}exists(a){return te(this,void 0,void 0,function*(){const r=this._getFinalPath(a);try{return yield X_(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if($e(s)&&s instanceof Tu){const o=s.originalError;if([400,404].includes(o?.status))return{data:!1,error:s}}throw s}})}getPublicUrl(a,r){const s=this._getFinalPath(a),o=[],c=r?.download?`download=${r.download===!0?"":r.download}`:"";c!==""&&o.push(c);const m=typeof r?.transform<"u"?"render/image":"object",p=this.transformOptsToQueryString(r?.transform||{});p!==""&&o.push(p);let g=o.join("&");return g!==""&&(g=`?${g}`),{data:{publicUrl:encodeURI(`${this.url}/${m}/public/${s}${g}`)}}}remove(a){return te(this,void 0,void 0,function*(){try{return{data:yield ad(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:a},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if($e(r))return{data:null,error:r};throw r}})}list(a,r,s){return te(this,void 0,void 0,function*(){try{const o=Object.assign(Object.assign(Object.assign({},tw),r),{prefix:a||""});return{data:yield It(this.fetch,`${this.url}/object/list/${this.bucketId}`,o,{headers:this.headers},s),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if($e(o))return{data:null,error:o};throw o}})}listV2(a,r){return te(this,void 0,void 0,function*(){try{const s=Object.assign({},a);return{data:yield It(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if($e(s))return{data:null,error:s};throw s}})}encodeMetadata(a){return JSON.stringify(a)}toBase64(a){return typeof Buffer<"u"?Buffer.from(a).toString("base64"):btoa(a)}_getFinalPath(a){return`${this.bucketId}/${a.replace(/^\/+/,"")}`}_removeEmptyFolders(a){return a.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(a){const r=[];return a.width&&r.push(`width=${a.width}`),a.height&&r.push(`height=${a.height}`),a.resize&&r.push(`resize=${a.resize}`),a.format&&r.push(`format=${a.format}`),a.quality&&r.push(`quality=${a.quality}`),r.join("&")}}const by="2.80.0",xy={"X-Client-Info":`storage-js/${by}`};class rw{constructor(a,r={},s,o){this.shouldThrowOnError=!1;const c=new URL(a);o?.useNewHostname&&/supabase\.(co|in|red)$/.test(c.hostname)&&!c.hostname.includes("storage.supabase.")&&(c.hostname=c.hostname.replace("supabase.","storage.supabase.")),this.url=c.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},xy),r),this.fetch=td(s)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(a){return te(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(a);return{data:yield Ms(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if($e(r))return{data:null,error:r};throw r}})}getBucket(a){return te(this,void 0,void 0,function*(){try{return{data:yield Ms(this.fetch,`${this.url}/bucket/${a}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if($e(r))return{data:null,error:r};throw r}})}createBucket(a){return te(this,arguments,void 0,function*(r,s={public:!1}){try{return{data:yield It(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if($e(o))return{data:null,error:o};throw o}})}updateBucket(a,r){return te(this,void 0,void 0,function*(){try{return{data:yield Ou(this.fetch,`${this.url}/bucket/${a}`,{id:a,name:a,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if($e(s))return{data:null,error:s};throw s}})}emptyBucket(a){return te(this,void 0,void 0,function*(){try{return{data:yield It(this.fetch,`${this.url}/bucket/${a}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if($e(r))return{data:null,error:r};throw r}})}deleteBucket(a){return te(this,void 0,void 0,function*(){try{return{data:yield ad(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if($e(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(a){const r={};return a&&("limit"in a&&(r.limit=String(a.limit)),"offset"in a&&(r.offset=String(a.offset)),a.search&&(r.search=a.search),a.sortColumn&&(r.sortColumn=a.sortColumn),a.sortOrder&&(r.sortOrder=a.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}class nw{constructor(a,r={},s){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},xy),r),this.fetch=td(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(a){return te(this,void 0,void 0,function*(){try{return{data:yield It(this.fetch,`${this.url}/bucket`,{name:a},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if($e(r))return{data:null,error:r};throw r}})}listBuckets(a){return te(this,void 0,void 0,function*(){try{const r=new URLSearchParams;a?.limit!==void 0&&r.set("limit",a.limit.toString()),a?.offset!==void 0&&r.set("offset",a.offset.toString()),a?.sortColumn&&r.set("sortColumn",a.sortColumn),a?.sortOrder&&r.set("sortOrder",a.sortOrder),a?.search&&r.set("search",a.search);const s=r.toString(),o=s?`${this.url}/bucket?${s}`:`${this.url}/bucket`;return{data:yield Ms(this.fetch,o,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if($e(r))return{data:null,error:r};throw r}})}deleteBucket(a){return te(this,void 0,void 0,function*(){try{return{data:yield ad(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if($e(r))return{data:null,error:r};throw r}})}}const rd={"X-Client-Info":`storage-js/${by}`,"Content-Type":"application/json"};class _y extends Error{constructor(a){super(a),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Rt(i){return typeof i=="object"&&i!==null&&"__isStorageVectorsError"in i}class cu extends _y{constructor(a,r,s){super(a),this.name="StorageVectorsApiError",this.status=r,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class sw extends _y{constructor(a,r){super(a),this.name="StorageVectorsUnknownError",this.originalError=r}}var qp;(function(i){i.InternalError="InternalError",i.S3VectorConflictException="S3VectorConflictException",i.S3VectorNotFoundException="S3VectorNotFoundException",i.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",i.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",i.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(qp||(qp={}));const nd=i=>i?(...a)=>i(...a):(...a)=>fetch(...a),iw=i=>{if(typeof i!="object"||i===null)return!1;const a=Object.getPrototypeOf(i);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(Symbol.toStringTag in i)&&!(Symbol.iterator in i)},Pp=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),lw=(i,a,r)=>te(void 0,void 0,void 0,function*(){if(i&&typeof i=="object"&&"status"in i&&"ok"in i&&typeof i.status=="number"&&!r?.noResolveJson){const o=i.status||500,c=i;if(typeof c.json=="function")c.json().then(h=>{const m=h?.statusCode||h?.code||o+"";a(new cu(Pp(h),o,m))}).catch(()=>{const h=o+"",m=c.statusText||`HTTP ${o} error`;a(new cu(m,o,h))});else{const h=o+"",m=c.statusText||`HTTP ${o} error`;a(new cu(m,o,h))}}else a(new sw(Pp(i),i))}),ow=(i,a,r,s)=>{const o={method:i,headers:a?.headers||{}};return s?(iw(s)?(o.headers=Object.assign({"Content-Type":"application/json"},a?.headers),o.body=JSON.stringify(s)):o.body=s,Object.assign(Object.assign({},o),r)):o};function cw(i,a,r,s,o,c){return te(this,void 0,void 0,function*(){return new Promise((h,m)=>{i(r,ow(a,s,o,c)).then(p=>{if(!p.ok)throw p;if(s?.noResolveJson)return p;const g=p.headers.get("content-type");return!g||!g.includes("application/json")?{}:p.json()}).then(p=>h(p)).catch(p=>lw(p,m,s))})})}function Tt(i,a,r,s,o){return te(this,void 0,void 0,function*(){return cw(i,"POST",a,s,o,r)})}class uw{constructor(a,r={},s){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},rd),r),this.fetch=nd(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(a){return te(this,void 0,void 0,function*(){try{return{data:(yield Tt(this.fetch,`${this.url}/CreateIndex`,a,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Rt(r))return{data:null,error:r};throw r}})}getIndex(a,r){return te(this,void 0,void 0,function*(){try{return{data:yield Tt(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:a,indexName:r},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Rt(s))return{data:null,error:s};throw s}})}listIndexes(a){return te(this,void 0,void 0,function*(){try{return{data:yield Tt(this.fetch,`${this.url}/ListIndexes`,a,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Rt(r))return{data:null,error:r};throw r}})}deleteIndex(a,r){return te(this,void 0,void 0,function*(){try{return{data:(yield Tt(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:a,indexName:r},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Rt(s))return{data:null,error:s};throw s}})}}class dw{constructor(a,r={},s){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},rd),r),this.fetch=nd(s)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(a){return te(this,void 0,void 0,function*(){try{if(a.vectors.length<1||a.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Tt(this.fetch,`${this.url}/PutVectors`,a,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Rt(r))return{data:null,error:r};throw r}})}getVectors(a){return te(this,void 0,void 0,function*(){try{return{data:yield Tt(this.fetch,`${this.url}/GetVectors`,a,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Rt(r))return{data:null,error:r};throw r}})}listVectors(a){return te(this,void 0,void 0,function*(){try{if(a.segmentCount!==void 0){if(a.segmentCount<1||a.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(a.segmentIndex!==void 0&&(a.segmentIndex<0||a.segmentIndex>=a.segmentCount))throw new Error(`segmentIndex must be between 0 and ${a.segmentCount-1}`)}return{data:yield Tt(this.fetch,`${this.url}/ListVectors`,a,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Rt(r))return{data:null,error:r};throw r}})}queryVectors(a){return te(this,void 0,void 0,function*(){try{return{data:yield Tt(this.fetch,`${this.url}/QueryVectors`,a,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Rt(r))return{data:null,error:r};throw r}})}deleteVectors(a){return te(this,void 0,void 0,function*(){try{if(a.keys.length<1||a.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Tt(this.fetch,`${this.url}/DeleteVectors`,a,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Rt(r))return{data:null,error:r};throw r}})}}class hw{constructor(a,r={},s){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},rd),r),this.fetch=nd(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(a){return te(this,void 0,void 0,function*(){try{return{data:(yield Tt(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:a},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Rt(r))return{data:null,error:r};throw r}})}getBucket(a){return te(this,void 0,void 0,function*(){try{return{data:yield Tt(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:a},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Rt(r))return{data:null,error:r};throw r}})}listBuckets(){return te(this,arguments,void 0,function*(a={}){try{return{data:yield Tt(this.fetch,`${this.url}/ListVectorBuckets`,a,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Rt(r))return{data:null,error:r};throw r}})}deleteBucket(a){return te(this,void 0,void 0,function*(){try{return{data:(yield Tt(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:a},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Rt(r))return{data:null,error:r};throw r}})}}class fw extends hw{constructor(a,r={}){super(a,r.headers||{},r.fetch)}from(a){return new mw(this.url,this.headers,a,this.fetch)}}class mw extends uw{constructor(a,r,s,o){super(a,r,o),this.vectorBucketName=s}createIndex(a){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return te(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const a=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return te(this,arguments,void 0,function*(r={}){return a.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(a){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return te(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,a)})}deleteIndex(a){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return te(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,a)})}index(a){return new pw(this.url,this.headers,this.vectorBucketName,a,this.fetch)}}class pw extends dw{constructor(a,r,s,o,c){super(a,r,c),this.vectorBucketName=s,this.indexName=o}putVectors(a){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return te(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(a){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return te(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const a=Object.create(null,{listVectors:{get:()=>super.listVectors}});return te(this,arguments,void 0,function*(r={}){return a.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(a){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return te(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(a){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return te(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class gw extends rw{constructor(a,r={},s,o){super(a,r,s,o)}from(a){return new aw(this.url,this.headers,a,this.fetch)}get vectors(){return new fw(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new nw(this.url+"/iceberg",this.headers,this.fetch)}}const yw="2.80.0";let Rs="";typeof Deno<"u"?Rs="deno":typeof document<"u"?Rs="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Rs="react-native":Rs="node";const vw={"X-Client-Info":`supabase-js-${Rs}/${yw}`},bw={headers:vw},xw={schema:"public"},_w={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ww={},Sw=i=>i?(...a)=>i(...a):(...a)=>fetch(...a),Cw=()=>Headers,jw=(i,a,r)=>{const s=Sw(r),o=Cw();return async(c,h)=>{var m;const p=(m=await a())!==null&&m!==void 0?m:i;let g=new o(h?.headers);return g.has("apikey")||g.set("apikey",i),g.has("Authorization")||g.set("Authorization",`Bearer ${p}`),s(c,Object.assign(Object.assign({},h),{headers:g}))}};function Aw(i){return i.endsWith("/")?i:i+"/"}function Nw(i,a){var r,s;const{db:o,auth:c,realtime:h,global:m}=i,{db:p,auth:g,realtime:v,global:b}=a,x={db:Object.assign(Object.assign({},p),o),auth:Object.assign(Object.assign({},g),c),realtime:Object.assign(Object.assign({},v),h),storage:{},global:Object.assign(Object.assign(Object.assign({},b),m),{headers:Object.assign(Object.assign({},(r=b?.headers)!==null&&r!==void 0?r:{}),(s=m?.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return i.accessToken?x.accessToken=i.accessToken:delete x.accessToken,x}function Ew(i){const a=i?.trim();if(!a)throw new Error("supabaseUrl is required.");if(!a.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Aw(a))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const wy="2.80.0",bn=30*1e3,Du=3,uu=Du*bn,Rw="http://localhost:9999",Tw="supabase.auth.token",kw={"X-Client-Info":`gotrue-js/${wy}`},Mu="X-Supabase-Api-Version",Sy={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Ow=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Dw=600*1e3;class Us extends Error{constructor(a,r,s){super(a),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function ne(i){return typeof i=="object"&&i!==null&&"__isAuthError"in i}class Mw extends Us{constructor(a,r,s){super(a,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function Uw(i){return ne(i)&&i.name==="AuthApiError"}class Sr extends Us{constructor(a,r){super(a),this.name="AuthUnknownError",this.originalError=r}}class er extends Us{constructor(a,r,s,o){super(a,s,o),this.name=r,this.status=s}}class Ft extends er{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function zw(i){return ne(i)&&i.name==="AuthSessionMissingError"}class fn extends er{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class pl extends er{constructor(a){super(a,"AuthInvalidCredentialsError",400,void 0)}}class gl extends er{constructor(a,r=null){super(a,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Lw(i){return ne(i)&&i.name==="AuthImplicitGrantRedirectError"}class $p extends er{constructor(a,r=null){super(a,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Uu extends er{constructor(a,r){super(a,"AuthRetryableFetchError",r,void 0)}}function du(i){return ne(i)&&i.name==="AuthRetryableFetchError"}class Hp extends er{constructor(a,r,s){super(a,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class zu extends er{constructor(a){super(a,"AuthInvalidJwtError",400,"invalid_jwt")}}const Cl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Vp=` 	
\r=`.split(""),Bw=(()=>{const i=new Array(128);for(let a=0;a<i.length;a+=1)i[a]=-1;for(let a=0;a<Vp.length;a+=1)i[Vp[a].charCodeAt(0)]=-2;for(let a=0;a<Cl.length;a+=1)i[Cl[a].charCodeAt(0)]=a;return i})();function Fp(i,a,r){if(i!==null)for(a.queue=a.queue<<8|i,a.queuedBits+=8;a.queuedBits>=6;){const s=a.queue>>a.queuedBits-6&63;r(Cl[s]),a.queuedBits-=6}else if(a.queuedBits>0)for(a.queue=a.queue<<6-a.queuedBits,a.queuedBits=6;a.queuedBits>=6;){const s=a.queue>>a.queuedBits-6&63;r(Cl[s]),a.queuedBits-=6}}function Cy(i,a,r){const s=Bw[i];if(s>-1)for(a.queue=a.queue<<6|s,a.queuedBits+=6;a.queuedBits>=8;)r(a.queue>>a.queuedBits-8&255),a.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(i)}"`)}}function Gp(i){const a=[],r=h=>{a.push(String.fromCodePoint(h))},s={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},c=h=>{$w(h,s,r)};for(let h=0;h<i.length;h+=1)Cy(i.charCodeAt(h),o,c);return a.join("")}function qw(i,a){if(i<=127){a(i);return}else if(i<=2047){a(192|i>>6),a(128|i&63);return}else if(i<=65535){a(224|i>>12),a(128|i>>6&63),a(128|i&63);return}else if(i<=1114111){a(240|i>>18),a(128|i>>12&63),a(128|i>>6&63),a(128|i&63);return}throw new Error(`Unrecognized Unicode codepoint: ${i.toString(16)}`)}function Pw(i,a){for(let r=0;r<i.length;r+=1){let s=i.charCodeAt(r);if(s>55295&&s<=56319){const o=(s-55296)*1024&65535;s=(i.charCodeAt(r+1)-56320&65535|o)+65536,r+=1}qw(s,a)}}function $w(i,a,r){if(a.utf8seq===0){if(i<=127){r(i);return}for(let s=1;s<6;s+=1)if((i>>7-s&1)===0){a.utf8seq=s;break}if(a.utf8seq===2)a.codepoint=i&31;else if(a.utf8seq===3)a.codepoint=i&15;else if(a.utf8seq===4)a.codepoint=i&7;else throw new Error("Invalid UTF-8 sequence");a.utf8seq-=1}else if(a.utf8seq>0){if(i<=127)throw new Error("Invalid UTF-8 sequence");a.codepoint=a.codepoint<<6|i&63,a.utf8seq-=1,a.utf8seq===0&&r(a.codepoint)}}function wn(i){const a=[],r={queue:0,queuedBits:0},s=o=>{a.push(o)};for(let o=0;o<i.length;o+=1)Cy(i.charCodeAt(o),r,s);return new Uint8Array(a)}function Hw(i){const a=[];return Pw(i,r=>a.push(r)),new Uint8Array(a)}function Cr(i){const a=[],r={queue:0,queuedBits:0},s=o=>{a.push(o)};return i.forEach(o=>Fp(o,r,s)),Fp(null,r,s),a.join("")}function Vw(i){return Math.round(Date.now()/1e3)+i}function Fw(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){const a=Math.random()*16|0;return(i=="x"?a:a&3|8).toString(16)})}const ut=()=>typeof window<"u"&&typeof document<"u",br={tested:!1,writable:!1},jy=()=>{if(!ut())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(br.tested)return br.writable;const i=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(i,i),globalThis.localStorage.removeItem(i),br.tested=!0,br.writable=!0}catch{br.tested=!0,br.writable=!1}return br.writable};function Gw(i){const a={},r=new URL(i);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((o,c)=>{a[c]=o})}catch{}return r.searchParams.forEach((s,o)=>{a[o]=s}),a}const Ay=i=>i?(...a)=>i(...a):(...a)=>fetch(...a),Iw=i=>typeof i=="object"&&i!==null&&"status"in i&&"ok"in i&&"json"in i&&typeof i.json=="function",xn=async(i,a,r)=>{await i.setItem(a,JSON.stringify(r))},xr=async(i,a)=>{const r=await i.getItem(a);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Ja=async(i,a)=>{await i.removeItem(a)};class Dl{constructor(){this.promise=new Dl.promiseConstructor((a,r)=>{this.resolve=a,this.reject=r})}}Dl.promiseConstructor=Promise;function hu(i){const a=i.split(".");if(a.length!==3)throw new zu("Invalid JWT structure");for(let s=0;s<a.length;s++)if(!Ow.test(a[s]))throw new zu("JWT not in base64url format");return{header:JSON.parse(Gp(a[0])),payload:JSON.parse(Gp(a[1])),signature:wn(a[2]),raw:{header:a[0],payload:a[1]}}}async function Yw(i){return await new Promise(a=>{setTimeout(()=>a(null),i)})}function Qw(i,a){return new Promise((s,o)=>{(async()=>{for(let c=0;c<1/0;c++)try{const h=await i(c);if(!a(c,null,h)){s(h);return}}catch(h){if(!a(c,h)){o(h);return}}})()})}function Kw(i){return("0"+i.toString(16)).substr(-2)}function Ww(){const a=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let o="";for(let c=0;c<56;c++)o+=r.charAt(Math.floor(Math.random()*s));return o}return crypto.getRandomValues(a),Array.from(a,Kw).join("")}async function Jw(i){const r=new TextEncoder().encode(i),s=await crypto.subtle.digest("SHA-256",r),o=new Uint8Array(s);return Array.from(o).map(c=>String.fromCharCode(c)).join("")}async function Xw(i){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),i;const r=await Jw(i);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function mn(i,a,r=!1){const s=Ww();let o=s;r&&(o+="/PASSWORD_RECOVERY"),await xn(i,`${a}-code-verifier`,o);const c=await Xw(s);return[c,s===c?"plain":"s256"]}const Zw=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function eS(i){const a=i.headers.get(Mu);if(!a||!a.match(Zw))return null;try{return new Date(`${a}T00:00:00.0Z`)}catch{return null}}function tS(i){if(!i)throw new Error("Missing exp claim");const a=Math.floor(Date.now()/1e3);if(i<=a)throw new Error("JWT has expired")}function aS(i){switch(i){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const rS=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function pn(i){if(!rS.test(i))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function fu(){const i={};return new Proxy(i,{get:(a,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(a,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(a,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function nS(i,a){return new Proxy(i,{get:(r,s,o)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const c=s.toString();if(c==="Symbol(Symbol.toPrimitive)"||c==="Symbol(Symbol.toStringTag)"||c==="Symbol(util.inspect.custom)"||c==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,s,o)}return!a.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a.value=!0),Reflect.get(r,s,o)}})}function Ip(i){return JSON.parse(JSON.stringify(i))}const _r=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),sS=[502,503,504];async function Yp(i){var a;if(!Iw(i))throw new Uu(_r(i),0);if(sS.includes(i.status))throw new Uu(_r(i),i.status);let r;try{r=await i.json()}catch(c){throw new Sr(_r(c),c)}let s;const o=eS(i);if(o&&o.getTime()>=Sy["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new Hp(_r(r),i.status,((a=r.weak_password)===null||a===void 0?void 0:a.reasons)||[]);if(s==="session_not_found")throw new Ft}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((c,h)=>c&&typeof h=="string",!0))throw new Hp(_r(r),i.status,r.weak_password.reasons);throw new Mw(_r(r),i.status||500,s)}const iS=(i,a,r,s)=>{const o={method:i,headers:a?.headers||{}};return i==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},a?.headers),o.body=JSON.stringify(s),Object.assign(Object.assign({},o),r))};async function ue(i,a,r,s){var o;const c=Object.assign({},s?.headers);c[Mu]||(c[Mu]=Sy["2024-01-01"].name),s?.jwt&&(c.Authorization=`Bearer ${s.jwt}`);const h=(o=s?.query)!==null&&o!==void 0?o:{};s?.redirectTo&&(h.redirect_to=s.redirectTo);const m=Object.keys(h).length?"?"+new URLSearchParams(h).toString():"",p=await lS(i,a,r+m,{headers:c,noResolveJson:s?.noResolveJson},{},s?.body);return s?.xform?s?.xform(p):{data:Object.assign({},p),error:null}}async function lS(i,a,r,s,o,c){const h=iS(a,s,o,c);let m;try{m=await i(r,Object.assign({},h))}catch(p){throw console.error(p),new Uu(_r(p),0)}if(m.ok||await Yp(m),s?.noResolveJson)return m;try{return await m.json()}catch(p){await Yp(p)}}function Gt(i){var a;let r=null;uS(i)&&(r=Object.assign({},i),i.expires_at||(r.expires_at=Vw(i.expires_in)));const s=(a=i.user)!==null&&a!==void 0?a:i;return{data:{session:r,user:s},error:null}}function Qp(i){const a=Gt(i);return!a.error&&i.weak_password&&typeof i.weak_password=="object"&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.message&&typeof i.weak_password.message=="string"&&i.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(a.data.weak_password=i.weak_password),a}function Xa(i){var a;return{data:{user:(a=i.user)!==null&&a!==void 0?a:i},error:null}}function oS(i){return{data:i,error:null}}function cS(i){const{action_link:a,email_otp:r,hashed_token:s,redirect_to:o,verification_type:c}=i,h=En(i,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),m={action_link:a,email_otp:r,hashed_token:s,redirect_to:o,verification_type:c},p=Object.assign({},h);return{data:{properties:m,user:p},error:null}}function Kp(i){return i}function uS(i){return i.access_token&&i.refresh_token&&i.expires_in}const mu=["global","local","others"];class dS{constructor({url:a="",headers:r={},fetch:s}){this.url=a,this.headers=r,this.fetch=Ay(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(a,r=mu[0]){if(mu.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${mu.join(", ")}`);try{return await ue(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:a,noResolveJson:!0}),{data:null,error:null}}catch(s){if(ne(s))return{data:null,error:s};throw s}}async inviteUserByEmail(a,r={}){try{return await ue(this.fetch,"POST",`${this.url}/invite`,{body:{email:a,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Xa})}catch(s){if(ne(s))return{data:{user:null},error:s};throw s}}async generateLink(a){try{const{options:r}=a,s=En(a,["options"]),o=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(o.new_email=s?.newEmail,delete o.newEmail),await ue(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:cS,redirectTo:r?.redirectTo})}catch(r){if(ne(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(a){try{return await ue(this.fetch,"POST",`${this.url}/admin/users`,{body:a,headers:this.headers,xform:Xa})}catch(r){if(ne(r))return{data:{user:null},error:r};throw r}}async listUsers(a){var r,s,o,c,h,m,p;try{const g={nextPage:null,lastPage:0,total:0},v=await ue(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=a?.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(c=(o=a?.perPage)===null||o===void 0?void 0:o.toString())!==null&&c!==void 0?c:""},xform:Kp});if(v.error)throw v.error;const b=await v.json(),x=(h=v.headers.get("x-total-count"))!==null&&h!==void 0?h:0,_=(p=(m=v.headers.get("link"))===null||m===void 0?void 0:m.split(","))!==null&&p!==void 0?p:[];return _.length>0&&(_.forEach(C=>{const j=parseInt(C.split(";")[0].split("=")[1].substring(0,1)),A=JSON.parse(C.split(";")[1].split("=")[1]);g[`${A}Page`]=j}),g.total=parseInt(x)),{data:Object.assign(Object.assign({},b),g),error:null}}catch(g){if(ne(g))return{data:{users:[]},error:g};throw g}}async getUserById(a){pn(a);try{return await ue(this.fetch,"GET",`${this.url}/admin/users/${a}`,{headers:this.headers,xform:Xa})}catch(r){if(ne(r))return{data:{user:null},error:r};throw r}}async updateUserById(a,r){pn(a);try{return await ue(this.fetch,"PUT",`${this.url}/admin/users/${a}`,{body:r,headers:this.headers,xform:Xa})}catch(s){if(ne(s))return{data:{user:null},error:s};throw s}}async deleteUser(a,r=!1){pn(a);try{return await ue(this.fetch,"DELETE",`${this.url}/admin/users/${a}`,{headers:this.headers,body:{should_soft_delete:r},xform:Xa})}catch(s){if(ne(s))return{data:{user:null},error:s};throw s}}async _listFactors(a){pn(a.userId);try{const{data:r,error:s}=await ue(this.fetch,"GET",`${this.url}/admin/users/${a.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:r,error:s}}catch(r){if(ne(r))return{data:null,error:r};throw r}}async _deleteFactor(a){pn(a.userId),pn(a.id);try{return{data:await ue(this.fetch,"DELETE",`${this.url}/admin/users/${a.userId}/factors/${a.id}`,{headers:this.headers}),error:null}}catch(r){if(ne(r))return{data:null,error:r};throw r}}async _listOAuthClients(a){var r,s,o,c,h,m,p;try{const g={nextPage:null,lastPage:0,total:0},v=await ue(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=a?.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(c=(o=a?.perPage)===null||o===void 0?void 0:o.toString())!==null&&c!==void 0?c:""},xform:Kp});if(v.error)throw v.error;const b=await v.json(),x=(h=v.headers.get("x-total-count"))!==null&&h!==void 0?h:0,_=(p=(m=v.headers.get("link"))===null||m===void 0?void 0:m.split(","))!==null&&p!==void 0?p:[];return _.length>0&&(_.forEach(C=>{const j=parseInt(C.split(";")[0].split("=")[1].substring(0,1)),A=JSON.parse(C.split(";")[1].split("=")[1]);g[`${A}Page`]=j}),g.total=parseInt(x)),{data:Object.assign(Object.assign({},b),g),error:null}}catch(g){if(ne(g))return{data:{clients:[]},error:g};throw g}}async _createOAuthClient(a){try{return await ue(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:a,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ne(r))return{data:null,error:r};throw r}}async _getOAuthClient(a){try{return await ue(this.fetch,"GET",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ne(r))return{data:null,error:r};throw r}}async _updateOAuthClient(a,r){try{return await ue(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${a}`,{body:r,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(ne(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(a){try{return await ue(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ne(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(a){try{return await ue(this.fetch,"POST",`${this.url}/admin/oauth/clients/${a}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ne(r))return{data:null,error:r};throw r}}}function Wp(i={}){return{getItem:a=>i[a]||null,setItem:(a,r)=>{i[a]=r},removeItem:a=>{delete i[a]}}}const gn={debug:!!(globalThis&&jy()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Ny extends Error{constructor(a){super(a),this.isAcquireTimeout=!0}}class hS extends Ny{}async function fS(i,a,r){gn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",i,a);const s=new globalThis.AbortController;return a>0&&setTimeout(()=>{s.abort(),gn.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",i)},a),await Promise.resolve().then(()=>globalThis.navigator.locks.request(i,a===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async o=>{if(o){gn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",i,o.name);try{return await r()}finally{gn.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",i,o.name)}}else{if(a===0)throw gn.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",i),new hS(`Acquiring an exclusive Navigator LockManager lock "${i}" immediately failed`);if(gn.debug)try{const c=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(c,null,"  "))}catch(c){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",c)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function mS(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Ey(i){if(!/^0x[a-fA-F0-9]{40}$/.test(i))throw new Error(`@supabase/auth-js: Address "${i}" is invalid.`);return i.toLowerCase()}function pS(i){return parseInt(i,16)}function gS(i){const a=new TextEncoder().encode(i);return"0x"+Array.from(a,s=>s.toString(16).padStart(2,"0")).join("")}function yS(i){var a;const{chainId:r,domain:s,expirationTime:o,issuedAt:c=new Date,nonce:h,notBefore:m,requestId:p,resources:g,scheme:v,uri:b,version:x}=i;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(h&&h.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${h}`);if(!b)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(x!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${x}`);if(!((a=i.statement)===null||a===void 0)&&a.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${i.statement}`)}const _=Ey(i.address),C=v?`${v}://${s}`:s,j=i.statement?`${i.statement}
`:"",A=`${C} wants you to sign in with your Ethereum account:
${_}

${j}`;let R=`URI: ${b}
Version: ${x}
Chain ID: ${r}${h?`
Nonce: ${h}`:""}
Issued At: ${c.toISOString()}`;if(o&&(R+=`
Expiration Time: ${o.toISOString()}`),m&&(R+=`
Not Before: ${m.toISOString()}`),p&&(R+=`
Request ID: ${p}`),g){let k=`
Resources:`;for(const O of g){if(!O||typeof O!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${O}`);k+=`
- ${O}`}R+=k}return`${A}
${R}`}class Je extends Error{constructor({message:a,code:r,cause:s,name:o}){var c;super(a,{cause:s}),this.__isWebAuthnError=!0,this.name=(c=o??(s instanceof Error?s.name:void 0))!==null&&c!==void 0?c:"Unknown Error",this.code=r}}class jl extends Je{constructor(a,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:a}),this.name="WebAuthnUnknownError",this.originalError=r}}function vS({error:i,options:a}){var r,s,o;const{publicKey:c}=a;if(!c)throw Error("options was missing required publicKey property");if(i.name==="AbortError"){if(a.signal instanceof AbortSignal)return new Je({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:i})}else if(i.name==="ConstraintError"){if(((r=c.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Je({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:i});if(a.mediation==="conditional"&&((s=c.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Je({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:i});if(((o=c.authenticatorSelection)===null||o===void 0?void 0:o.userVerification)==="required")return new Je({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:i})}else{if(i.name==="InvalidStateError")return new Je({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:i});if(i.name==="NotAllowedError")return new Je({message:i.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i});if(i.name==="NotSupportedError")return c.pubKeyCredParams.filter(m=>m.type==="public-key").length===0?new Je({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:i}):new Je({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:i});if(i.name==="SecurityError"){const h=window.location.hostname;if(Ry(h)){if(c.rp.id!==h)return new Je({message:`The RP ID "${c.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:i})}else return new Je({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:i})}else if(i.name==="TypeError"){if(c.user.id.byteLength<1||c.user.id.byteLength>64)return new Je({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:i})}else if(i.name==="UnknownError")return new Je({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:i})}return new Je({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i})}function bS({error:i,options:a}){const{publicKey:r}=a;if(!r)throw Error("options was missing required publicKey property");if(i.name==="AbortError"){if(a.signal instanceof AbortSignal)return new Je({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:i})}else{if(i.name==="NotAllowedError")return new Je({message:i.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i});if(i.name==="SecurityError"){const s=window.location.hostname;if(Ry(s)){if(r.rpId!==s)return new Je({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:i})}else return new Je({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:i})}else if(i.name==="UnknownError")return new Je({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:i})}return new Je({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i})}class xS{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const a=new AbortController;return this.controller=a,a.signal}cancelCeremony(){if(this.controller){const a=new Error("Manually cancelling existing WebAuthn API call");a.name="AbortError",this.controller.abort(a),this.controller=void 0}}}const _S=new xS;function wS(i){if(!i)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(i);const{challenge:a,user:r,excludeCredentials:s}=i,o=En(i,["challenge","user","excludeCredentials"]),c=wn(a).buffer,h=Object.assign(Object.assign({},r),{id:wn(r.id).buffer}),m=Object.assign(Object.assign({},o),{challenge:c,user:h});if(s&&s.length>0){m.excludeCredentials=new Array(s.length);for(let p=0;p<s.length;p++){const g=s[p];m.excludeCredentials[p]=Object.assign(Object.assign({},g),{id:wn(g.id).buffer,type:g.type||"public-key",transports:g.transports})}}return m}function SS(i){if(!i)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(i);const{challenge:a,allowCredentials:r}=i,s=En(i,["challenge","allowCredentials"]),o=wn(a).buffer,c=Object.assign(Object.assign({},s),{challenge:o});if(r&&r.length>0){c.allowCredentials=new Array(r.length);for(let h=0;h<r.length;h++){const m=r[h];c.allowCredentials[h]=Object.assign(Object.assign({},m),{id:wn(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return c}function CS(i){var a;if("toJSON"in i&&typeof i.toJSON=="function")return i.toJSON();const r=i;return{id:i.id,rawId:i.id,response:{attestationObject:Cr(new Uint8Array(i.response.attestationObject)),clientDataJSON:Cr(new Uint8Array(i.response.clientDataJSON))},type:"public-key",clientExtensionResults:i.getClientExtensionResults(),authenticatorAttachment:(a=r.authenticatorAttachment)!==null&&a!==void 0?a:void 0}}function jS(i){var a;if("toJSON"in i&&typeof i.toJSON=="function")return i.toJSON();const r=i,s=i.getClientExtensionResults(),o=i.response;return{id:i.id,rawId:i.id,response:{authenticatorData:Cr(new Uint8Array(o.authenticatorData)),clientDataJSON:Cr(new Uint8Array(o.clientDataJSON)),signature:Cr(new Uint8Array(o.signature)),userHandle:o.userHandle?Cr(new Uint8Array(o.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(a=r.authenticatorAttachment)!==null&&a!==void 0?a:void 0}}function Ry(i){return i==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(i)}function Jp(){var i,a;return!!(ut()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((i=navigator?.credentials)===null||i===void 0?void 0:i.create)=="function"&&typeof((a=navigator?.credentials)===null||a===void 0?void 0:a.get)=="function")}async function AS(i){try{const a=await navigator.credentials.create(i);return a?a instanceof PublicKeyCredential?{data:a,error:null}:{data:null,error:new jl("Browser returned unexpected credential type",a)}:{data:null,error:new jl("Empty credential response",a)}}catch(a){return{data:null,error:vS({error:a,options:i})}}}async function NS(i){try{const a=await navigator.credentials.get(i);return a?a instanceof PublicKeyCredential?{data:a,error:null}:{data:null,error:new jl("Browser returned unexpected credential type",a)}:{data:null,error:new jl("Empty credential response",a)}}catch(a){return{data:null,error:bS({error:a,options:i})}}}const ES={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},RS={userVerification:"preferred",hints:["security-key"]};function Al(...i){const a=o=>o!==null&&typeof o=="object"&&!Array.isArray(o),r=o=>o instanceof ArrayBuffer||ArrayBuffer.isView(o),s={};for(const o of i)if(o)for(const c in o){const h=o[c];if(h!==void 0)if(Array.isArray(h))s[c]=h;else if(r(h))s[c]=h;else if(a(h)){const m=s[c];a(m)?s[c]=Al(m,h):s[c]=Al(h)}else s[c]=h}return s}function TS(i,a){return Al(ES,i,a||{})}function kS(i,a){return Al(RS,i,a||{})}class OS{constructor(a){this.client=a,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(a){return this.client.mfa.enroll(Object.assign(Object.assign({},a),{factorType:"webauthn"}))}async _challenge({factorId:a,webauthn:r,friendlyName:s,signal:o},c){try{const{data:h,error:m}=await this.client.mfa.challenge({factorId:a,webauthn:r});if(!h)return{data:null,error:m};const p=o??_S.createNewAbortSignal();if(h.webauthn.type==="create"){const{user:g}=h.webauthn.credential_options.publicKey;g.name||(g.name=`${g.id}:${s}`),g.displayName||(g.displayName=g.name)}switch(h.webauthn.type){case"create":{const g=TS(h.webauthn.credential_options.publicKey,c?.create),{data:v,error:b}=await AS({publicKey:g,signal:p});return v?{data:{factorId:a,challengeId:h.id,webauthn:{type:h.webauthn.type,credential_response:v}},error:null}:{data:null,error:b}}case"request":{const g=kS(h.webauthn.credential_options.publicKey,c?.request),{data:v,error:b}=await NS(Object.assign(Object.assign({},h.webauthn.credential_options),{publicKey:g,signal:p}));return v?{data:{factorId:a,challengeId:h.id,webauthn:{type:h.webauthn.type,credential_response:v}},error:null}:{data:null,error:b}}}}catch(h){return ne(h)?{data:null,error:h}:{data:null,error:new Sr("Unexpected error in challenge",h)}}}async _verify({challengeId:a,factorId:r,webauthn:s}){return this.client.mfa.verify({factorId:r,challengeId:a,webauthn:s})}async _authenticate({factorId:a,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:o}},c){if(!r)return{data:null,error:new Us("rpId is required for WebAuthn authentication")};try{if(!Jp())return{data:null,error:new Sr("Browser does not support WebAuthn",null)};const{data:h,error:m}=await this.challenge({factorId:a,webauthn:{rpId:r,rpOrigins:s},signal:o},{request:c});if(!h)return{data:null,error:m};const{webauthn:p}=h;return this._verify({factorId:a,challengeId:h.challengeId,webauthn:{type:p.type,rpId:r,rpOrigins:s,credential_response:p.credential_response}})}catch(h){return ne(h)?{data:null,error:h}:{data:null,error:new Sr("Unexpected error in authenticate",h)}}}async _register({friendlyName:a,rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:o},c){if(!r)return{data:null,error:new Us("rpId is required for WebAuthn registration")};try{if(!Jp())return{data:null,error:new Sr("Browser does not support WebAuthn",null)};const{data:h,error:m}=await this._enroll({friendlyName:a});if(!h)return await this.client.mfa.listFactors().then(v=>{var b;return(b=v.data)===null||b===void 0?void 0:b.all.find(x=>x.factor_type==="webauthn"&&x.friendly_name===a&&x.status!=="unverified")}).then(v=>v?this.client.mfa.unenroll({factorId:v?.id}):void 0),{data:null,error:m};const{data:p,error:g}=await this._challenge({factorId:h.id,friendlyName:h.friendly_name,webauthn:{rpId:r,rpOrigins:s},signal:o},{create:c});return p?this._verify({factorId:h.id,challengeId:p.challengeId,webauthn:{rpId:r,rpOrigins:s,type:p.webauthn.type,credential_response:p.webauthn.credential_response}}):{data:null,error:g}}catch(h){return ne(h)?{data:null,error:h}:{data:null,error:new Sr("Unexpected error in register",h)}}}}mS();const DS={url:Rw,storageKey:Tw,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:kw,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Xp(i,a,r){return await r()}const yn={};class zs{get jwks(){var a,r;return(r=(a=yn[this.storageKey])===null||a===void 0?void 0:a.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(a){yn[this.storageKey]=Object.assign(Object.assign({},yn[this.storageKey]),{jwks:a})}get jwks_cached_at(){var a,r;return(r=(a=yn[this.storageKey])===null||a===void 0?void 0:a.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(a){yn[this.storageKey]=Object.assign(Object.assign({},yn[this.storageKey]),{cachedAt:a})}constructor(a){var r,s,o;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const c=Object.assign(Object.assign({},DS),a);if(this.storageKey=c.storageKey,this.instanceID=(r=zs.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,zs.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!c.debug,typeof c.debug=="function"&&(this.logger=c.debug),this.instanceID>0&&ut()){const h=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(h),this.logDebugMessages&&console.trace(h)}if(this.persistSession=c.persistSession,this.autoRefreshToken=c.autoRefreshToken,this.admin=new dS({url:c.url,headers:c.headers,fetch:c.fetch}),this.url=c.url,this.headers=c.headers,this.fetch=Ay(c.fetch),this.lock=c.lock||Xp,this.detectSessionInUrl=c.detectSessionInUrl,this.flowType=c.flowType,this.hasCustomAuthorizationHeader=c.hasCustomAuthorizationHeader,this.throwOnError=c.throwOnError,c.lock?this.lock=c.lock:ut()&&(!((s=globalThis?.navigator)===null||s===void 0)&&s.locks)?this.lock=fS:this.lock=Xp,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new OS(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(c.storage?this.storage=c.storage:jy()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Wp(this.memoryStorage)),c.userStorage&&(this.userStorage=c.userStorage)):(this.memoryStorage={},this.storage=Wp(this.memoryStorage)),ut()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(h){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",h)}(o=this.broadcastChannel)===null||o===void 0||o.addEventListener("message",async h=>{this._debug("received broadcast notification from other tab or client",h),await this._notifyAllSubscribers(h.data.event,h.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(a){if(this.throwOnError&&a&&a.error)throw a.error;return a}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${wy}) ${new Date().toISOString()}`}_debug(...a){return this.logDebugMessages&&this.logger(this._logPrefix(),...a),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var a;try{let r={},s="none";if(ut()&&(r=Gw(window.location.href),this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce")),ut()&&this.detectSessionInUrl&&s!=="none"){const{data:o,error:c}=await this._getSessionFromURL(r,s);if(c){if(this._debug("#_initialize()","error detecting session from URL",c),Lw(c)){const p=(a=c.details)===null||a===void 0?void 0:a.code;if(p==="identity_already_exists"||p==="identity_not_found"||p==="single_identity_not_deletable")return{error:c}}return await this._removeSession(),{error:c}}const{session:h,redirectType:m}=o;return this._debug("#_initialize()","detected session in URL",h,"redirect type",m),await this._saveSession(h),setTimeout(async()=>{m==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",h):await this._notifyAllSubscribers("SIGNED_IN",h)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return ne(r)?this._returnResult({error:r}):this._returnResult({error:new Sr("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(a){var r,s,o;try{const c=await ue(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=a?.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(o=a?.options)===null||o===void 0?void 0:o.captchaToken}},xform:Gt}),{data:h,error:m}=c;if(m||!h)return this._returnResult({data:{user:null,session:null},error:m});const p=h.session,g=h.user;return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:g,session:p},error:null})}catch(c){if(ne(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async signUp(a){var r,s,o;try{let c;if("email"in a){const{email:v,password:b,options:x}=a;let _=null,C=null;this.flowType==="pkce"&&([_,C]=await mn(this.storage,this.storageKey)),c=await ue(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:x?.emailRedirectTo,body:{email:v,password:b,data:(r=x?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:x?.captchaToken},code_challenge:_,code_challenge_method:C},xform:Gt})}else if("phone"in a){const{phone:v,password:b,options:x}=a;c=await ue(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:v,password:b,data:(s=x?.data)!==null&&s!==void 0?s:{},channel:(o=x?.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:x?.captchaToken}},xform:Gt})}else throw new pl("You must provide either an email or phone number and a password");const{data:h,error:m}=c;if(m||!h)return this._returnResult({data:{user:null,session:null},error:m});const p=h.session,g=h.user;return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:g,session:p},error:null})}catch(c){if(ne(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async signInWithPassword(a){try{let r;if("email"in a){const{email:c,password:h,options:m}=a;r=await ue(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:c,password:h,gotrue_meta_security:{captcha_token:m?.captchaToken}},xform:Qp})}else if("phone"in a){const{phone:c,password:h,options:m}=a;r=await ue(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:c,password:h,gotrue_meta_security:{captcha_token:m?.captchaToken}},xform:Qp})}else throw new pl("You must provide either an email or phone number and a password");const{data:s,error:o}=r;if(o)return this._returnResult({data:{user:null,session:null},error:o});if(!s||!s.session||!s.user){const c=new fn;return this._returnResult({data:{user:null,session:null},error:c})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:o})}catch(r){if(ne(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(a){var r,s,o,c;return await this._handleProviderSignIn(a.provider,{redirectTo:(r=a.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=a.options)===null||s===void 0?void 0:s.scopes,queryParams:(o=a.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(c=a.options)===null||c===void 0?void 0:c.skipBrowserRedirect})}async exchangeCodeForSession(a){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(a))}async signInWithWeb3(a){const{chain:r}=a;switch(r){case"ethereum":return await this.signInWithEthereum(a);case"solana":return await this.signInWithSolana(a);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(a){var r,s,o,c,h,m,p,g,v,b,x;let _,C;if("message"in a)_=a.message,C=a.signature;else{const{chain:j,wallet:A,statement:R,options:k}=a;let O;if(ut())if(typeof A=="object")O=A;else{const q=window;if("ethereum"in q&&typeof q.ethereum=="object"&&"request"in q.ethereum&&typeof q.ethereum.request=="function")O=q.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof A!="object"||!k?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");O=A}const H=new URL((r=k?.url)!==null&&r!==void 0?r:window.location.href),I=await O.request({method:"eth_requestAccounts"}).then(q=>q).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!I||I.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const V=Ey(I[0]);let re=(s=k?.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!re){const q=await O.request({method:"eth_chainId"});re=pS(q)}const G={domain:H.host,address:V,statement:R,uri:H.href,version:"1",chainId:re,nonce:(o=k?.signInWithEthereum)===null||o===void 0?void 0:o.nonce,issuedAt:(h=(c=k?.signInWithEthereum)===null||c===void 0?void 0:c.issuedAt)!==null&&h!==void 0?h:new Date,expirationTime:(m=k?.signInWithEthereum)===null||m===void 0?void 0:m.expirationTime,notBefore:(p=k?.signInWithEthereum)===null||p===void 0?void 0:p.notBefore,requestId:(g=k?.signInWithEthereum)===null||g===void 0?void 0:g.requestId,resources:(v=k?.signInWithEthereum)===null||v===void 0?void 0:v.resources};_=yS(G),C=await O.request({method:"personal_sign",params:[gS(_),V]})}try{const{data:j,error:A}=await ue(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:_,signature:C},!((b=a.options)===null||b===void 0)&&b.captchaToken?{gotrue_meta_security:{captcha_token:(x=a.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:Gt});if(A)throw A;if(!j||!j.session||!j.user){const R=new fn;return this._returnResult({data:{user:null,session:null},error:R})}return j.session&&(await this._saveSession(j.session),await this._notifyAllSubscribers("SIGNED_IN",j.session)),this._returnResult({data:Object.assign({},j),error:A})}catch(j){if(ne(j))return this._returnResult({data:{user:null,session:null},error:j});throw j}}async signInWithSolana(a){var r,s,o,c,h,m,p,g,v,b,x,_;let C,j;if("message"in a)C=a.message,j=a.signature;else{const{chain:A,wallet:R,statement:k,options:O}=a;let H;if(ut())if(typeof R=="object")H=R;else{const V=window;if("solana"in V&&typeof V.solana=="object"&&("signIn"in V.solana&&typeof V.solana.signIn=="function"||"signMessage"in V.solana&&typeof V.solana.signMessage=="function"))H=V.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof R!="object"||!O?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");H=R}const I=new URL((r=O?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in H&&H.signIn){const V=await H.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},O?.signInWithSolana),{version:"1",domain:I.host,uri:I.href}),k?{statement:k}:null));let re;if(Array.isArray(V)&&V[0]&&typeof V[0]=="object")re=V[0];else if(V&&typeof V=="object"&&"signedMessage"in V&&"signature"in V)re=V;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in re&&"signature"in re&&(typeof re.signedMessage=="string"||re.signedMessage instanceof Uint8Array)&&re.signature instanceof Uint8Array)C=typeof re.signedMessage=="string"?re.signedMessage:new TextDecoder().decode(re.signedMessage),j=re.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in H)||typeof H.signMessage!="function"||!("publicKey"in H)||typeof H!="object"||!H.publicKey||!("toBase58"in H.publicKey)||typeof H.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");C=[`${I.host} wants you to sign in with your Solana account:`,H.publicKey.toBase58(),...k?["",k,""]:[""],"Version: 1",`URI: ${I.href}`,`Issued At: ${(o=(s=O?.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&o!==void 0?o:new Date().toISOString()}`,...!((c=O?.signInWithSolana)===null||c===void 0)&&c.notBefore?[`Not Before: ${O.signInWithSolana.notBefore}`]:[],...!((h=O?.signInWithSolana)===null||h===void 0)&&h.expirationTime?[`Expiration Time: ${O.signInWithSolana.expirationTime}`]:[],...!((m=O?.signInWithSolana)===null||m===void 0)&&m.chainId?[`Chain ID: ${O.signInWithSolana.chainId}`]:[],...!((p=O?.signInWithSolana)===null||p===void 0)&&p.nonce?[`Nonce: ${O.signInWithSolana.nonce}`]:[],...!((g=O?.signInWithSolana)===null||g===void 0)&&g.requestId?[`Request ID: ${O.signInWithSolana.requestId}`]:[],...!((b=(v=O?.signInWithSolana)===null||v===void 0?void 0:v.resources)===null||b===void 0)&&b.length?["Resources",...O.signInWithSolana.resources.map(re=>`- ${re}`)]:[]].join(`
`);const V=await H.signMessage(new TextEncoder().encode(C),"utf8");if(!V||!(V instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");j=V}}try{const{data:A,error:R}=await ue(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:C,signature:Cr(j)},!((x=a.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(_=a.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:Gt});if(R)throw R;if(!A||!A.session||!A.user){const k=new fn;return this._returnResult({data:{user:null,session:null},error:k})}return A.session&&(await this._saveSession(A.session),await this._notifyAllSubscribers("SIGNED_IN",A.session)),this._returnResult({data:Object.assign({},A),error:R})}catch(A){if(ne(A))return this._returnResult({data:{user:null,session:null},error:A});throw A}}async _exchangeCodeForSession(a){const r=await xr(this.storage,`${this.storageKey}-code-verifier`),[s,o]=(r??"").split("/");try{const{data:c,error:h}=await ue(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:a,code_verifier:s},xform:Gt});if(await Ja(this.storage,`${this.storageKey}-code-verifier`),h)throw h;if(!c||!c.session||!c.user){const m=new fn;return this._returnResult({data:{user:null,session:null,redirectType:null},error:m})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:Object.assign(Object.assign({},c),{redirectType:o??null}),error:h})}catch(c){if(ne(c))return this._returnResult({data:{user:null,session:null,redirectType:null},error:c});throw c}}async signInWithIdToken(a){try{const{options:r,provider:s,token:o,access_token:c,nonce:h}=a,m=await ue(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:o,access_token:c,nonce:h,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:Gt}),{data:p,error:g}=m;if(g)return this._returnResult({data:{user:null,session:null},error:g});if(!p||!p.session||!p.user){const v=new fn;return this._returnResult({data:{user:null,session:null},error:v})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:p,error:g})}catch(r){if(ne(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(a){var r,s,o,c,h;try{if("email"in a){const{email:m,options:p}=a;let g=null,v=null;this.flowType==="pkce"&&([g,v]=await mn(this.storage,this.storageKey));const{error:b}=await ue(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:m,data:(r=p?.data)!==null&&r!==void 0?r:{},create_user:(s=p?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},code_challenge:g,code_challenge_method:v},redirectTo:p?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:b})}if("phone"in a){const{phone:m,options:p}=a,{data:g,error:v}=await ue(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:m,data:(o=p?.data)!==null&&o!==void 0?o:{},create_user:(c=p?.shouldCreateUser)!==null&&c!==void 0?c:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},channel:(h=p?.channel)!==null&&h!==void 0?h:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:g?.message_id},error:v})}throw new pl("You must provide either an email or phone number.")}catch(m){if(ne(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async verifyOtp(a){var r,s;try{let o,c;"options"in a&&(o=(r=a.options)===null||r===void 0?void 0:r.redirectTo,c=(s=a.options)===null||s===void 0?void 0:s.captchaToken);const{data:h,error:m}=await ue(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},a),{gotrue_meta_security:{captcha_token:c}}),redirectTo:o,xform:Gt});if(m)throw m;if(!h)throw new Error("An error occurred on token verification.");const p=h.session,g=h.user;return p?.access_token&&(await this._saveSession(p),await this._notifyAllSubscribers(a.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",p)),this._returnResult({data:{user:g,session:p},error:null})}catch(o){if(ne(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signInWithSSO(a){var r,s,o;try{let c=null,h=null;this.flowType==="pkce"&&([c,h]=await mn(this.storage,this.storageKey));const m=await ue(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in a?{provider_id:a.providerId}:null),"domain"in a?{domain:a.domain}:null),{redirect_to:(s=(r=a.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((o=a?.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:a.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:h}),headers:this.headers,xform:oS});return this._returnResult(m)}catch(c){if(ne(c))return this._returnResult({data:null,error:c});throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async a=>{const{data:{session:r},error:s}=a;if(s)throw s;if(!r)throw new Ft;const{error:o}=await ue(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:o})})}catch(a){if(ne(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async resend(a){try{const r=`${this.url}/resend`;if("email"in a){const{email:s,type:o,options:c}=a,{error:h}=await ue(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:o,gotrue_meta_security:{captcha_token:c?.captchaToken}},redirectTo:c?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}else if("phone"in a){const{phone:s,type:o,options:c}=a,{data:h,error:m}=await ue(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:o,gotrue_meta_security:{captcha_token:c?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:h?.message_id},error:m})}throw new pl("You must provide either an email or phone number and a type")}catch(r){if(ne(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(a,r){this._debug("#_acquireLock","begin",a);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,a,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(a){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await a(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let a=null;const r=await xr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?a=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!a)return{data:{session:null},error:null};const s=a.expires_at?a.expires_at*1e3-Date.now()<uu:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",a.expires_at),!s){if(this.userStorage){const h=await xr(this.userStorage,this.storageKey+"-user");h?.user?a.user=h.user:a.user=fu()}if(this.storage.isServer&&a.user&&!a.user.__isUserNotAvailableProxy){const h={value:this.suppressGetSessionWarning};a.user=nS(a.user,h),h.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:a},error:null}}const{data:o,error:c}=await this._callRefreshToken(a.refresh_token);return c?this._returnResult({data:{session:null},error:c}):this._returnResult({data:{session:o},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(a){return a?await this._getUser(a):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(a){try{return a?await ue(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:a,xform:Xa}):await this._useSession(async r=>{var s,o,c;const{data:h,error:m}=r;if(m)throw m;return!(!((s=h.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ft}:await ue(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(c=(o=h.session)===null||o===void 0?void 0:o.access_token)!==null&&c!==void 0?c:void 0,xform:Xa})})}catch(r){if(ne(r))return zw(r)&&(await this._removeSession(),await Ja(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(a,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(a,r))}async _updateUser(a,r={}){try{return await this._useSession(async s=>{const{data:o,error:c}=s;if(c)throw c;if(!o.session)throw new Ft;const h=o.session;let m=null,p=null;this.flowType==="pkce"&&a.email!=null&&([m,p]=await mn(this.storage,this.storageKey));const{data:g,error:v}=await ue(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},a),{code_challenge:m,code_challenge_method:p}),jwt:h.access_token,xform:Xa});if(v)throw v;return h.user=g.user,await this._saveSession(h),await this._notifyAllSubscribers("USER_UPDATED",h),this._returnResult({data:{user:h.user},error:null})})}catch(s){if(ne(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(a))}async _setSession(a){try{if(!a.access_token||!a.refresh_token)throw new Ft;const r=Date.now()/1e3;let s=r,o=!0,c=null;const{payload:h}=hu(a.access_token);if(h.exp&&(s=h.exp,o=s<=r),o){const{data:m,error:p}=await this._callRefreshToken(a.refresh_token);if(p)return this._returnResult({data:{user:null,session:null},error:p});if(!m)return{data:{user:null,session:null},error:null};c=m}else{const{data:m,error:p}=await this._getUser(a.access_token);if(p)throw p;c={access_token:a.access_token,refresh_token:a.refresh_token,user:m.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(c),await this._notifyAllSubscribers("SIGNED_IN",c)}return this._returnResult({data:{user:c.user,session:c},error:null})}catch(r){if(ne(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(a))}async _refreshSession(a){try{return await this._useSession(async r=>{var s;if(!a){const{data:h,error:m}=r;if(m)throw m;a=(s=h.session)!==null&&s!==void 0?s:void 0}if(!a?.refresh_token)throw new Ft;const{data:o,error:c}=await this._callRefreshToken(a.refresh_token);return c?this._returnResult({data:{user:null,session:null},error:c}):o?this._returnResult({data:{user:o.user,session:o},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(ne(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(a,r){try{if(!ut())throw new gl("No browser detected.");if(a.error||a.error_description||a.error_code)throw new gl(a.error_description||"Error in URL with unspecified error_description",{error:a.error||"unspecified_error",code:a.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new $p("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new gl("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!a.code)throw new $p("No code detected.");const{data:k,error:O}=await this._exchangeCodeForSession(a.code);if(O)throw O;const H=new URL(window.location.href);return H.searchParams.delete("code"),window.history.replaceState(window.history.state,"",H.toString()),{data:{session:k.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:o,access_token:c,refresh_token:h,expires_in:m,expires_at:p,token_type:g}=a;if(!c||!m||!h||!g)throw new gl("No session defined in URL");const v=Math.round(Date.now()/1e3),b=parseInt(m);let x=v+b;p&&(x=parseInt(p));const _=x-v;_*1e3<=bn&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${_}s, should have been closer to ${b}s`);const C=x-b;v-C>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",C,x,v):v-C<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",C,x,v);const{data:j,error:A}=await this._getUser(c);if(A)throw A;const R={provider_token:s,provider_refresh_token:o,access_token:c,expires_in:b,expires_at:x,refresh_token:h,token_type:g,user:j.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:R,redirectType:a.type},error:null})}catch(s){if(ne(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(a){return!!(a.access_token||a.error_description)}async _isPKCECallback(a){const r=await xr(this.storage,`${this.storageKey}-code-verifier`);return!!(a.code&&r)}async signOut(a={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(a))}async _signOut({scope:a}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:o,error:c}=r;if(c)return this._returnResult({error:c});const h=(s=o.session)===null||s===void 0?void 0:s.access_token;if(h){const{error:m}=await this.admin.signOut(h,a);if(m&&!(Uw(m)&&(m.status===404||m.status===401||m.status===403)))return this._returnResult({error:m})}return a!=="others"&&(await this._removeSession(),await Ja(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(a){const r=Fw(),s={id:r,callback:a,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(a){return await this._useSession(async r=>{var s,o;try{const{data:{session:c},error:h}=r;if(h)throw h;await((s=this.stateChangeEmitters.get(a))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",c)),this._debug("INITIAL_SESSION","callback id",a,"session",c)}catch(c){await((o=this.stateChangeEmitters.get(a))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",a,"error",c),console.error(c)}})}async resetPasswordForEmail(a,r={}){let s=null,o=null;this.flowType==="pkce"&&([s,o]=await mn(this.storage,this.storageKey,!0));try{return await ue(this.fetch,"POST",`${this.url}/recover`,{body:{email:a,code_challenge:s,code_challenge_method:o,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(c){if(ne(c))return this._returnResult({data:null,error:c});throw c}}async getUserIdentities(){var a;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(a=r.user.identities)!==null&&a!==void 0?a:[]},error:null})}catch(r){if(ne(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(a){return"token"in a?this.linkIdentityIdToken(a):this.linkIdentityOAuth(a)}async linkIdentityOAuth(a){var r;try{const{data:s,error:o}=await this._useSession(async c=>{var h,m,p,g,v;const{data:b,error:x}=c;if(x)throw x;const _=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,a.provider,{redirectTo:(h=a.options)===null||h===void 0?void 0:h.redirectTo,scopes:(m=a.options)===null||m===void 0?void 0:m.scopes,queryParams:(p=a.options)===null||p===void 0?void 0:p.queryParams,skipBrowserRedirect:!0});return await ue(this.fetch,"GET",_,{headers:this.headers,jwt:(v=(g=b.session)===null||g===void 0?void 0:g.access_token)!==null&&v!==void 0?v:void 0})});if(o)throw o;return ut()&&!(!((r=a.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s?.url),this._returnResult({data:{provider:a.provider,url:s?.url},error:null})}catch(s){if(ne(s))return this._returnResult({data:{provider:a.provider,url:null},error:s});throw s}}async linkIdentityIdToken(a){return await this._useSession(async r=>{var s;try{const{error:o,data:{session:c}}=r;if(o)throw o;const{options:h,provider:m,token:p,access_token:g,nonce:v}=a,b=await ue(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=c?.access_token)!==null&&s!==void 0?s:void 0,body:{provider:m,id_token:p,access_token:g,nonce:v,link_identity:!0,gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:Gt}),{data:x,error:_}=b;return _?this._returnResult({data:{user:null,session:null},error:_}):!x||!x.session||!x.user?this._returnResult({data:{user:null,session:null},error:new fn}):(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("USER_UPDATED",x.session)),this._returnResult({data:x,error:_}))}catch(o){if(ne(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}})}async unlinkIdentity(a){try{return await this._useSession(async r=>{var s,o;const{data:c,error:h}=r;if(h)throw h;return await ue(this.fetch,"DELETE",`${this.url}/user/identities/${a.identity_id}`,{headers:this.headers,jwt:(o=(s=c.session)===null||s===void 0?void 0:s.access_token)!==null&&o!==void 0?o:void 0})})}catch(r){if(ne(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(a){const r=`#_refreshAccessToken(${a.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await Qw(async o=>(o>0&&await Yw(200*Math.pow(2,o-1)),this._debug(r,"refreshing attempt",o),await ue(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:a},headers:this.headers,xform:Gt})),(o,c)=>{const h=200*Math.pow(2,o);return c&&du(c)&&Date.now()+h-s<bn})}catch(s){if(this._debug(r,"error",s),ne(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(r,"end")}}_isValidSession(a){return typeof a=="object"&&a!==null&&"access_token"in a&&"refresh_token"in a&&"expires_at"in a}async _handleProviderSignIn(a,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,a,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",a,"options",r,"url",s),ut()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:a,url:s},error:null}}async _recoverAndRefresh(){var a,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const o=await xr(this.storage,this.storageKey);if(o&&this.userStorage){let h=await xr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!h&&(h={user:o.user},await xn(this.userStorage,this.storageKey+"-user",h)),o.user=(a=h?.user)!==null&&a!==void 0?a:fu()}else if(o&&!o.user&&!o.user){const h=await xr(this.storage,this.storageKey+"-user");h&&h?.user?(o.user=h.user,await Ja(this.storage,this.storageKey+"-user"),await xn(this.storage,this.storageKey,o)):o.user=fu()}if(this._debug(s,"session from storage",o),!this._isValidSession(o)){this._debug(s,"session is not valid"),o!==null&&await this._removeSession();return}const c=((r=o.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<uu;if(this._debug(s,`session has${c?"":" not"} expired with margin of ${uu}s`),c){if(this.autoRefreshToken&&o.refresh_token){const{error:h}=await this._callRefreshToken(o.refresh_token);h&&(console.error(h),du(h)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",h),await this._removeSession()))}}else if(o.user&&o.user.__isUserNotAvailableProxy===!0)try{const{data:h,error:m}=await this._getUser(o.access_token);!m&&h?.user?(o.user=h.user,await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(h){console.error("Error getting user data:",h),this._debug(s,"error getting user data, skipping SIGNED_IN notification",h)}else await this._notifyAllSubscribers("SIGNED_IN",o)}catch(o){this._debug(s,"error",o),console.error(o);return}finally{this._debug(s,"end")}}async _callRefreshToken(a){var r,s;if(!a)throw new Ft;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${a.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new Dl;const{data:c,error:h}=await this._refreshAccessToken(a);if(h)throw h;if(!c.session)throw new Ft;await this._saveSession(c.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",c.session);const m={data:c.session,error:null};return this.refreshingDeferred.resolve(m),m}catch(c){if(this._debug(o,"error",c),ne(c)){const h={data:null,error:c};return du(c)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(h),h}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(c),c}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(a,r,s=!0){const o=`#_notifyAllSubscribers(${a})`;this._debug(o,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:a,session:r});const c=[],h=Array.from(this.stateChangeEmitters.values()).map(async m=>{try{await m.callback(a,r)}catch(p){c.push(p)}});if(await Promise.all(h),c.length>0){for(let m=0;m<c.length;m+=1)console.error(c[m]);throw c[0]}}finally{this._debug(o,"end")}}async _saveSession(a){this._debug("#_saveSession()",a),this.suppressGetSessionWarning=!0;const r=Object.assign({},a),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await xn(this.userStorage,this.storageKey+"-user",{user:r.user});const o=Object.assign({},r);delete o.user;const c=Ip(o);await xn(this.storage,this.storageKey,c)}else{const o=Ip(r);await xn(this.storage,this.storageKey,o)}}async _removeSession(){this._debug("#_removeSession()"),await Ja(this.storage,this.storageKey),await Ja(this.storage,this.storageKey+"-code-verifier"),await Ja(this.storage,this.storageKey+"-user"),this.userStorage&&await Ja(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const a=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{a&&ut()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",a)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const a=setInterval(()=>this._autoRefreshTokenTick(),bn);this.autoRefreshTicker=a,a&&typeof a=="object"&&typeof a.unref=="function"?a.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(a),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const a=this.autoRefreshTicker;this.autoRefreshTicker=null,a&&clearInterval(a)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const a=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((s.expires_at*1e3-a)/bn);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${bn}ms, refresh threshold is ${Du} ticks`),o<=Du&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(a){if(a.isAcquireTimeout||a instanceof Ny)this._debug("auto refresh token tick lock not available");else throw a}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ut()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(a){console.error("_handleVisibilityChange",a)}}async _onVisibilityChanged(a){const r=`#_onVisibilityChanged(${a})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),a||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(a,r,s){const o=[`provider=${encodeURIComponent(r)}`];if(s?.redirectTo&&o.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&o.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[c,h]=await mn(this.storage,this.storageKey),m=new URLSearchParams({code_challenge:`${encodeURIComponent(c)}`,code_challenge_method:`${encodeURIComponent(h)}`});o.push(m.toString())}if(s?.queryParams){const c=new URLSearchParams(s.queryParams);o.push(c.toString())}return s?.skipBrowserRedirect&&o.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${a}?${o.join("&")}`}async _unenroll(a){try{return await this._useSession(async r=>{var s;const{data:o,error:c}=r;return c?this._returnResult({data:null,error:c}):await ue(this.fetch,"DELETE",`${this.url}/factors/${a.factorId}`,{headers:this.headers,jwt:(s=o?.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(ne(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(a){try{return await this._useSession(async r=>{var s,o;const{data:c,error:h}=r;if(h)return this._returnResult({data:null,error:h});const m=Object.assign({friendly_name:a.friendlyName,factor_type:a.factorType},a.factorType==="phone"?{phone:a.phone}:a.factorType==="totp"?{issuer:a.issuer}:{}),{data:p,error:g}=await ue(this.fetch,"POST",`${this.url}/factors`,{body:m,headers:this.headers,jwt:(s=c?.session)===null||s===void 0?void 0:s.access_token});return g?this._returnResult({data:null,error:g}):(a.factorType==="totp"&&p.type==="totp"&&(!((o=p?.totp)===null||o===void 0)&&o.qr_code)&&(p.totp.qr_code=`data:image/svg+xml;utf-8,${p.totp.qr_code}`),this._returnResult({data:p,error:null}))})}catch(r){if(ne(r))return this._returnResult({data:null,error:r});throw r}}async _verify(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:o,error:c}=r;if(c)return this._returnResult({data:null,error:c});const h=Object.assign({challenge_id:a.challengeId},"webauthn"in a?{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_response:a.webauthn.type==="create"?CS(a.webauthn.credential_response):jS(a.webauthn.credential_response)})}:{code:a.code}),{data:m,error:p}=await ue(this.fetch,"POST",`${this.url}/factors/${a.factorId}/verify`,{body:h,headers:this.headers,jwt:(s=o?.session)===null||s===void 0?void 0:s.access_token});return p?this._returnResult({data:null,error:p}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+m.expires_in},m)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",m),this._returnResult({data:m,error:p}))})}catch(r){if(ne(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:o,error:c}=r;if(c)return this._returnResult({data:null,error:c});const h=await ue(this.fetch,"POST",`${this.url}/factors/${a.factorId}/challenge`,{body:a,headers:this.headers,jwt:(s=o?.session)===null||s===void 0?void 0:s.access_token});if(h.error)return h;const{data:m}=h;if(m.type!=="webauthn")return{data:m,error:null};switch(m.webauthn.type){case"create":return{data:Object.assign(Object.assign({},m),{webauthn:Object.assign(Object.assign({},m.webauthn),{credential_options:Object.assign(Object.assign({},m.webauthn.credential_options),{publicKey:wS(m.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},m),{webauthn:Object.assign(Object.assign({},m.webauthn),{credential_options:Object.assign(Object.assign({},m.webauthn.credential_options),{publicKey:SS(m.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(ne(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(a){const{data:r,error:s}=await this._challenge({factorId:a.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:a.factorId,challengeId:r.id,code:a.code})}async _listFactors(){var a;const{data:{user:r},error:s}=await this.getUser();if(s)return{data:null,error:s};const o={all:[],phone:[],totp:[],webauthn:[]};for(const c of(a=r?.factors)!==null&&a!==void 0?a:[])o.all.push(c),c.status==="verified"&&o[c.factor_type].push(c);return{data:o,error:null}}async _getAuthenticatorAssuranceLevel(){var a,r;const{data:{session:s},error:o}=await this.getSession();if(o)return this._returnResult({data:null,error:o});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:c}=hu(s.access_token);let h=null;c.aal&&(h=c.aal);let m=h;((r=(a=s.user.factors)===null||a===void 0?void 0:a.filter(v=>v.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(m="aal2");const g=c.amr||[];return{data:{currentLevel:h,nextLevel:m,currentAuthenticationMethods:g},error:null}}async _getAuthorizationDetails(a){try{return await this._useSession(async r=>{const{data:{session:s},error:o}=r;return o?this._returnResult({data:null,error:o}):s?await ue(this.fetch,"GET",`${this.url}/oauth/authorizations/${a}`,{headers:this.headers,jwt:s.access_token,xform:c=>({data:c,error:null})}):this._returnResult({data:null,error:new Ft})})}catch(r){if(ne(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(a,r){try{return await this._useSession(async s=>{const{data:{session:o},error:c}=s;if(c)return this._returnResult({data:null,error:c});if(!o)return this._returnResult({data:null,error:new Ft});const h=await ue(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:o.access_token,body:{action:"approve"},xform:m=>({data:m,error:null})});return h.data&&h.data.redirect_url&&ut()&&!r?.skipBrowserRedirect&&window.location.assign(h.data.redirect_url),h})}catch(s){if(ne(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(a,r){try{return await this._useSession(async s=>{const{data:{session:o},error:c}=s;if(c)return this._returnResult({data:null,error:c});if(!o)return this._returnResult({data:null,error:new Ft});const h=await ue(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:o.access_token,body:{action:"deny"},xform:m=>({data:m,error:null})});return h.data&&h.data.redirect_url&&ut()&&!r?.skipBrowserRedirect&&window.location.assign(h.data.redirect_url),h})}catch(s){if(ne(s))return this._returnResult({data:null,error:s});throw s}}async fetchJwk(a,r={keys:[]}){let s=r.keys.find(m=>m.kid===a);if(s)return s;const o=Date.now();if(s=this.jwks.keys.find(m=>m.kid===a),s&&this.jwks_cached_at+Dw>o)return s;const{data:c,error:h}=await ue(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(h)throw h;return!c.keys||c.keys.length===0||(this.jwks=c,this.jwks_cached_at=o,s=c.keys.find(m=>m.kid===a),!s)?null:s}async getClaims(a,r={}){try{let s=a;if(!s){const{data:_,error:C}=await this.getSession();if(C||!_.session)return this._returnResult({data:null,error:C});s=_.session.access_token}const{header:o,payload:c,signature:h,raw:{header:m,payload:p}}=hu(s);r?.allowExpired||tS(c.exp);const g=!o.alg||o.alg.startsWith("HS")||!o.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(o.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!g){const{error:_}=await this.getUser(s);if(_)throw _;return{data:{claims:c,header:o,signature:h},error:null}}const v=aS(o.alg),b=await crypto.subtle.importKey("jwk",g,v,!0,["verify"]);if(!await crypto.subtle.verify(v,b,h,Hw(`${m}.${p}`)))throw new zu("Invalid JWT signature");return{data:{claims:c,header:o,signature:h},error:null}}catch(s){if(ne(s))return this._returnResult({data:null,error:s});throw s}}}zs.nextInstanceID={};const MS=zs;class US extends MS{constructor(a){super(a)}}class zS{constructor(a,r,s){var o,c,h;this.supabaseUrl=a,this.supabaseKey=r;const m=Ew(a);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",m),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",m),this.storageUrl=new URL("storage/v1",m),this.functionsUrl=new URL("functions/v1",m);const p=`sb-${m.hostname.split(".")[0]}-auth-token`,g={db:xw,realtime:ww,auth:Object.assign(Object.assign({},_w),{storageKey:p}),global:bw},v=Nw(s??{},g);this.storageKey=(o=v.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(c=v.global.headers)!==null&&c!==void 0?c:{},v.accessToken?(this.accessToken=v.accessToken,this.auth=new Proxy({},{get:(b,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((h=v.auth)!==null&&h!==void 0?h:{},this.headers,v.global.fetch),this.fetch=jw(r,this._getAccessToken.bind(this),v.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},v.realtime)),this.rest=new R_(new URL("rest/v1",m).href,{headers:this.headers,schema:v.db.schema,fetch:this.fetch}),this.storage=new gw(this.storageUrl.href,this.headers,this.fetch,s?.storage),v.accessToken||this._listenForAuthEvents()}get functions(){return new j_(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(a){return this.rest.from(a)}schema(a){return this.rest.schema(a)}rpc(a,r={},s={head:!1,get:!1,count:void 0}){return this.rest.rpc(a,r,s)}channel(a,r={config:{}}){return this.realtime.channel(a,r)}getChannels(){return this.realtime.getChannels()}removeChannel(a){return this.realtime.removeChannel(a)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var a,r;if(this.accessToken)return await this.accessToken();const{data:s}=await this.auth.getSession();return(r=(a=s.session)===null||a===void 0?void 0:a.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:a,persistSession:r,detectSessionInUrl:s,storage:o,userStorage:c,storageKey:h,flowType:m,lock:p,debug:g,throwOnError:v},b,x){const _={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new US({url:this.authUrl.href,headers:Object.assign(Object.assign({},_),b),storageKey:h,autoRefreshToken:a,persistSession:r,detectSessionInUrl:s,storage:o,userStorage:c,flowType:m,lock:p,debug:g,throwOnError:v,fetch:x,hasCustomAuthorizationHeader:Object.keys(this.headers).some(C=>C.toLowerCase()==="authorization")})}_initRealtimeClient(a){return new I_(this.realtimeUrl.href,Object.assign(Object.assign({},a),{params:Object.assign({apikey:this.supabaseKey},a?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,s)=>{this._handleTokenChanged(r,"CLIENT",s?.access_token)})}_handleTokenChanged(a,r,s){(a==="TOKEN_REFRESHED"||a==="SIGNED_IN")&&this.changedAccessToken!==s?(this.changedAccessToken=s,this.realtime.setAuth(s)):a==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const LS=(i,a,r)=>new zS(i,a,r);function BS(){if(typeof window<"u"||typeof process>"u")return!1;const i=process.version;if(i==null)return!1;const a=i.match(/^v(\d+)\./);return a?parseInt(a[1],10)<=18:!1}BS()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const qS=!0,PS="https://xtdudfccgbdanmmncwhn.supabase.co",$S="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh0ZHVkZmNjZ2JkYW5tbW5jd2huIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAxMDAzMjAsImV4cCI6MjA3NTY3NjMyMH0.y1lsJh-kNWyLxXAdkMZbRoHUAVTdHq17SbXq-llrT2g",W=LS(PS,$S,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}}),Ty=Object.freeze(Object.defineProperty({__proto__:null,isSupabaseConfigured:qS,supabase:W},Symbol.toStringTag,{value:"Module"})),HS=()=>{S.useEffect(()=>{const i=async(r,s)=>{if(r==="SIGNED_IN"&&s?.user){const o=s.user,c=new URLSearchParams(window.location.search),h=c.get("invited_to_campaign"),m=c.get("role"),p=h||o.user_metadata?.campaign_id,g=m||o.user_metadata?.role;if(p&&g)try{const{error:v}=await W.from("campaign_members").insert({campaign_id:p,user_id:o.id,is_admin:g==="admin",is_gm:g==="gm",is_player:g==="player"});if(!v){const b=window.location.pathname;window.history.replaceState({},"",b)}}catch{}}},{data:{subscription:a}}=W.auth.onAuthStateChange(i);return()=>{a.unsubscribe()}},[])};function Te({variant:i="default",size:a="md",className:r="",children:s,...o}){const c={default:"bg-side text-text-main hover:bg-hud-accent border border-border",primary:"bg-primary text-white hover:brightness-110 shadow-lg shadow-primary/20",secondary:"bg-hud-accent text-text-main hover:bg-side border border-border",outline:"border-2 border-primary/20 bg-transparent text-primary hover:bg-primary/5",danger:"bg-red-600 hover:bg-red-700 hover:shadow-lg hover:-translate-y-0.5 text-white border-red-600",ghost:"bg-transparent hover:bg-hud-accent text-muted",premium:"btn-premium"},h={sm:"px-2 py-1 text-sm",md:"",full:"w-full justify-center"},m=`
    inline-flex items-center gap-2 rounded-xl px-4 py-2 transition-all duration-300
    active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed font-bold
    ${c[i]}
    ${h[a]}
    ${r}
  `.trim();return d.jsx("button",{className:m,...o,children:s})}function VS({icon:i,variant:a="default",className:r="",...s}){const o={default:"btn p-2 hover:scale-110 transition-all duration-200",danger:"btn p-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 hover:scale-110 transition-all duration-200"};return d.jsx("button",{className:`${o[a]} ${r}`,...s,children:i})}const pu=`
  w-full px-4 py-2.5 
  bg-hud-accent 
  border border-border rounded-2xl 
  text-sm font-bold tracking-tight transition-all duration-300
  text-text-main
  placeholder:text-muted placeholder:font-normal
  focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary focus:bg-surface-mid
  disabled:opacity-30 disabled:cursor-not-allowed
`,oe=S.forwardRef(({label:i,type:a="text",className:r,required:s=!1,error:o,id:c,...h},m)=>{const p=()=>{const g=o?"border-red-500/50 focus:ring-red-500/20":"";if(a==="textarea"){const b=h;return d.jsx("textarea",{id:c,ref:m,className:`${pu} ${g} ${r||""}`,required:s,...b})}if(a==="select"){const{children:b,...x}=h;return d.jsx("select",{id:c,ref:m,className:`${pu} ${g} ${r||""}`,required:s,...x,children:b})}const v=h;return d.jsx("input",{id:c,ref:m,type:a,step:a==="number"?"any":void 0,className:`${pu} ${g} ${r||""}`,required:s,...v})};return d.jsxs("div",{className:"space-y-1.5 min-w-0",children:[i&&d.jsxs("label",{htmlFor:c,className:"block text-[10px] font-black uppercase tracking-[0.2em] text-muted ml-1",children:[i," ",s&&d.jsx("span",{className:"text-primary",children:"*"})]}),d.jsxs("div",{className:"relative group",children:[p(),d.jsx("div",{className:"absolute inset-0 rounded-2xl pointer-events-none border border-primary/0 group-focus-within:border-primary/20 transition-all duration-300 ring-4 ring-primary/0 group-focus-within:ring-primary/5"})]}),o&&d.jsx("p",{className:"text-[10px] font-black text-red-500 uppercase tracking-widest ml-1 animate-pulse",children:o})]})});oe.displayName="FormField";function FS(){const[i,a]=S.useState("sign_in"),[r,s]=S.useState(""),[o,c]=S.useState(""),[h,m]=S.useState(!1),[p,g]=S.useState(""),{signIn:v,signUp:b}=Za(),x=async C=>{C.preventDefault(),m(!0),g("");try{let j;i==="sign_up"?(j=await b(r,o),j.success?g("Check your email for the confirmation link!"):g(j.error||"Sign up failed")):(j=await v(r,o),j.success||g(j.error||"Sign in failed"))}catch(j){g(j instanceof Error?j.message:"An error occurred")}finally{m(!1)}},_=()=>h?"Loading...":i==="sign_in"?"Sign In":"Sign Up";return d.jsxs("div",{className:"min-h-screen bg-main transition-colors duration-500 selection:bg-primary/30",children:[d.jsx("div",{className:"bg-side border-b border-border px-4 py-8 shadow-sm",children:d.jsxs("div",{className:"max-w-7xl mx-auto text-center md:text-left",children:[d.jsx("h1",{className:"text-3xl font-black tracking-tighter uppercase text-text-main",children:"Traveller Dashboard"}),d.jsx("p",{className:"text-sm text-muted font-medium max-w-lg",children:"The ultimate multi-user campaign management system for your stellar operations."})]})}),d.jsx("div",{className:"flex items-center justify-center py-16 px-4 sm:px-6 lg:px-8",children:d.jsxs("div",{className:"max-w-md w-full space-y-8 animate-in",children:[d.jsxs("div",{className:"text-center space-y-2",children:[d.jsx("h2",{className:"text-4xl font-black tracking-tighter uppercase text-text-main",children:i==="sign_in"?"WELCOME BACK":"JOIN THE CREW"}),d.jsx("p",{className:"text-muted font-medium italic",children:i==="sign_in"?"Authorization required to access campaign logs.":"Register your subspace frequency to begin."})]}),d.jsxs("div",{className:"card-modern shadow-2xl",children:[d.jsxs("div",{className:"flex p-1.5 bg-hud-accent backdrop-blur-sm rounded-2xl mb-8 border border-border shadow-inner",children:[d.jsx("button",{type:"button",onClick:()=>a("sign_in"),className:`flex-1 py-2.5 px-4 text-sm font-bold rounded-xl transition-all duration-300 ${i==="sign_in"?"bg-side shadow-md text-primary scale-[1.02] border border-border":"text-muted hover:text-text-main"}`,children:"SIGN IN"}),d.jsx("button",{type:"button",onClick:()=>a("sign_up"),className:`flex-1 py-2.5 px-4 text-sm font-bold rounded-xl transition-all duration-300 ${i==="sign_up"?"bg-side shadow-md text-primary scale-[1.02] border border-border":"text-muted hover:text-text-main"}`,children:"SIGN UP"})]}),d.jsxs("form",{className:"space-y-6",onSubmit:x,children:[d.jsx(oe,{label:"Subspace Email",type:"email",autoComplete:"email",required:!0,value:r,onChange:C=>s(C.target.value),placeholder:"commander@imperium.org"}),d.jsx(oe,{label:"Security Key",type:"password",autoComplete:i==="sign_up"?"new-password":"current-password",required:!0,value:o,onChange:C=>c(C.target.value),placeholder:""}),p&&d.jsx("div",{className:`p-4 rounded-xl text-xs font-bold border transition-all animate-in uppercase tracking-widest ${p.toLowerCase().includes("error")||p.toLowerCase().includes("failed")?"bg-red-500/10 border-red-500/20 text-red-500":"bg-green-500/10 border-green-500/20 text-green-500"}`,children:p}),d.jsx(Te,{type:"submit",disabled:h,variant:"primary",className:"btn-premium w-full py-4 text-xs tracking-widest uppercase font-black",children:_().toUpperCase()})]})]})]})})]})}const GS=i=>{const a=[];let r="weak";i.length<8&&a.push("Password must be at least 8 characters long");const s=/[a-z]/.test(i),o=/[A-Z]/.test(i),c=/\d/.test(i),h=/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]/.test(i);s||a.push("Password must contain at least one lowercase letter"),o||a.push("Password must contain at least one uppercase letter"),c||a.push("Password must contain at least one number"),h||a.push("Password must contain at least one special character");const m=[s,o,c,h].filter(Boolean).length;let p=0;i.length>=12?p=2:i.length>=8&&(p=1);const g=m+p;return g>=5?r="strong":g>=3&&(r="medium"),{isValid:a.length===0,errors:a,strength:r}},IS=i=>{switch(i){case"weak":return"text-red-600 dark:text-red-400";case"medium":return"text-yellow-600 dark:text-yellow-400";case"strong":return"text-green-600 dark:text-green-400"}},YS=i=>{switch(i){case"weak":return"Weak";case"medium":return"Medium";case"strong":return"Strong"}},QS=i=>i.length<3?{isValid:!1,error:"Username must be at least 3 characters long"}:i.length>30?{isValid:!1,error:"Username must be less than 30 characters long"}:/^[a-zA-Z0-9_-]+$/.test(i)?/^[_-]|[_-]$/.test(i)?{isValid:!1,error:"Username cannot start or end with hyphens or underscores"}:{isValid:!0}:{isValid:!1,error:"Username can only contain letters, numbers, hyphens, and underscores"};function KS({onComplete:i,loading:a=!1}){const[r,s]=S.useState(""),[o,c]=S.useState(""),[h,m]=S.useState({}),[p,g]=S.useState(!1),v=()=>{const _={};if(r.trim()?r.trim().length<2?_.displayName="Name must be at least 2 characters long":r.trim().length>50&&(_.displayName="Name must be less than 50 characters long"):_.displayName="Name is required",!o.trim())_.username="Username is required";else{const C=QS(o.trim());C.isValid||(_.username=C.error||"Invalid username")}return m(_),Object.keys(_).length===0},b=async _=>{if(_.preventDefault(),!!v()){g(!0);try{const C=await i({displayName:r.trim(),username:o.trim().toLowerCase()});!C.success&&C.error&&(C.error.toLowerCase().includes("username")?m({username:C.error}):m({general:C.error}))}catch{m({general:"An unexpected error occurred. Please try again."})}finally{g(!1)}}},x=r.trim()&&o.trim()&&Object.keys(h).length===0;return d.jsxs("div",{className:"min-h-screen bg-main transition-colors duration-500",children:[d.jsx("div",{className:"bg-side border-b border-border px-4 py-6",children:d.jsxs("div",{className:"max-w-7xl mx-auto",children:[d.jsx("h1",{className:"text-2xl font-black tracking-tighter uppercase text-text-main",children:"Complete Your Profile"}),d.jsx("p",{className:"text-sm text-muted font-medium",children:"Set up your profile to start using Traveller Dashboard"})]})}),d.jsx("div",{className:"flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:d.jsxs("div",{className:"max-w-md w-full space-y-6",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"mx-auto h-16 w-16 bg-primary/10 rounded-full flex items-center justify-center mb-4",children:d.jsx(Ls,{className:"h-8 w-8 text-primary shadow-[0_0_15px_var(--color-primary-glow)]"})}),d.jsx("h2",{className:"text-3xl font-black tracking-tighter uppercase text-text-main",children:"Welcome to Traveller Dashboard"}),d.jsx("p",{className:"mt-2 text-muted font-medium",children:"Let's set up your profile to get started"})]}),d.jsx("div",{className:"card-modern shadow-xl",children:d.jsxs("form",{className:"space-y-4",onSubmit:b,children:[d.jsxs("div",{children:[d.jsx(oe,{label:"Your Name",type:"text",required:!0,value:r,onChange:_=>{s(_.target.value),h.displayName&&m(C=>({...C,displayName:""}))},placeholder:"Enter your first name or full name",error:h.displayName}),d.jsx("p",{className:"mt-1 text-[10px] font-bold uppercase tracking-widest text-muted italic ml-1",children:"This is how other players will see you in campaigns"})]}),d.jsxs("div",{children:[d.jsx(oe,{label:"Username",type:"text",required:!0,value:o,onChange:_=>{c(_.target.value),h.username&&m(C=>({...C,username:""}))},placeholder:"Choose a unique username",error:h.username}),d.jsx("p",{className:"mt-1 text-[10px] font-bold uppercase tracking-widest text-muted italic ml-1",children:"3-30 characters, letters, numbers, hyphens and underscores only"})]}),h.general&&d.jsx("div",{className:"p-3 rounded-xl text-xs font-bold uppercase tracking-widest bg-red-500/10 text-red-500 border border-red-500/20",children:h.general}),d.jsx(Te,{type:"submit",disabled:!x||p||a,variant:"primary",className:"w-full justify-center py-3",children:p||a?"Setting up...":"Complete Profile"})]})}),d.jsx("div",{className:"text-center text-[10px] font-black uppercase tracking-widest text-muted mt-6",children:d.jsx("p",{children:"You can always change these settings later in your profile"})})]})})]})}const ky=()=>{const[i,a]=S.useState([]),[r,s]=S.useState(!0),[o,c]=S.useState(null),h=Lg(),m=S.useCallback(async()=>{try{s(!0),c(null);const b=await h.getCampaigns();b.success&&b.data?a(b.data):c(b.error||"Failed to fetch campaigns")}catch{c("An unexpected error occurred")}finally{s(!1)}},[h]),p=async b=>{try{c(null);const x=await h.createCampaign(b);return x.success?(await m(),{success:!0}):(c(x.error||"Failed to create campaign"),{success:!1,error:x.error})}catch{const x="An unexpected error occurred";return c(x),{success:!1,error:x}}},g=async(b,x)=>{try{c(null);const _=await h.updateCampaign(b,x);return _.success?(await m(),{success:!0}):(c(_.error||"Failed to update campaign"),{success:!1,error:_.error})}catch{const _="An unexpected error occurred";return c(_),{success:!1,error:_}}},v=async b=>{try{c(null);const x=await h.deleteCampaign(b);return x.success?(await m(),{success:!0}):(c(x.error||"Failed to delete campaign"),{success:!1,error:x.error})}catch{const x="An unexpected error occurred";return c(x),{success:!1,error:x}}};return S.useEffect(()=>{m()},[m]),{campaigns:i,loading:r,error:o,fetchCampaigns:m,createCampaign:p,updateCampaign:g,deleteCampaign:v}};function Ml(){const[i,a]=S.useState([]),[r,s]=S.useState(!1),[o,c]=S.useState(null),h=S.useCallback(async(x,..._)=>{s(!0),c(null);try{const C=await x(..._);if(C.success&&C.data!==void 0)return a(C.data),{success:!0,data:C.data};const j=C.error||"Operation failed";return c(j),{success:!1,error:j}}catch(C){const j=C instanceof Error?C.message:"An unexpected error occurred";return c(j),{success:!1,error:j}}finally{s(!1)}},[]),m=S.useCallback(x=>{a(_=>[..._,x])},[]),p=S.useCallback((x,_)=>{a(C=>C.map((j,A)=>A===x?_:j))},[]),g=S.useCallback(x=>{a(_=>_.filter((C,j)=>j!==x))},[]),v=S.useCallback(()=>{a([]),c(null),s(!1)},[]),b=S.useCallback(()=>{c(null)},[]);return{items:i,loading:r,error:o,execute:h,addItem:m,updateItem:p,removeItem:g,reset:v,clearError:b,setItems:a}}const WS=()=>{const{items:i,loading:a,error:r,execute:s}=Ml(),o=S.useMemo(()=>Lg(),[]),c=S.useCallback(async g=>await s(async b=>{const x=await o.getCampaignMembers(b);return x.success&&x.data?{success:!0,data:x.data}:{success:!1,error:x.error||"Failed to fetch members"}},g),[o,s]),h=S.useCallback(async(g,v,b)=>{try{const x=await o.addMemberByEmail(g,v,b);return x.success?(await c(g),{success:!0}):{success:!1,error:x.error||"Failed to add member"}}catch{return{success:!1,error:"An unexpected error occurred"}}},[o,c]),m=S.useCallback(async(g,v,b)=>{try{const x=await o.updateMemberRole(g,v,b);return x.success?(await c(g),{success:!0}):{success:!1,error:x.error||"Failed to update member role"}}catch{return{success:!1,error:"An unexpected error occurred"}}},[o,c]),p=S.useCallback(async(g,v)=>{try{const b=await o.removeMember(g,v);return b.success?(await c(g),{success:!0}):{success:!1,error:b.error||"Failed to remove member"}}catch{return{success:!1,error:"An unexpected error occurred"}}},[o,c]);return{members:i,loading:a,error:r,fetchMembers:c,addMemberByEmail:h,updateMemberRole:m,removeMember:p}};function JS({size:i="md",className:a=""}){const r={sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"};return d.jsx("div",{className:`animate-spin rounded-full border-b-2 border-blue-600 ${r[i]} ${a}`,role:"status","aria-label":"Loading"})}function XS({message:i="Loading..."}){return d.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen",children:[d.jsx(JS,{size:"lg",className:"mx-auto"}),d.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:i})]})}function rt({isOpen:i,onClose:a,title:r,children:s,maxWidth:o="md"}){if(S.useEffect(()=>(i?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[i]),S.useEffect(()=>{const h=m=>{m.key==="Escape"&&a()};if(i)return document.addEventListener("keydown",h),()=>document.removeEventListener("keydown",h)},[i,a]),!i)return null;const c={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl"};return d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50 animate-in",onClick:h=>{h.target===h.currentTarget&&a()},children:d.jsxs("div",{className:`card-modern w-full shadow-2xl relative overflow-hidden ${c[o]}`,children:[d.jsx("div",{className:"absolute -top-24 -right-24 w-48 h-48 bg-primary/20 blur-3xl rounded-full pointer-events-none"}),d.jsxs("div",{className:"flex justify-between items-center mb-6 relative z-10",children:[d.jsx("h3",{className:"text-xl font-bold tracking-tight",children:r}),d.jsx(VS,{icon:d.jsx(qu,{size:20}),onClick:a,"aria-label":"Close modal",className:"hover:rotate-90 transition-transform duration-300"})]}),d.jsx("div",{className:"relative z-10",children:s})]})})}function _n({onCancel:i,onConfirm:a,confirmText:r="Confirm",cancelText:s="Cancel",confirmVariant:o="primary",confirmDisabled:c=!1,confirmType:h="button",isLoading:m=!1,children:p}){return p?d.jsx("div",{className:"flex gap-2 mt-6",children:p}):d.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mt-8",children:[i&&d.jsx(Te,{onClick:i,variant:"outline",className:"flex-1 justify-center py-2.5",disabled:m,children:s}),(a||h==="submit")&&d.jsx(Te,{onClick:h==="submit"?void 0:a,variant:o==="primary"?"premium":o,className:"flex-1 justify-center py-2.5",disabled:m||c,type:h,children:r})]})}function Zp({roles:i,onChange:a,disabled:r=!1,showError:s=!0}){const o=(m,p)=>{const g={...i,[m]:p};a(g)},c=zg(i),h=i.isGm&&i.isPlayer&&!i.isAdmin;return d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsxs("label",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"checkbox",checked:i.isAdmin,onChange:m=>o("isAdmin",m.target.checked),disabled:r,className:"rounded border-gray-300 dark:border-zinc-600 text-blue-600 focus:ring-blue-500"}),d.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Administrator"}),d.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"(Can manage campaign settings and members)"})]}),d.jsxs("label",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"checkbox",checked:i.isGm,onChange:m=>o("isGm",m.target.checked),disabled:r,className:"rounded border-gray-300 dark:border-zinc-600 text-blue-600 focus:ring-blue-500"}),d.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Game Master (GM)"}),d.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"(Can run game sessions)"})]}),d.jsxs("label",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"checkbox",checked:i.isPlayer,onChange:m=>o("isPlayer",m.target.checked),disabled:r,className:"rounded border-gray-300 dark:border-zinc-600 text-blue-600 focus:ring-blue-500"}),d.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Player"}),d.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"(Can create and play characters)"})]})]}),d.jsx("div",{className:"px-3 py-2 bg-gray-50 dark:bg-zinc-800 rounded-lg",children:d.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Current roles:"," ",d.jsx("span",{className:"font-medium text-gray-900 dark:text-zinc-50",children:kl(i)})]})}),s&&!c&&d.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:d.jsxs("p",{className:"text-sm text-red-600 dark:text-red-400",children:[!i.isAdmin&&!i.isGm&&!i.isPlayer&&"Must select at least one role.",h&&"Cannot be both GM and Player without Administrator privileges. This prevents conflicts of interest."]})})]})}function ZS({campaign:i,onUpdateCampaign:a,onDeleteCampaign:r,onGetMembers:s,onAddMember:o,onUpdateMemberRole:c,onRemoveMember:h,onClose:m}){const[p,g]=S.useState(!1),[v,b]=S.useState(!1),[x,_]=S.useState(!1),[C,j]=S.useState(!1),[A,R]=S.useState([]),[k,O]=S.useState(!1),[H,I]=S.useState(!1),[V,re]=S.useState(null),[G,q]=S.useState(i.name),[K,de]=S.useState(i.description||""),[ce,ie]=S.useState(!1),[F,pe]=S.useState(!1),[L,Y]=S.useState(""),[ae,ee]=S.useState({isAdmin:!1,isGm:!1,isPlayer:!0}),[J,Ae]=S.useState(null),Ne=async ve=>{if(ve.preventDefault(),!!G.trim())try{ie(!0),await a(i.id,{name:G,description:K||null}),g(!1)}finally{ie(!1)}},Q=async()=>{try{pe(!0),await r(i.id),b(!1),m?.()}finally{pe(!1)}},me=async()=>{try{const ve=await s(i.id);ve&&R(ve)}catch{}},et=async()=>{if(A.length>0&&!x){_(!0);return}try{O(!0);const ve=await s(i.id);ve&&R(ve),_(!0)}finally{O(!1)}},ze=async ve=>{if(ve.preventDefault(),!!L.trim()){I(!0),Ae(null);try{const Ie=await o(i.id,L,ae);Ie.success?(Y(""),ee({isAdmin:!1,isGm:!1,isPlayer:!0}),j(!1),me()):Ae(Ie.error||"Failed to add member")}catch(Ie){Ae(Ie instanceof Error?Ie.message:"Failed to add member")}finally{I(!1)}}},[_e,ra]=S.useState(null),[na,jr]=S.useState({isAdmin:!1,isGm:!1,isPlayer:!0}),Ar=async ve=>{if(!_e)return;const Ie=_e.user_id||_e.userId;if(Ie){re(Ie);try{if((await c(i.id,Ie,ve)).success){const Nr=await s(i.id);Nr&&R(Nr),ra(null)}}finally{re(null)}}},On=ve=>{ra(ve),jr(ve.roles)};return d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"card",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-zinc-50 mb-4",children:"Campaign Information"}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Name"}),d.jsx("p",{className:"text-gray-900 dark:text-zinc-50",children:i.name})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:i.description||"No description provided"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Members"}),d.jsxs("p",{className:"text-gray-900 dark:text-zinc-50",children:[i.member_count||0," member(s)"]})]})]})]}),d.jsxs("div",{className:"card",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-zinc-50 mb-4",children:"Quick Actions"}),d.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[d.jsxs(Te,{onClick:()=>g(!0),className:"flex items-center gap-2 justify-center",children:[d.jsx(op,{className:"w-4 h-4"}),"Edit Campaign"]}),d.jsxs(Te,{onClick:et,disabled:k,className:"flex items-center gap-2 justify-center",children:[d.jsx(Bs,{className:"w-4 h-4"}),k?"Loading...":"Manage Members"]})]})]}),d.jsxs("div",{className:"card border-red-200 dark:border-red-800",children:[d.jsx("h3",{className:"text-lg font-semibold text-red-600 dark:text-red-400 mb-4",children:"Danger Zone"}),d.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Permanently delete this campaign and all its data. This action cannot be undone."}),d.jsxs(Te,{onClick:()=>b(!0),variant:"danger",className:"flex items-center gap-2",children:[d.jsx(_u,{className:"w-4 h-4"}),"Delete Campaign"]})]}),d.jsx(rt,{isOpen:p,onClose:()=>g(!1),title:"Edit Campaign",children:d.jsxs("form",{onSubmit:Ne,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Campaign Name"}),d.jsx("input",{type:"text",value:G,onChange:ve=>q(ve.target.value),className:"input w-full",placeholder:"Enter campaign name",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Description (optional)"}),d.jsx("textarea",{value:K,onChange:ve=>de(ve.target.value),className:"input w-full",rows:3,placeholder:"Describe your campaign"})]}),d.jsx(_n,{onCancel:()=>g(!1),cancelText:"Cancel",confirmText:ce?"Updating...":"Update",confirmDisabled:ce||!G.trim(),confirmType:"submit",isLoading:ce})]})}),d.jsxs(rt,{isOpen:v,onClose:()=>b(!1),title:"Delete Campaign",children:[d.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:['Are you sure you want to delete "',i.name,'"? This action cannot be undone and will remove all campaign data and members.']}),d.jsx(_n,{onCancel:()=>b(!1),onConfirm:Q,cancelText:"Cancel",confirmText:F?"Deleting...":"Delete",confirmVariant:"danger",isLoading:F})]}),d.jsx(rt,{isOpen:x,onClose:()=>_(!1),title:"Campaign Members",maxWidth:"lg",children:d.jsxs("div",{className:"space-y-4",children:[A.length===0?d.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"No members found or unable to load members."}):d.jsx("div",{className:"space-y-3",children:A.map(ve=>d.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 dark:border-zinc-700 rounded-lg",children:[d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 dark:text-zinc-50",children:ve.user_profiles?.display_name||ve.displayName||"No Name"}),d.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:ve.user_profiles?.email||ve.email})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"flex flex-wrap gap-1",children:d.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-400",children:kl(ve.roles)})}),d.jsx(Te,{size:"sm",variant:"ghost",onClick:()=>On(ve),disabled:V===ve.user_id,children:d.jsx(op,{className:"w-3 h-3"})}),V===ve.user_id&&d.jsx("span",{className:"text-xs text-gray-500",children:"Updating..."}),!ve.roles.isAdmin&&d.jsx(Te,{size:"sm",variant:"danger",onClick:()=>{const Ie=ve.user_id||ve.userId;Ie&&h(i.id,Ie)},children:d.jsx(_u,{className:"w-3 h-3"})})]})]},ve.id))}),d.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200 dark:border-zinc-700",children:d.jsxs(Te,{variant:"primary",className:"w-full justify-center",onClick:()=>j(!0),children:[d.jsx(Ls,{className:"w-4 h-4"}),"Add Member"]})})]})}),d.jsx(rt,{isOpen:C,onClose:()=>{j(!1),Y(""),ee({isAdmin:!1,isGm:!1,isPlayer:!0}),Ae(null)},title:"Add Campaign Member",children:d.jsxs("form",{onSubmit:ze,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),d.jsx("input",{type:"email",value:L,onChange:ve=>Y(ve.target.value),className:"input w-full",placeholder:"Enter member's email",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Roles"}),d.jsx(Zp,{roles:ae,onChange:ee})]}),J&&d.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:d.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:J})}),d.jsx(_n,{onCancel:()=>{j(!1),Y(""),ee({isAdmin:!1,isGm:!1,isPlayer:!0}),Ae(null)},cancelText:"Cancel",confirmText:H?"Adding...":"Add Member",confirmDisabled:H||!L.trim(),confirmType:"submit",isLoading:H})]})}),_e&&d.jsx(rt,{isOpen:!!_e,onClose:()=>ra(null),title:`Edit Roles - ${_e.user_profiles?.display_name||_e.displayName||_e.user_profiles?.email||_e.email}`,children:d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Member Roles"}),d.jsx(Zp,{roles:na,onChange:jr,disabled:V===_e.user_id})]}),d.jsx(_n,{onCancel:()=>ra(null),cancelText:"Cancel",confirmText:V===_e.user_id?"Updating...":"Update Roles",confirmDisabled:V===_e.user_id,onConfirm:()=>Ar(na),isLoading:V===_e.user_id})]})})]})}function Oy(i){const{items:a,loading:r,error:s,execute:o,setItems:c}=Ml(),h=S.useMemo(()=>Ku(),[]),m=S.useCallback(async v=>{if(!v)return;await o(async x=>{const _=await h.getStandaloneCharacters(x);return _.success&&_.data?{success:!0,data:_.data.map(j=>({id:j.id,campaignId:null,displayName:j.name,playerName:j.playerName||"",characterName:j.characterName||"",ownerId:j.ownerId||""}))}:{success:!1,error:_.error||"Failed to load characters"}},v)},[h,o]),p=S.useCallback(async(v,b,x)=>{try{const _=`${v}  ${b}`,C=await h.createStandaloneCharacter(x,{name:_,playerName:v,characterName:b});if(C.success&&C.data){const j={id:C.data.id,campaignId:null,displayName:C.data.name,playerName:C.data.playerName||v,characterName:C.data.characterName||b,ownerId:C.data.ownerId||""};return c(A=>[j,...A]),{success:!0,data:j}}return{success:!1,error:C.error||"Failed to create character"}}catch{return{success:!1,error:"An error occurred while creating the character"}}},[h,c]),g=S.useCallback(async(v,b)=>{try{const x=await h.deleteStandaloneCharacter(v,b);return x.success?(c(_=>_.filter(C=>C.id!==v)),{success:!0}):{success:!1,error:x.error||"Failed to delete character"}}catch{return{success:!1,error:"An error occurred while deleting the character"}}},[h,c]);return S.useEffect(()=>{i?m(i):c([])},[i,m,c]),{characters:a,loading:r,error:s,createCharacter:p,deleteCharacter:g,refreshCharacters:()=>i&&m(i)}}function eC({isOpen:i,onClose:a,campaigns:r,onAssignmentComplete:s}){const{user:o}=Za(),{characters:c,loading:h,error:m,refreshCharacters:p}=Oy(o?.id),[g,v]=S.useState([]),[b,x]=S.useState(null),_=S.useMemo(()=>r.filter(R=>R.userRoles.isAdmin||R.userRoles.isPlayer),[r]),C=async(R,k)=>{if(o){x(null),v(O=>[...O.filter(H=>H.characterId!==R),{characterId:R,campaignId:k,loading:!0}]);try{const H=await Ku().assignCharacterToCampaign(R,k,o.id);H.success?(await p(),v(I=>I.filter(V=>V.characterId!==R)),s?.()):(x(H.error||"Failed to assign character to campaign"),v(I=>I.filter(V=>V.characterId!==R)))}catch{x("An unexpected error occurred while assigning character"),v(O=>O.filter(H=>H.characterId!==R))}}},j=R=>g.some(k=>k.characterId===R&&k.loading),A=R=>g.find(k=>k.characterId===R)?.campaignId;return h?d.jsx(rt,{isOpen:i,onClose:a,title:"Assign Characters to Campaigns",children:d.jsxs("div",{className:"animate-pulse space-y-4",children:[d.jsx("div",{className:"h-4 bg-gray-200 dark:bg-zinc-700 rounded w-3/4"}),d.jsx("div",{className:"h-4 bg-gray-200 dark:bg-zinc-700 rounded w-1/2"}),d.jsx("div",{className:"h-4 bg-gray-200 dark:bg-zinc-700 rounded w-2/3"})]})}):m?d.jsx(rt,{isOpen:i,onClose:a,title:"Assign Characters to Campaigns",children:d.jsxs("div",{className:"text-red-600 dark:text-red-400 text-center py-8",children:[d.jsxs("p",{children:["Error loading characters: ",m]}),d.jsx(Te,{onClick:p,variant:"primary",className:"mt-4",children:"Retry"})]})}):c.length===0?d.jsx(rt,{isOpen:i,onClose:a,title:"Assign Characters to Campaigns",children:d.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[d.jsx(Bs,{className:"w-12 h-12 mx-auto mb-4 text-gray-300 dark:text-gray-600"}),d.jsx("p",{className:"text-lg font-medium mb-2",children:"No Standalone Characters"}),d.jsx("p",{className:"text-sm",children:"You don't have any standalone characters to assign to campaigns."}),d.jsx("p",{className:"text-sm mt-1",children:"Create some characters first, then come back to assign them!"})]})}):_.length===0?d.jsx(rt,{isOpen:i,onClose:a,title:"Assign Characters to Campaigns",children:d.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[d.jsx(Ls,{className:"w-12 h-12 mx-auto mb-4 text-gray-300 dark:text-gray-600"}),d.jsx("p",{className:"text-lg font-medium mb-2",children:"No Available Campaigns"}),d.jsx("p",{className:"text-sm",children:"You're not a member of any campaigns where you can add characters."}),d.jsx("p",{className:"text-sm mt-1",children:"Join a campaign as a player or create your own to assign characters!"})]})}):d.jsx(rt,{isOpen:i,onClose:a,title:"Assign Characters to Campaigns",maxWidth:"lg",children:d.jsxs("div",{className:"space-y-6",children:[d.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Assign your standalone characters to campaigns where you're a member. Once assigned, characters will appear in the campaign's character list."}),b&&d.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:d.jsx("p",{className:"text-red-600 dark:text-red-400 text-sm",children:b})}),d.jsx("div",{className:"space-y-4",children:c.map(R=>d.jsx("div",{className:"border rounded-lg p-4 bg-white dark:bg-zinc-800 dark:border-zinc-700",children:d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"flex-1",children:[d.jsx("h4",{className:"font-medium text-gray-900 dark:text-zinc-50 mb-1",children:R.displayName}),d.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:R.playerName&&R.characterName&&d.jsxs(d.Fragment,{children:["Player: ",R.playerName,"  Character:"," ",R.characterName]})})]}),d.jsx("div",{className:"flex-shrink-0 ml-4",children:j(R.id)?d.jsxs("div",{className:"flex items-center text-sm text-blue-600 dark:text-blue-400",children:[d.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full mr-2"}),"Assigning..."]}):d.jsxs("select",{className:"text-sm border rounded px-3 py-2 bg-white dark:bg-zinc-700 dark:border-zinc-600 dark:text-zinc-50",value:A(R.id)||"",onChange:k=>{k.target.value&&C(R.id,k.target.value)},children:[d.jsx("option",{value:"",children:"Select Campaign..."}),_.map(k=>d.jsxs("option",{value:k.id,children:[k.name," (",k.userRoles.isAdmin?"Admin":"Player",")"]},k.id))]})})]})},R.id))}),d.jsx("div",{className:"border-t pt-4",children:d.jsx(Te,{onClick:a,className:"w-full",children:"Done"})})]})})}function tC({characters:i,currentUserId:a,onDeleteCharacter:r}){return i.length===0?d.jsxs("div",{className:"text-center py-6 text-gray-500 dark:text-gray-400",children:[d.jsx(Bs,{className:"w-8 h-8 mx-auto mb-2 text-gray-300 dark:text-gray-600"}),d.jsx("p",{children:"No standalone characters yet."}),d.jsx("p",{className:"text-sm mt-1",children:"Create your first character to get started!"})]}):d.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:i.map(s=>d.jsxs("div",{className:"border rounded-lg p-4 bg-white dark:bg-zinc-800 dark:border-zinc-700",children:[d.jsxs("div",{className:"flex justify-between items-start mb-2",children:[d.jsx("h4",{className:"font-medium text-gray-900 dark:text-zinc-50 truncate",children:s.displayName}),s.ownerId===a&&d.jsx(Te,{onClick:()=>r(s.id,s.displayName),variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:text-red-400 dark:hover:text-red-300 dark:hover:bg-red-900/20 p-1 h-auto",title:"Delete character",children:d.jsx(_u,{className:"w-4 h-4"})})]}),d.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-1",children:[d.jsxs("div",{children:[d.jsx("span",{className:"font-medium",children:"Player:"})," ",s.playerName]}),d.jsxs("div",{children:[d.jsx("span",{className:"font-medium",children:"Character:"})," ",s.characterName]}),d.jsx("div",{className:"mt-2 text-xs text-blue-600 dark:text-blue-400",children:"Available for campaign invitations"})]})]},s.id))})}function aC({campaigns:i=[]}){const[a,r]=S.useState(!1),[s,o]=S.useState(""),[c,h]=S.useState(""),[m,p]=S.useState(!1),[g,v]=S.useState(null),[b,x]=S.useState(!1),[_,C]=S.useState(null),[j,A]=S.useState(!1),{user:R}=Za(),{characters:k,loading:O,error:H,createCharacter:I,deleteCharacter:V,refreshCharacters:re}=Oy(R?.id),G=async ie=>{if(ie.preventDefault(),v(null),!R){v("You must be logged in to create a character");return}if(!s.trim()){v("Player name is required");return}if(!c.trim()){v("Character name is required");return}p(!0);try{const F=await I(s.trim(),c.trim(),R.id);F.success?(r(!1),o(""),h(""),v(null)):v(F.error||"Failed to create character")}catch{v("An unexpected error occurred")}finally{p(!1)}},q=(ie,F)=>{C({id:ie,name:F}),x(!0)},K=async()=>{if(_&&R)try{const ie=await V(_.id,R.id);ie.success?(x(!1),C(null)):v(ie.error||"Failed to delete character")}catch{v("An unexpected error occurred while deleting character")}},de=()=>{r(!1),o(""),h(""),v(null)},ce=()=>{r(!0),o(""),h(""),v(null)};return d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-zinc-50",children:"Your Characters"}),d.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Create characters that can be used in any campaign when invited."})]}),d.jsxs("div",{className:"flex gap-3",children:[i.length>0&&d.jsxs(Te,{onClick:()=>A(!0),variant:"ghost",className:"flex items-center gap-2",children:[d.jsx(ub,{className:"w-4 h-4"}),"Assign to Campaigns"]}),d.jsxs(Te,{onClick:ce,className:"flex items-center gap-2",children:[d.jsx(Ls,{className:"w-4 h-4"}),"Create Character"]})]})]}),d.jsxs("div",{className:"card",children:[O&&d.jsx("div",{className:"text-center py-6 text-gray-500 dark:text-gray-400",children:d.jsx("p",{children:"Loading characters..."})}),!O&&H&&d.jsxs("div",{className:"text-center py-6 text-red-600 dark:text-red-400",children:[d.jsxs("p",{children:["Error: ",H]}),d.jsx(Te,{onClick:re,variant:"ghost",size:"sm",className:"mt-2",children:"Try Again"})]}),!O&&!H&&d.jsx(tC,{characters:k,currentUserId:R?.id,onDeleteCharacter:q})]}),d.jsx(rt,{isOpen:a,onClose:de,title:"Create New Character",children:d.jsxs("form",{onSubmit:G,className:"space-y-4",children:[d.jsx(oe,{label:"Player Name",value:s,onChange:ie=>o(ie.target.value),placeholder:"e.g., John Smith",required:!0}),d.jsx(oe,{label:"Character Name",value:c,onChange:ie=>h(ie.target.value),placeholder:"e.g., Lt. Sally Riddle",required:!0}),g&&d.jsx("div",{className:"text-red-600 dark:text-red-400 text-sm",children:g}),d.jsxs("div",{className:"flex gap-3 pt-4",children:[d.jsx(Te,{type:"button",variant:"ghost",onClick:de,disabled:m,children:"Cancel"}),d.jsx(Te,{type:"submit",disabled:m||!s.trim()||!c.trim(),children:m?"Creating...":"Create Character"})]})]})}),d.jsx(rt,{isOpen:b,onClose:()=>x(!1),title:"Delete Character",children:d.jsxs("div",{className:"space-y-4",children:[d.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:['Are you sure you want to delete "',_?.name,'"? This action cannot be undone.']}),d.jsxs("div",{className:"flex gap-3 pt-4",children:[d.jsx(Te,{variant:"ghost",onClick:()=>x(!1),children:"Cancel"}),d.jsx(Te,{variant:"danger",onClick:K,children:"Delete Character"})]})]})}),d.jsx(eC,{isOpen:j,onClose:()=>A(!1),campaigns:i,onAssignmentComplete:()=>{re()}})]})}function rC({isOpen:i,onClose:a,onCreateCampaign:r}){const[s,o]=S.useState(""),[c,h]=S.useState(""),[m,p]=S.useState(!1),[g,v]=S.useState(!1),[b,x]=S.useState([]),[_,C]=S.useState(""),[j,A]=S.useState("player"),R=async I=>{if(I.preventDefault(),!!s.trim())try{v(!0),(await r({name:s.trim(),description:c.trim()||void 0,creatorIsAlsoGM:m,initialMembers:b.length>0?b:void 0})).success&&(o(""),h(""),p(!1),x([]),C(""),A("player"))}finally{v(!1)}},k=()=>{_.trim()&&(b.some(I=>I.email.toLowerCase()===_.toLowerCase())||(x([...b,{email:_.trim(),role:j}]),C(""),A("player")))},O=I=>{x(b.filter((V,re)=>re!==I))},H=()=>{o(""),h(""),p(!1),x([]),C(""),A("player"),a()};return d.jsx(rt,{isOpen:i,onClose:H,title:"Create New Campaign",maxWidth:"lg",children:d.jsxs("form",{onSubmit:R,className:"space-y-6",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-zinc-50",children:"Campaign Information"}),d.jsx(oe,{label:"Campaign Name",value:s,onChange:I=>o(I.target.value),placeholder:"Enter campaign name",required:!0}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Description (optional)"}),d.jsx("textarea",{value:c,onChange:I=>h(I.target.value),className:"input w-full",rows:3,placeholder:"Describe your campaign"})]}),d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("input",{type:"checkbox",id:"creatorIsAlsoGM",checked:m,onChange:I=>p(I.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),d.jsx("label",{htmlFor:"creatorIsAlsoGM",className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Also be the Game Master"})]}),d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"You will always be an Administrator with full campaign control. Check this if you also want to run the game as GM."})]})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-zinc-50",children:"Invite Players (Optional)"}),d.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Add players to your campaign. They'll need to have accounts to join."}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("div",{className:"flex-1",children:d.jsx("input",{type:"email",value:_,onChange:I=>C(I.target.value),placeholder:"player@example.com",className:"input w-full",onKeyDown:I=>{I.key==="Enter"&&(I.preventDefault(),k())}})}),d.jsxs("select",{value:j,onChange:I=>A(I.target.value),className:"input",children:[d.jsx("option",{value:"player",children:"Player"}),d.jsx("option",{value:"gm",children:"GM"}),d.jsx("option",{value:"admin",children:"Admin"})]}),d.jsx(Te,{type:"button",onClick:k,disabled:!_.trim(),size:"sm",children:d.jsx(Ls,{className:"w-4 h-4"})})]}),b.length>0&&d.jsxs("div",{className:"space-y-2",children:[d.jsxs("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Initial Members (",b.length,")"]}),d.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:b.map((I,V)=>d.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-zinc-800 rounded-lg",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("span",{className:"text-sm text-gray-900 dark:text-zinc-50",children:I.email}),d.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-400 rounded-full",children:I.role})]}),d.jsx("button",{type:"button",onClick:()=>O(V),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:d.jsx(qu,{className:"w-4 h-4"})})]},V))})]})]}),d.jsx(_n,{onCancel:H,cancelText:"Cancel",confirmText:g?"Creating...":"Create Campaign",confirmDisabled:g||!s.trim(),confirmType:"submit",isLoading:g})]})})}const nC="modulepreload",sC=function(i){return"/traveller-dashboard/"+i},eg={},Nl=function(a,r,s){let o=Promise.resolve();if(r&&r.length>0){let p=function(g){return Promise.all(g.map(v=>Promise.resolve(v).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),m=h?.nonce||h?.getAttribute("nonce");o=p(r.map(g=>{if(g=sC(g),g in eg)return;eg[g]=!0;const v=g.endsWith(".css"),b=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${b}`))return;const x=document.createElement("link");if(x.rel=v?"stylesheet":nC,v||(x.as="script"),x.crossOrigin="",x.href=g,m&&x.setAttribute("nonce",m),document.head.appendChild(x),v)return new Promise((_,C)=>{x.addEventListener("load",_),x.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${g}`)))})}))}function c(h){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=h,window.dispatchEvent(m),!m.defaultPrevented)throw h}return o.then(h=>{for(const m of h||[])m.status==="rejected"&&c(m.reason);return a().catch(c)})},iC=()=>{const{user:i}=Za(),{items:a,loading:r,error:s,execute:o,setItems:c}=Ml(),h=S.useMemo(()=>Ku(),[]),m=S.useCallback(async()=>{if(!i?.email)return;await o(async()=>{const x=await h.getUserInvitations(i.email);return x.success?{success:!0,data:x.data||[]}:x.error?.includes("function")&&x.error?.includes("does not exist")?{success:!0,data:[]}:{success:!1,error:x.error||"Failed to load invitations"}})},[i?.email,h,o]),p=S.useCallback(async b=>{if(!i)return{success:!1,error:"User not found"};try{const x=await h.acceptCampaignInvitation(b,i.id);return x.success&&c(_=>_.filter(C=>C.id!==b)),x}catch{return{success:!1,error:"Failed to accept invitation"}}},[i,h,c]),g=S.useCallback(async b=>{try{const x=await h.declineCampaignInvitation(b);return x.success&&c(_=>_.filter(C=>C.id!==b)),x}catch{return{success:!1,error:"Failed to decline invitation"}}},[h,c]),v=S.useCallback(async(b,x)=>{if(!i)return{success:!1,error:"User not found"};try{const _=await p(b);if(!_.success)return _;const C=a.find(R=>R.id===b);if(!C)return{success:!1,error:"Invitation not found"};const{supabase:j}=await Nl(async()=>{const{supabase:R}=await Promise.resolve().then(()=>Ty);return{supabase:R}},[]),{error:A}=await j.from("characters").update({campaign_id:C.campaignId}).eq("id",x).eq("owner_id",i.id);return A?{success:!1,error:"Failed to assign character to campaign"}:{success:!0}}catch{return{success:!1,error:"Failed to accept invitation and assign character"}}},[i,a,p]);return S.useEffect(()=>{m()},[m]),{invitations:a,loading:r,error:s,acceptInvitation:p,declineInvitation:g,assignCharacterAndAccept:v,refreshInvitations:m}},lC=({onInvitationAccepted:i})=>{const{user:a}=Za(),{invitations:r,loading:s,error:o,acceptInvitation:c,declineInvitation:h,assignCharacterAndAccept:m}=iC(),[p,g]=S.useState([]),[v,b]=S.useState(!1),[x,_]=S.useState(null),[C,j]=S.useState(""),[A,R]=S.useState(!1),k=S.useCallback(async()=>{if(a)try{const{data:q,error:K}=await W.from("characters").select("id, name, campaign_id").eq("owner_id",a.id).is("campaign_id",null);!K&&q&&g(q)}catch{}},[a]);S.useEffect(()=>{k()},[k]);const O=async q=>{R(!0);try{(await c(q.id)).success&&i?.()}finally{R(!1)}},H=q=>{_(q),b(!0)},I=async()=>{if(!(!x||!C)){R(!0);try{(await m(x.id,C)).success&&(b(!1),_(null),j(""),await k(),i?.())}finally{R(!1)}}},V=async q=>{R(!0);try{await h(q)}finally{R(!1)}},re=q=>{const K=[];return q.isAdmin&&K.push("Admin"),q.isGm&&K.push("GM"),q.isPlayer&&K.push("Player"),K.length>0?K.join(", "):"Player"},G=q=>q?q.toLocaleDateString():"No expiration";return s?d.jsx("div",{className:"text-center py-4",children:"Loading invitations..."}):o?d.jsxs("div",{className:"text-center py-8 text-gray-500",children:[d.jsx("h3",{className:"text-lg font-medium mb-2",children:"Campaign Invitations"}),d.jsx("p",{className:"text-red-600",children:o})]}):r.length===0?d.jsxs("div",{className:"text-center py-8 text-gray-500",children:[d.jsx("h3",{className:"text-lg font-medium mb-2",children:"No pending invitations"}),d.jsx("p",{children:"You don't have any pending campaign invitations at the moment."})]}):d.jsxs("div",{className:"space-y-4",children:[d.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Campaign Invitations"}),r.map(q=>d.jsxs("div",{className:"border rounded-lg p-4 bg-white shadow-sm",children:[d.jsxs("div",{className:"flex justify-between items-start mb-3",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"font-semibold text-lg",children:q.campaignName||"Unknown Campaign"}),d.jsxs("p",{className:"text-gray-600 text-sm",children:["Invited by ",q.invitedByName||"Unknown User"]})]}),d.jsxs("div",{className:"text-right text-sm text-gray-500",children:[d.jsxs("div",{children:["Expires: ",G(q.expiresAt)]}),d.jsxs("div",{children:["Roles: ",re(q.rolesOffered)]})]})]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx(Te,{onClick:()=>O(q),disabled:A,className:"bg-green-600 hover:bg-green-700",children:"Accept"}),p.length>0&&d.jsx(Te,{onClick:()=>H(q),disabled:A,className:"bg-blue-600 hover:bg-blue-700",children:"Accept & Assign Character"}),d.jsx(Te,{onClick:()=>V(q.id),disabled:A,variant:"default",children:"Decline"})]})]},q.id)),d.jsx(rt,{isOpen:v,onClose:()=>{b(!1),_(null),j("")},title:"Accept Invitation & Assign Character",children:d.jsxs("div",{className:"space-y-4",children:[x&&d.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[d.jsx("h4",{className:"font-medium",children:x.campaignName}),d.jsxs("p",{className:"text-sm text-gray-600",children:["Roles: ",re(x.rolesOffered)]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"character-select",className:"block text-sm font-medium mb-2",children:"Select a character to assign:"}),d.jsxs("select",{id:"character-select",value:C,onChange:q=>j(q.target.value),className:"w-full p-2 border border-gray-300 rounded-md",children:[d.jsx("option",{value:"",children:"Choose a character..."}),p.map(q=>d.jsx("option",{value:q.id,children:q.name},q.id))]})]}),d.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[d.jsx(Te,{onClick:()=>{b(!1),_(null),j("")},variant:"default",disabled:A,children:"Cancel"}),d.jsx(Te,{onClick:I,disabled:A||!C,className:"bg-green-600 hover:bg-green-700",children:"Accept & Assign"})]})]})})]})},sd=i=>i.isAdmin?"admin":i.isGm?"gm":"player";function Dy(i){return i==="admin"?"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-400":i==="gm"?"bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-400":"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-400"}function tg({title:i,description:a,icon:r,onClick:s,disabled:o=!1}){return d.jsx("button",{onClick:s,disabled:o,className:"card-modern p-6 text-left hover:border-primary/50 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0 disabled:hover:shadow-none transition-all duration-300",children:d.jsxs("div",{className:"flex items-center space-x-4",children:[d.jsx("div",{className:"text-primary transition-transform duration-300 hover:scale-110",children:r}),d.jsxs("div",{className:"flex-grow",children:[d.jsx("h3",{className:"text-lg font-bold tracking-tight mb-1 text-text-main",children:i}),d.jsx("p",{className:"text-sm text-muted",children:a})]})]})})}function oC({campaigns:i,onCampaignSelect:a}){const r=i.sort((s,o)=>o.updatedAt.getTime()-s.updatedAt.getTime()).slice(0,3);return d.jsxs("div",{className:"card-modern p-6",children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsx("h3",{className:"text-lg font-black tracking-tighter uppercase",children:"Recent Campaigns"}),i.length>3&&d.jsxs("span",{className:"text-xs font-bold text-muted uppercase tracking-widest",children:[i.length," total"]})]}),r.length===0?d.jsx("p",{className:"text-muted text-sm italic",children:"No campaigns yet. Create your first campaign to get started!"}):d.jsx("div",{className:"space-y-3",children:r.map(s=>d.jsxs("div",{className:"group flex items-center justify-between p-4 rounded-2xl border border-border bg-hud-accent hover:bg-surface-mid hover:border-primary/30 cursor-pointer transition-all duration-300",onClick:()=>a(s.id),children:[d.jsxs("div",{className:"flex-grow",children:[d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("h4",{className:"font-bold text-text-main",children:s.name}),s.userRoles&&d.jsx("span",{className:`px-2 py-0.5 text-[10px] font-black uppercase rounded-full ${Dy(sd(s.userRoles))}`,children:kl(s.userRoles)})]}),d.jsxs("p",{className:"text-[10px] uppercase font-bold text-muted tracking-widest mt-1",children:[s.memberCount||0," member(s)  Updated"," ",s.updatedAt.toLocaleDateString()]})]}),d.jsx(Pu,{className:"w-5 h-5 text-muted transition-transform duration-300 group-hover:translate-x-1 group-hover:text-primary"})]},s.id))})]})}class gu{static toDomain(a,r){return{id:a.id,email:a.email||"",displayName:r?.display_name||a.user_metadata?.display_name||a.email?.split("@")[0],username:r?.username||a.user_metadata?.username||a.email?.split("@")[0],profileCompleted:r?.profile_completed||!!a.user_metadata?.profile_completed,createdAt:new Date(a.created_at)}}}class ag{static toDomain(a){if(!a)throw new Error("Cannot map null character data");return{id:a.id,campaignId:a.campaign_id||null,name:a.name||"Unknown Character",playerName:a.player_name||void 0,characterName:a.character_name||void 0,ownerId:a.owner_id||void 0,createdAt:a.created_at?new Date(a.created_at):new Date,updatedAt:a.updated_at?new Date(a.updated_at):new Date}}static toDomainList(a){return(a||[]).map(r=>this.toDomain(r))}}class cC{supabase;constructor(a){this.supabase=a}async getCharacters(a){try{const{data:r,error:s}=await this.supabase.from("characters").select("*").eq("campaign_id",a).order("created_at",{ascending:!1});if(s)throw s;return{success:!0,data:(r||[]).map(c=>({id:c.id,campaignId:c.campaign_id,name:c.name,playerName:c.player_name,characterName:c.character_name,ownerId:c.owner_id,createdAt:new Date(c.created_at),updatedAt:new Date(c.updated_at)}))}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Failed to get characters"}}}async getCharacter(a){try{const{data:r,error:s}=await this.supabase.from("characters").select("*").eq("id",a).single();if(s)throw s;return{success:!0,data:{id:r.id,campaignId:r.campaign_id,name:r.name,playerName:r.player_name,characterName:r.character_name,ownerId:r.owner_id,createdAt:new Date(r.created_at),updatedAt:new Date(r.updated_at)}}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Failed to get character"}}}async createCharacter(a,r){try{const{data:s,error:o}=await this.supabase.from("characters").insert({campaign_id:r.campaignId,name:r.name,player_name:r.playerName,character_name:r.characterName,owner_id:a}).select().single();if(o)throw o;return{success:!0,data:{id:s.id,campaignId:s.campaign_id,name:s.name,playerName:s.player_name,characterName:s.character_name,ownerId:s.owner_id,createdAt:new Date(s.created_at),updatedAt:new Date(s.updated_at)}}}catch(s){return{success:!1,error:s instanceof Error?s.message:"Failed to create character"}}}async updateCharacter(a,r){try{const s={updated_at:new Date().toISOString()};r.name!==void 0&&(s.name=r.name),r.playerName!==void 0&&(s.player_name=r.playerName),r.characterName!==void 0&&(s.character_name=r.characterName);const{error:o}=await this.supabase.from("characters").update(s).eq("id",a);if(o)throw o;return{success:!0}}catch(s){return{success:!1,error:s instanceof Error?s.message:"Failed to update character"}}}async deleteCharacter(a){try{const{error:r}=await this.supabase.from("characters").delete().eq("id",a);if(r)throw r;return{success:!0}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Failed to delete character"}}}async getCharacterFinance(a){try{const{data:r,error:s}=await this.supabase.from("character_finance").select("*").eq("character_id",a).order("transaction_date",{ascending:!1});if(s)throw s;return{success:!0,data:(r||[]).map(c=>({id:c.id,characterId:c.character_id,description:c.description,amount:parseFloat(c.amount),transactionDate:new Date(c.transaction_date),createdAt:new Date(c.created_at)}))}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Failed to get character finances"}}}async addCharacterFinance(a,r,s){try{const{data:o,error:c}=await this.supabase.from("character_finance").insert({character_id:a,description:r,amount:s}).select().single();if(c)throw c;return{success:!0,data:{id:o.id,characterId:o.character_id,description:o.description,amount:parseFloat(o.amount),transactionDate:new Date(o.transaction_date),createdAt:new Date(o.created_at)}}}catch(o){return{success:!1,error:o instanceof Error?o.message:"Failed to add character finance"}}}async updateCharacterFinance(a,r,s){try{const o={};r!==void 0&&(o.description=r),s!==void 0&&(o.amount=s);const{error:c}=await this.supabase.from("character_finance").update(o).eq("id",a);if(c)throw c;return{success:!0}}catch(o){return{success:!1,error:o instanceof Error?o.message:"Failed to update character finance"}}}async deleteCharacterFinance(a){try{const{error:r}=await this.supabase.from("character_finance").delete().eq("id",a);if(r)throw r;return{success:!0}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Failed to delete character finance"}}}async getCharacterInventory(a){try{const{data:r,error:s}=await this.supabase.from("character_inventory").select("*").eq("character_id",a).order("created_at",{ascending:!1});if(s)throw s;return{success:!0,data:(r||[]).map(c=>({id:c.id,characterId:c.character_id,itemName:c.item_name,quantity:c.quantity,weight:c.weight?parseFloat(c.weight):void 0,value:c.value?parseFloat(c.value):void 0,description:c.description,createdAt:new Date(c.created_at)}))}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Failed to get character inventory"}}}async addCharacterInventory(a,r){try{const{data:s,error:o}=await this.supabase.from("character_inventory").insert({character_id:a,item_name:r.itemName,quantity:r.quantity,weight:r.weight,value:r.value,description:r.description}).select().single();if(o)throw o;return{success:!0,data:{id:s.id,characterId:s.character_id,itemName:s.item_name,quantity:s.quantity,weight:s.weight?parseFloat(s.weight):void 0,value:s.value?parseFloat(s.value):void 0,description:s.description,createdAt:new Date(s.created_at)}}}catch(s){return{success:!1,error:s instanceof Error?s.message:"Failed to add character inventory"}}}async updateCharacterInventory(a,r){try{const s={};r.itemName!==void 0&&(s.item_name=r.itemName),r.quantity!==void 0&&(s.quantity=r.quantity),r.weight!==void 0&&(s.weight=r.weight),r.value!==void 0&&(s.value=r.value),r.description!==void 0&&(s.description=r.description);const{error:o}=await this.supabase.from("character_inventory").update(s).eq("id",a);if(o)throw o;return{success:!0}}catch(s){return{success:!1,error:s instanceof Error?s.message:"Failed to update character inventory"}}}async deleteCharacterInventory(a){try{const{error:r}=await this.supabase.from("character_inventory").delete().eq("id",a);if(r)throw r;return{success:!0}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Failed to delete character inventory"}}}async getCharacterWeapons(a){try{const{data:r,error:s}=await this.supabase.from("character_weapons").select("*").eq("character_id",a).order("created_at",{ascending:!1});if(s)throw s;return{success:!0,data:(r||[]).map(c=>({id:c.id,characterId:c.character_id,name:c.name,damage:c.damage,range:c.range,weight:c.weight?parseFloat(c.weight):void 0,cost:c.cost?parseFloat(c.cost):void 0,notes:c.notes,createdAt:new Date(c.created_at)}))}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Failed to get character weapons"}}}async addCharacterWeapon(a,r){try{const{data:s,error:o}=await this.supabase.from("character_weapons").insert({character_id:a,name:r.name,damage:r.damage,range:r.range,weight:r.weight,cost:r.cost,notes:r.notes}).select().single();if(o)throw o;return{success:!0,data:{id:s.id,characterId:s.character_id,name:s.name,damage:s.damage,range:s.range,weight:s.weight?parseFloat(s.weight):void 0,cost:s.cost?parseFloat(s.cost):void 0,notes:s.notes,createdAt:new Date(s.created_at)}}}catch(s){return{success:!1,error:s instanceof Error?s.message:"Failed to add character weapon"}}}async updateCharacterWeapon(a,r){try{const s={};r.name!==void 0&&(s.name=r.name),r.damage!==void 0&&(s.damage=r.damage),r.range!==void 0&&(s.range=r.range),r.weight!==void 0&&(s.weight=r.weight),r.cost!==void 0&&(s.cost=r.cost),r.notes!==void 0&&(s.notes=r.notes);const{error:o}=await this.supabase.from("character_weapons").update(s).eq("id",a);if(o)throw o;return{success:!0}}catch(s){return{success:!1,error:s instanceof Error?s.message:"Failed to update character weapon"}}}async deleteCharacterWeapon(a){try{const{error:r}=await this.supabase.from("character_weapons").delete().eq("id",a);if(r)throw r;return{success:!0}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Failed to delete character weapon"}}}async getCharacterArmour(a){try{const{data:r,error:s}=await this.supabase.from("character_armour").select("*").eq("character_id",a).order("created_at",{ascending:!1});if(s)throw s;return{success:!0,data:(r||[]).map(c=>({id:c.id,characterId:c.character_id,name:c.name,protection:c.protection,weight:c.weight?parseFloat(c.weight):void 0,cost:c.cost?parseFloat(c.cost):void 0,notes:c.notes,createdAt:new Date(c.created_at)}))}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Failed to get character armour"}}}async addCharacterArmour(a,r){try{const{data:s,error:o}=await this.supabase.from("character_armour").insert({character_id:a,name:r.name,protection:r.protection,weight:r.weight,cost:r.cost,notes:r.notes}).select().single();if(o)throw o;return{success:!0,data:{id:s.id,characterId:s.character_id,name:s.name,protection:s.protection,weight:s.weight?parseFloat(s.weight):void 0,cost:s.cost?parseFloat(s.cost):void 0,notes:s.notes,createdAt:new Date(s.created_at)}}}catch(s){return{success:!1,error:s instanceof Error?s.message:"Failed to add character armour"}}}async updateCharacterArmour(a,r){try{const s={};r.name!==void 0&&(s.name=r.name),r.protection!==void 0&&(s.protection=r.protection),r.weight!==void 0&&(s.weight=r.weight),r.cost!==void 0&&(s.cost=r.cost),r.notes!==void 0&&(s.notes=r.notes);const{error:o}=await this.supabase.from("character_armour").update(s).eq("id",a);if(o)throw o;return{success:!0}}catch(s){return{success:!1,error:s instanceof Error?s.message:"Failed to update character armour"}}}async deleteCharacterArmour(a){try{const{error:r}=await this.supabase.from("character_armour").delete().eq("id",a);if(r)throw r;return{success:!0}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Failed to delete character armour"}}}async getCharacterAmmo(a){try{const{data:r,error:s}=await this.supabase.from("character_ammo").select("*").eq("character_id",a).order("created_at",{ascending:!1});if(s)throw s;return{success:!0,data:(r||[]).map(c=>({id:c.id,characterId:c.character_id,type:c.type,quantity:c.quantity,maxQuantity:c.max_quantity,weaponCompatibility:c.weapon_compatibility,notes:c.notes,createdAt:new Date(c.created_at)}))}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Failed to get character ammo"}}}async addCharacterAmmo(a,r){try{const{data:s,error:o}=await this.supabase.from("character_ammo").insert({character_id:a,type:r.type,quantity:r.quantity,max_quantity:r.maxQuantity,weapon_compatibility:r.weaponCompatibility,notes:r.notes}).select().single();if(o)throw o;return{success:!0,data:{id:s.id,characterId:s.character_id,type:s.type,quantity:s.quantity,maxQuantity:s.max_quantity,weaponCompatibility:s.weapon_compatibility,notes:s.notes,createdAt:new Date(s.created_at)}}}catch(s){return{success:!1,error:s instanceof Error?s.message:"Failed to add character ammo"}}}async updateCharacterAmmo(a,r){try{const s={};r.type!==void 0&&(s.type=r.type),r.quantity!==void 0&&(s.quantity=r.quantity),r.maxQuantity!==void 0&&(s.max_quantity=r.maxQuantity),r.weaponCompatibility!==void 0&&(s.weapon_compatibility=r.weaponCompatibility),r.notes!==void 0&&(s.notes=r.notes);const{error:o}=await this.supabase.from("character_ammo").update(s).eq("id",a);if(o)throw o;return{success:!0}}catch(s){return{success:!1,error:s instanceof Error?s.message:"Failed to update character ammo"}}}async deleteCharacterAmmo(a){try{const{error:r}=await this.supabase.from("character_ammo").delete().eq("id",a);if(r)throw r;return{success:!0}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Failed to delete character ammo"}}}}class uC{async mapAuthUserToUser(a){try{const{isSupabaseConfigured:r}=await Nl(async()=>{const{isSupabaseConfigured:s}=await Promise.resolve().then(()=>Ty);return{isSupabaseConfigured:s}},void 0);if(r){const{data:s,error:o}=await W.from("user_profiles").select("display_name, username, profile_completed").eq("id",a.id).single();if(!o&&s)return gu.toDomain(a,s)}return gu.toDomain(a)}catch{return gu.toDomain(a)}}async getCurrentUser(){try{const{data:{user:a},error:r}=await W.auth.getUser();return r||!a?null:await this.mapAuthUserToUser(a)}catch{return null}}async signIn(a,r){try{const{data:s,error:o}=await W.auth.signInWithPassword({email:a,password:r});return o?{success:!1,error:o.message}:{success:!0,data:{id:s.user.id,email:s.user.email||"",displayName:s.user.user_metadata?.display_name,createdAt:new Date(s.user.created_at)}}}catch{return{success:!1,error:"An unexpected error occurred during sign in"}}}async signUp(a,r){try{const s=`${window.location.origin}/traveller-dashboard/`,{data:o,error:c}=await W.auth.signUp({email:a,password:r,options:{data:{display_name:a.split("@")[0]},emailRedirectTo:s}});return c?{success:!1,error:c.message}:o.user?{success:!0,data:{id:o.user.id,email:o.user.email||"",displayName:o.user.user_metadata?.display_name,createdAt:new Date(o.user.created_at)}}:{success:!1,error:"Failed to create user account"}}catch{return{success:!1,error:"An unexpected error occurred during sign up"}}}async signOut(){try{const{error:a}=await W.auth.signOut();return a?{success:!1,error:a.message}:{success:!0}}catch{return{success:!1,error:"An unexpected error occurred during sign out"}}}onAuthStateChange(a){const{data:{subscription:r}}=W.auth.onAuthStateChange(async(s,o)=>{if(o?.user){const c=await this.mapAuthUserToUser(o.user);a(c)}else a(null)});return()=>r.unsubscribe()}async completeProfile(a,r,s){try{const{error:o}=await W.from("user_profiles").update({display_name:r,username:s,profile_completed:!0,updated_at:new Date().toISOString()}).eq("id",a);if(o)return o.code==="23505"?{success:!1,error:"Username is already taken"}:{success:!1,error:o.message};const{data:c,error:h}=await W.auth.updateUser({data:{display_name:r,username:s,profile_completed:!0}});return h?{success:!1,error:h.message}:{success:!0,data:{id:c.user.id,email:c.user.email||"",displayName:r,username:s,profileCompleted:!0,createdAt:new Date(c.user.created_at)}}}catch(o){return{success:!1,error:o instanceof Error?o.message:"Failed to complete profile"}}}buildProfileUpdates(a,r){const s={updated_at:new Date().toISOString()};return a!==void 0&&(s.display_name=a),r!==void 0&&(s.username=r),s}buildAuthUpdates(a,r){const s={};return a!==void 0&&(s.display_name=a),r!==void 0&&(s.username=r),s}async updateProfile(a,r,s){try{const o=this.buildProfileUpdates(r,s),{error:c}=await W.from("user_profiles").update(o).eq("id",a);if(c)return c.code==="23505"?{success:!1,error:"Username is already taken"}:{success:!1,error:c.message};const h=this.buildAuthUpdates(r,s),{data:m,error:p}=await W.auth.updateUser({data:h});if(p)return{success:!1,error:p.message};const{data:g}=await W.from("user_profiles").select("*").eq("id",a).single(),v=g;return{success:!0,data:{id:m.user.id,email:m.user.email||"",displayName:v?.display_name||m.user.user_metadata?.display_name,username:v?.username||m.user.user_metadata?.username,profileCompleted:v?.profile_completed||m.user.user_metadata?.profile_completed||!1,createdAt:new Date(m.user.created_at)}}}catch(o){return{success:!1,error:o instanceof Error?o.message:"Failed to update profile"}}}async changePassword(a,r,s){try{const{data:o}=await W.auth.getUser();if(!o.user?.email)return{success:!1,error:"User not found"};const{error:c}=await W.auth.signInWithPassword({email:o.user.email,password:r});if(c)return{success:!1,error:"Current password is incorrect"};const{error:h}=await W.auth.updateUser({password:s});return h?{success:!1,error:h.message}:{success:!0}}catch(o){return{success:!1,error:o instanceof Error?o.message:"Failed to change password"}}}async deleteAccount(a){try{const{error:r}=await W.from("user_profiles").delete().eq("id",a);return r?{success:!1,error:r.message}:{success:!0}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Failed to delete account"}}}}class My{async getCampaigns(a){try{const{data:r,error:s}=await W.from("campaigns").select(`
          *,
          campaign_members!inner(
            is_admin,
            is_gm,
            is_player,
            user_id
          ),
          member_count:campaign_members(count)
        `).eq("campaign_members.user_id",a).order("created_at",{ascending:!1});return s?{success:!1,error:"Failed to fetch campaigns"}:{success:!0,data:r.map(c=>{const h=c.campaign_members[0];return{id:c.id,name:c.name,description:c.description||void 0,createdBy:c.created_by,createdAt:new Date(c.created_at||Date.now()),updatedAt:new Date(c.updated_at||Date.now()),userRoles:h?{isAdmin:h.is_admin||!1,isGm:h.is_gm||!1,isPlayer:h.is_player||!1}:{isAdmin:!1,isGm:!1,isPlayer:!1},memberCount:c.member_count?.[0]?.count||0,isOwner:c.created_by===a}})}}catch{return{success:!1,error:"An unexpected error occurred"}}}async getCampaign(a){try{const{data:r,error:s}=await W.from("campaigns").select("*").eq("id",a).single();return s?{success:!1,error:"Campaign not found"}:{success:!0,data:{id:r.id,name:r.name,description:r.description||void 0,createdBy:r.created_by,createdAt:new Date(r.created_at||Date.now()),updatedAt:new Date(r.updated_at||Date.now())}}}catch{return{success:!1,error:"An unexpected error occurred"}}}async createCampaign(a,r,s=!1){try{const{data:o,error:c}=await W.from("campaigns").insert({name:r.name,description:r.description,created_by:a}).select().single();if(c)return{success:!1,error:`Failed to create campaign: ${c.message}`};const{error:h}=await W.from("campaign_members").insert({campaign_id:o.id,user_id:a,role:"admin"});if(h)return await W.from("campaigns").delete().eq("id",o.id),{success:!1,error:`Failed to set up campaign admin: ${h.message}`};if(s){const{error:p}=await W.from("campaign_members").insert({campaign_id:o.id,user_id:a,role:"gm"})}return{success:!0,data:{id:o.id,name:o.name,description:o.description||void 0,createdBy:o.created_by,createdAt:new Date(o.created_at||Date.now()),updatedAt:new Date(o.updated_at||Date.now())}}}catch{return{success:!1,error:"An unexpected error occurred"}}}async updateCampaign(a,r){try{const{error:s}=await W.from("campaigns").update({name:r.name,description:r.description,updated_at:new Date().toISOString()}).eq("id",a);return s?{success:!1,error:"Failed to update campaign"}:{success:!0}}catch{return{success:!1,error:"An unexpected error occurred"}}}async deleteCampaign(a){try{const{error:r}=await W.from("campaigns").delete().eq("id",a);return r?{success:!1,error:"Failed to delete campaign"}:{success:!0}}catch{return{success:!1,error:"An unexpected error occurred"}}}async getCampaignMembers(a){try{const{data:r,error:s}=await W.from("campaign_members").select("id, user_id, is_admin, is_gm, is_player, created_at").eq("campaign_id",a).order("created_at",{ascending:!0});if(s)return{success:!1,error:"Failed to fetch campaign members"};const o=[];for(const c of r){const h=c;try{const{data:m,error:p}=await W.from("user_profiles").select("*").eq("id",h.user_id).single();let g,v,b;if(!p&&m){const x=m;g=x.email||"",v=x.display_name||void 0,b=x.username||void 0}else g=`user_${h.user_id.slice(0,8)}@example.com`,v=void 0,b=void 0;o.push({id:h.id,userId:h.user_id,email:g,displayName:v,username:b,roles:{isAdmin:h.is_admin||!1,isGm:h.is_gm||!1,isPlayer:h.is_player||!1},joinedAt:new Date(h.created_at)})}catch{o.push({id:h.id,userId:h.user_id,email:`user_${h.user_id.slice(0,8)}@example.com`,displayName:void 0,username:void 0,roles:{isAdmin:h.is_admin||!1,isGm:h.is_gm||!1,isPlayer:h.is_player||!1},joinedAt:new Date(h.created_at)})}}return{success:!0,data:o}}catch{return{success:!1,error:"An unexpected error occurred"}}}async addMemberByEmail(a,r,s){try{const{data:o,error:c}=await W.from("user_profiles").select("id").eq("email",r).single();if(c||!o){if(!(await W.auth.getUser()).data.user)return{success:!1,error:"You must be logged in to send invitations"};try{const{data:g,error:v}=await W.functions.invoke("invite-user",{body:{email:r,campaignId:a,role:s,campaignName:void 0}});return v?{success:!1,error:`Failed to send invitation: ${v.message||JSON.stringify(v)}`}:g?.error?{success:!1,error:`${g.error}${g.details?`: ${g.details}`:""}`}:{success:!0}}catch(g){return{success:!1,error:`Failed to send invitation: ${g instanceof Error?g.message:"Unknown error"}`}}}const{data:h}=await W.from("campaign_members").select("id").eq("campaign_id",a).eq("user_id",o.id).single();if(h)return{success:!1,error:"User is already a member of this campaign"};const{error:m}=await W.from("campaign_members").insert({campaign_id:a,user_id:o.id,role:s});return m?{success:!1,error:"Failed to add member to campaign"}:{success:!0}}catch{return{success:!1,error:"An unexpected error occurred"}}}async updateMemberRole(a,r,s){try{const{error:o}=await W.from("campaign_members").update({is_admin:s.isAdmin,is_gm:s.isGm,is_player:s.isPlayer}).eq("campaign_id",a).eq("user_id",r);return o?{success:!1,error:"Failed to update member role"}:{success:!0}}catch{return{success:!1,error:"An unexpected error occurred"}}}async removeMember(a,r){try{const{error:s}=await W.from("campaign_members").delete().eq("campaign_id",a).eq("user_id",r);return s?{success:!1,error:"Failed to remove member"}:{success:!0}}catch{return{success:!1,error:"An unexpected error occurred"}}}async createPendingInvitation(a,r,s,o){try{const{data:c}=await W.from("pending_invitations").select("id").eq("email",r).eq("campaign_id",a).is("accepted_at",null).gte("expires_at",new Date().toISOString()).single();if(c)return{success:!1,error:"An invitation has already been sent to this email address for this campaign"};const{data:h}=await W.from("campaigns").select("name").eq("id",a).single(),{data:m}=await W.from("user_profiles").select("display_name, email").eq("id",o).single(),{data:p,error:g}=await W.from("pending_invitations").insert({email:r,campaign_id:a,invited_by:o,role:s}).select(`
          id,
          email,
          campaign_id,
          invited_by,
          role,
          created_at,
          expires_at,
          accepted_at
        `).single();return g?{success:!1,error:"Failed to create invitation"}:(await W.rpc("send_campaign_invitation",{p_email:r,p_campaign_id:a,p_campaign_name:h?.name||"Unknown Campaign",p_inviter_name:m?.display_name||m?.email||"Unknown User",p_role:s}),{success:!0,data:{id:p.id,email:p.email,campaignId:p.campaign_id,campaignName:h?.name,invitedBy:p.invited_by,inviterName:m?.display_name||m?.email,role:p.role,createdAt:new Date(p.created_at||""),expiresAt:new Date(p.expires_at||""),acceptedAt:p.accepted_at?new Date(p.accepted_at):void 0}})}catch{return{success:!1,error:"An unexpected error occurred"}}}async getPendingInvitations(a){try{const{data:r,error:s}=await W.from("pending_invitations").select(`
          id,
          email,
          campaign_id,
          invited_by,
          role,
          created_at,
          expires_at,
          accepted_at,
          campaigns(name)
        `).eq("campaign_id",a).is("accepted_at",null).gte("expires_at",new Date().toISOString()).order("created_at",{ascending:!1});return s?{success:!1,error:"Failed to fetch pending invitations"}:{success:!0,data:(r||[]).map(c=>({id:c.id,email:c.email,campaignId:c.campaign_id,campaignName:c.campaigns?.name,invitedBy:c.invited_by,inviterName:void 0,role:c.role,createdAt:new Date(c.created_at||""),expiresAt:new Date(c.expires_at||""),acceptedAt:c.accepted_at?new Date(c.accepted_at):void 0}))}}catch{return{success:!1,error:"An unexpected error occurred"}}}async getUserPendingInvitations(a){try{const{data:r,error:s}=await W.from("pending_invitations").select(`
          id,
          email,
          campaign_id,
          invited_by,
          role,
          created_at,
          expires_at,
          accepted_at,
          campaigns(name)
        `).eq("email",a).is("accepted_at",null).gte("expires_at",new Date().toISOString()).order("created_at",{ascending:!1});return s?{success:!1,error:"Failed to fetch pending invitations"}:{success:!0,data:(r||[]).map(c=>({id:c.id,email:c.email,campaignId:c.campaign_id,campaignName:c.campaigns?.name,invitedBy:c.invited_by,inviterName:void 0,role:c.role,createdAt:new Date(c.created_at||""),expiresAt:new Date(c.expires_at||""),acceptedAt:c.accepted_at?new Date(c.accepted_at):void 0}))}}catch{return{success:!1,error:"An unexpected error occurred"}}}async acceptPendingInvitation(a,r){try{const{data:s,error:o}=await W.from("pending_invitations").select("*").eq("id",a).is("accepted_at",null).gte("expires_at",new Date().toISOString()).single();if(o||!s)return{success:!1,error:"Invitation not found or expired"};const{data:c}=await W.from("campaign_members").select("id").eq("campaign_id",s.campaign_id).eq("user_id",r).single();if(c)return await W.from("pending_invitations").update({accepted_at:new Date().toISOString()}).eq("id",a),{success:!1,error:"You are already a member of this campaign"};const{error:h}=await W.from("campaign_members").insert({campaign_id:s.campaign_id,user_id:r,is_admin:s.role==="admin",is_gm:s.role==="gm",is_player:s.role==="player"});if(h)return{success:!1,error:"Failed to add you to the campaign"};const{error:m}=await W.from("pending_invitations").update({accepted_at:new Date().toISOString()}).eq("id",a);return{success:!0}}catch{return{success:!1,error:"An unexpected error occurred"}}}async declinePendingInvitation(a){try{const{error:r}=await W.from("pending_invitations").delete().eq("id",a);return r?{success:!1,error:"Failed to decline invitation"}:{success:!0}}catch{return{success:!1,error:"An unexpected error occurred"}}}async cancelPendingInvitation(a){try{const{error:r}=await W.from("pending_invitations").delete().eq("id",a);return r?{success:!1,error:"Failed to cancel invitation"}:{success:!0}}catch{return{success:!1,error:"An unexpected error occurred"}}}async getUserRole(a,r){try{const s=await this.getUserRoles(a,r);if(!s.success||!s.data)return{success:!1,error:s.error||"User is not a member of this campaign"};const o=s.data;let c;return o.isAdmin?c="admin":o.isGm?c="gm":c="player",{success:!0,data:c}}catch{return{success:!1,error:"An unexpected error occurred"}}}async getUserRoles(a,r){try{const{data:s,error:o}=await W.from("campaign_members").select("is_admin, is_gm, is_player").eq("campaign_id",a).eq("user_id",r).single();if(o||!s)return{success:!1,error:"User is not a member of this campaign"};const c=s;return{success:!0,data:{isAdmin:c.is_admin||!1,isGm:c.is_gm||!1,isPlayer:c.is_player||!1}}}catch{return{success:!1,error:"An unexpected error occurred"}}}async canUserAccessCampaign(a,r){try{const{data:s,error:o}=await W.from("campaign_members").select("id").eq("campaign_id",a).eq("user_id",r).single();return o?{success:!0,data:!1}:{success:!0,data:!!s}}catch{return{success:!1,error:"An unexpected error occurred"}}}async getCharactersByCampaign(a){try{const{data:r,error:s}=await W.from("characters").select("*").eq("campaign_id",a).order("created_at",{ascending:!0});return s?{success:!1,error:s.message}:{success:!0,data:r||[]}}catch{return{success:!1,error:"An unexpected error occurred"}}}async createCharacterForCampaign(a,r,s,o,c){try{const{data:h,error:m}=await W.from("characters").insert({campaign_id:a,name:s,player_name:o,character_name:c,owner_id:r}).select().single();return m?{success:!1,error:m.message}:{success:!0,data:h}}catch{return{success:!1,error:"An unexpected error occurred"}}}async createStandaloneCharacter(a,r){try{const{data:s,error:o}=await W.rpc("create_standalone_character",{user_id:a,char_name:r.name,player_name:r.playerName||void 0,character_name:r.characterName||void 0});return o?{success:!1,error:o.message}:{success:!0,data:ag.toDomain(s)}}catch{return{success:!1,error:"An unexpected error occurred"}}}async getStandaloneCharacters(a){try{const{data:r,error:s}=await W.from("characters").select("*").eq("owner_id",a).is("campaign_id",null).order("created_at",{ascending:!1});return s?{success:!1,error:s.message}:{success:!0,data:ag.toDomainList(r||[])}}catch{return{success:!1,error:"An unexpected error occurred"}}}async deleteStandaloneCharacter(a,r){try{const{data:s,error:o}=await W.from("characters").select("owner_id, campaign_id").eq("id",a).single();if(o||!s)return{success:!1,error:"Character not found"};if(s.campaign_id!==null)return{success:!1,error:"This is not a standalone character"};if(s.owner_id!==r)return{success:!1,error:"You don't have permission to delete this character"};const{error:c}=await W.from("characters").delete().eq("id",a);return c?{success:!1,error:c.message}:{success:!0}}catch{return{success:!1,error:"An unexpected error occurred"}}}async assignCharacterToCampaign(a,r,s){try{const{data:o,error:c}=await W.from("characters").select("owner_id, campaign_id").eq("id",a).single();if(c||!o)return{success:!1,error:"Character not found"};if(o.owner_id!==s)return{success:!1,error:"You don't have permission to move this character"};if(o.campaign_id!==null)return{success:!1,error:"Character is already assigned to a campaign"};const{data:h,error:m}=await W.from("campaign_members").select("id").eq("campaign_id",r).eq("user_id",s).single();if(m||!h)return{success:!1,error:"You are not a member of this campaign"};const{error:p}=await W.from("characters").update({campaign_id:r}).eq("id",a);return p?{success:!1,error:p.message}:{success:!0}}catch{return{success:!1,error:"An unexpected error occurred"}}}async createCampaignInvitation(a,r,s,o){try{const{data:c,error:h}=await W.rpc("create_campaign_invitation",{p_campaign_id:a,p_invited_email:r,p_invited_by:s,p_roles_offered:JSON.stringify(o)});return h?{success:!1,error:h.message}:{success:!0,data:c}}catch{return{success:!1,error:"An unexpected error occurred"}}}async getUserInvitations(a){try{const{data:r,error:s}=await W.rpc("get_user_invitations",{p_user_email:a});return s?{success:!1,error:s.message}:{success:!0,data:Array.isArray(r)?r.map(c=>({id:c.id,campaignId:c.campaign_id,campaignName:c.campaign_name,invitedEmail:c.invited_email,invitedBy:c.invited_by,invitedByName:c.inviter_name,rolesOffered:typeof c.roles_offered=="string"?JSON.parse(c.roles_offered):c.roles_offered,status:c.status,expiresAt:c.expires_at?new Date(c.expires_at):null,createdAt:new Date(c.created_at),acceptedAt:c.accepted_at?new Date(c.accepted_at):null})):[]}}catch{return{success:!1,error:"An unexpected error occurred"}}}async acceptCampaignInvitation(a,r){try{const{data:s,error:o}=await W.rpc("accept_campaign_invitation",{p_invitation_id:a,p_user_id:r});return o?{success:!1,error:o.message}:{success:!0,data:s}}catch{return{success:!1,error:"An unexpected error occurred"}}}async declineCampaignInvitation(a){try{const{data:r,error:s}=await W.rpc("decline_campaign_invitation",{p_invitation_id:a});return s?{success:!1,error:s.message}:{success:!0,data:r}}catch{return{success:!1,error:"An unexpected error occurred"}}}async deleteCharacter(a,r){try{const{data:s,error:o}=await W.from("characters").select("owner_id, campaign_id, campaigns!inner(created_by)").eq("id",a).single();if(o)return{success:!1,error:"Character not found"};if(s.owner_id!==r&&s.campaigns.created_by!==r)return{success:!1,error:"You don't have permission to delete this character"};const{error:c}=await W.from("characters").delete().eq("id",a);return c?{success:!1,error:c.message}:{success:!0}}catch{return{success:!1,error:"An unexpected error occurred"}}}}function id(i){const{items:a,loading:r,error:s,execute:o,setItems:c}=Ml(),h=S.useMemo(()=>new My,[]),m=S.useCallback(async v=>{if(!v)return;await o(async x=>{const _=await h.getCharactersByCampaign(x);return _.success&&_.data&&_.data.length>0?{success:!0,data:_.data.map(j=>({id:j.id,campaignId:j.campaign_id||"",displayName:j.name,playerName:j.player_name||"",characterName:j.character_name||"",ownerId:j.owner_id||void 0}))}:{success:!0,data:[]}},v)},[h,o]),p=S.useCallback(async(v,b,x)=>{if(!i)return{success:!1,error:"No campaign selected"};try{const _=`${v}  ${b}`,C=await h.createCharacterForCampaign(i,x,_,v,b);if(C.success&&C.data){const j={id:C.data.id,campaignId:C.data.campaign_id||"",displayName:C.data.name,playerName:v,characterName:b,ownerId:C.data.owner_id||void 0};return c(A=>[...A,j]),{success:!0,data:j}}return{success:!1,error:C.error||"Failed to create character"}}catch{return{success:!1,error:"An error occurred while creating the character"}}},[i,h,c]),g=S.useCallback(async(v,b)=>{try{const x=await h.deleteCharacter(v,b);return x.success?(c(_=>_.filter(C=>C.id!==v)),{success:!0}):{success:!1,error:x.error||"Failed to delete character"}}catch{return{success:!1,error:"An error occurred while deleting the character"}}},[h,c]);return S.useEffect(()=>{i?m(i):c([])},[i,m,c]),{characters:a,loading:r,error:s,createCharacter:p,deleteCharacter:g,refreshCharacters:()=>i&&m(i)}}function dC({campaign:i,onSelect:a,onEdit:r,onSettings:s}){const o=sd(i.userRoles);return d.jsxs("div",{className:"card-modern relative group hover:border-primary/50",children:[d.jsxs("div",{className:"flex items-start justify-between mb-4",children:[d.jsxs("div",{className:"flex-grow",children:[d.jsx("h3",{className:"text-lg font-bold tracking-tight mb-1 text-text-main",children:i.name}),i.description&&d.jsx("p",{className:"text-xs text-muted font-medium line-clamp-2 mb-2 italic",children:i.description})]}),d.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${Dy(o)}`,children:kl(i.userRoles)})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("span",{className:"text-[10px] font-black uppercase text-muted tracking-widest",children:[i.memberCount||0," member(s)"]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{onClick:()=>r(i),className:"p-2 text-muted hover:text-primary hover:bg-hud-accent rounded-xl transition-all duration-300 hover:scale-110",title:"Edit Campaign",children:d.jsx(db,{className:"w-4 h-4"})}),d.jsx("button",{onClick:()=>s(i),className:"p-2 text-muted hover:text-primary hover:bg-hud-accent rounded-xl transition-all duration-300 hover:scale-110",title:"Campaign Settings",children:d.jsx(hg,{className:"w-4 h-4"})}),d.jsx("button",{onClick:()=>a(i.id),className:"p-2 text-primary hover:bg-primary/10 rounded-xl transition-all duration-300 hover:scale-110",title:"Enter Campaign",children:d.jsx(Pu,{className:"w-4 h-4"})})]})]})]})}function hC({campaign:i,onViewCampaign:a}){const{characters:r}=id(i.id);return d.jsxs("div",{className:"card-modern relative group hover:border-primary/50 p-6",children:[d.jsxs("div",{className:"flex items-start justify-between mb-4",children:[d.jsx("h3",{className:"text-lg font-bold tracking-tight",children:i.name}),d.jsxs("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400",children:[r.length," CHARACTER",r.length!==1?"S":""]})]}),r.length===0?d.jsx("p",{className:"text-muted text-sm mb-4 italic",children:"No characters in this campaign yet."}):d.jsx("div",{className:"mb-4",children:d.jsxs("div",{className:"space-y-2",children:[r.slice(0,3).map(s=>d.jsxs("div",{className:"flex items-center text-sm",children:[d.jsx("div",{className:"w-2 h-2 bg-primary rounded-full mr-2 shadow-[0_0_8px_var(--color-primary-glow)]"}),d.jsx("span",{className:"text-text-main font-bold",children:s.characterName||s.displayName})]},s.id)),r.length>3&&d.jsxs("p",{className:"text-xs text-muted ml-4",children:["+",r.length-3," more characters"]})]})}),d.jsx("button",{onClick:()=>a(i.id),className:"w-full text-xs font-black uppercase tracking-widest text-primary hover:bg-primary/10 py-3 px-3 rounded-xl transition-all duration-300 mt-4",children:"View Campaign "})]})}function fC({campaigns:i,onSelect:a,onEdit:r,onSettings:s}){return d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-black tracking-tighter uppercase mb-6",children:"Campaign Management"}),d.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:i.map(o=>d.jsx(dC,{campaign:o,onSelect:a,onEdit:r,onSettings:s},o.id))})]})}function rg({campaigns:i,onViewCampaign:a}){const r=i.filter(s=>s.memberCount&&s.memberCount>0);return d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-black tracking-tighter uppercase mb-6",children:"Character Overview"}),r.length===0?d.jsx("div",{className:"card-modern p-8 text-center bg-hud-accent/50 border-dashed border-2",children:d.jsx("p",{className:"text-muted font-medium italic",children:"No characters in any campaigns yet. Create some characters to get started!"})}):d.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:r.map(s=>d.jsx(hC,{campaign:s,onViewCampaign:a},s.id))})]})}function yu(){const i=Ps(),a=aa(),{campaigns:r,loading:s,error:o,createCampaign:c,updateCampaign:h,deleteCampaign:m}=ky(),{fetchMembers:p,addMemberByEmail:g,removeMember:v,updateMemberRole:b}=WS(),[x,_]=S.useState(!1),[C,j]=S.useState(!1),[A,R]=S.useState(!1),[k,O]=S.useState(!1),[H,I]=S.useState(null),[V,re]=S.useState(""),[G,q]=S.useState(""),[K,de]=S.useState(!1),[ce,ie]=S.useState(null),F=async Q=>{const me=await c(Q);return me.success&&_(!1),me},pe=Q=>{I(Q),re(Q.name),q(Q.description||""),j(!0)},L=async Q=>{if(Q.preventDefault(),!!H){de(!0);try{(await h(H.id,{name:V.trim(),description:G.trim()||void 0})).success&&(j(!1),I(null))}finally{de(!1)}}},Y=Q=>{ie(Q),R(!0)},ae=async(Q,me,et)=>{const ze=sd(et);return await g(Q,me,ze)},ee=async(Q,me)=>{await v(Q,me)},J=async(Q,me,et)=>await b(Q,me,et),Ae=Q=>({id:Q.id,name:Q.name,description:Q.description||null,created_at:Q.createdAt.toISOString(),created_by:Q.createdBy,updated_at:Q.updatedAt.toISOString(),userRoles:Q.userRoles,member_count:Q.memberCount}),Ne=async Q=>{const me=await p(Q);return me.success?me.data:void 0};return s?d.jsx(XS,{message:"Loading dashboard..."}):d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"mb-12 flex flex-col md:flex-row md:items-end justify-between gap-6 animate-hud",children:d.jsxs("div",{children:[d.jsxs("h1",{className:"text-4xl md:text-5xl font-black tracking-tighter uppercase mb-2",children:[a.pathname==="/"&&d.jsxs(d.Fragment,{children:["Mission ",d.jsx("span",{className:"text-primary",children:"Control"})]}),a.pathname==="/campaigns"&&d.jsxs(d.Fragment,{children:["Tactical ",d.jsx("span",{className:"text-primary",children:"Campaigns"})]}),a.pathname==="/characters"&&d.jsxs(d.Fragment,{children:["Personnel ",d.jsx("span",{className:"text-primary",children:"Roster"})]})]}),d.jsxs("p",{className:"text-lg text-muted font-medium",children:[a.pathname==="/"&&"System Online. Welcome back, Commissioner.",a.pathname==="/campaigns"&&"Active theater operations and deployment logs.",a.pathname==="/characters"&&"Active personnel and biological signatures detected."]})]})}),d.jsxs("div",{className:"space-y-12",children:[d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[o&&d.jsx("div",{className:"lg:col-span-12 p-3 text-sm text-red-800 bg-red-100 dark:bg-red-900/20 dark:text-red-400 border border-red-200 dark:border-red-800 rounded-md mb-6",children:o}),d.jsxs("div",{className:"lg:col-span-8 space-y-8",children:[(a.pathname==="/"||a.pathname==="/campaigns")&&d.jsxs(d.Fragment,{children:[a.pathname==="/"&&d.jsx("div",{className:"animate-hud delay-100",children:d.jsx(oC,{campaigns:r,onCampaignSelect:Q=>i(`/campaign/${Q}`)})}),r.length>0&&d.jsx("div",{className:"animate-hud delay-200",children:d.jsx(fC,{campaigns:r,onSelect:Q=>i(`/campaign/${Q}`),onEdit:pe,onSettings:Y})})]}),a.pathname==="/characters"&&d.jsx("div",{className:"animate-hud",children:d.jsx(rg,{campaigns:r,onViewCampaign:Q=>i(`/campaign/${Q}`)})})]}),d.jsxs("div",{className:"lg:col-span-4 space-y-8",children:[d.jsxs("div",{className:"animate-hud delay-100",children:[d.jsx("h2",{className:"text-lg font-black tracking-tighter uppercase mb-4 px-2",children:"Quick Actions"}),d.jsxs("div",{className:"grid gap-4",children:[(a.pathname==="/"||a.pathname==="/campaigns")&&d.jsx(tg,{title:"New Campaign",description:"Deploy a new mission",icon:d.jsx(fg,{className:"w-6 h-6"}),onClick:()=>_(!0)}),(a.pathname==="/"||a.pathname==="/characters")&&d.jsx(tg,{title:"Characters",description:"Active personnel",icon:d.jsx(El,{className:"w-6 h-6"}),onClick:()=>O(!0)})]})]}),a.pathname==="/"&&d.jsx("div",{className:"animate-hud delay-200",children:d.jsx(lC,{onInvitationAccepted:()=>{}})})]})]}),a.pathname==="/"&&r.length>0&&d.jsx("div",{className:"animate-hud delay-300",children:d.jsx(rg,{campaigns:r,onViewCampaign:Q=>i(`/campaign/${Q}`)})})]}),d.jsx(rC,{isOpen:x,onClose:()=>_(!1),onCreateCampaign:F}),d.jsx(rt,{isOpen:C,onClose:()=>j(!1),title:"Edit Campaign",children:d.jsxs("form",{onSubmit:L,className:"space-y-4",children:[d.jsx(oe,{label:"Campaign Name",value:V,onChange:Q=>re(Q.target.value),placeholder:"Enter campaign name",required:!0}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Description (optional)"}),d.jsx("textarea",{value:G,onChange:Q=>q(Q.target.value),className:"input w-full",rows:3,placeholder:"Describe your campaign"})]}),d.jsx(_n,{onCancel:()=>j(!1),cancelText:"Cancel",confirmText:K?"Updating...":"Update Campaign",confirmDisabled:K||!V.trim(),confirmType:"submit",isLoading:K})]})}),ce&&d.jsx(rt,{isOpen:A,onClose:()=>R(!1),title:"Campaign Settings",maxWidth:"xl",children:d.jsx(ZS,{campaign:Ae(ce),onClose:()=>R(!1),onGetMembers:Ne,onAddMember:ae,onRemoveMember:ee,onUpdateMemberRole:J,onUpdateCampaign:async(Q,me)=>{await h(Q,{name:me.name,description:me.description||void 0})},onDeleteCampaign:async Q=>{(await m(Q)).success&&(R(!1),ie(null))}})}),d.jsx(rt,{isOpen:k,onClose:()=>O(!1),title:"Your Characters",maxWidth:"xl",children:d.jsx(aC,{campaigns:r})})]})}const mC=[{name:"Autopistol",type:"Slug Pistol",damage:"3d6-3",range:"10m",mass:1,cost:200,magazine:15,traits:["Auto 2"],tl:5,notes:"Common sidearm",source:"Core Rulebook"},{name:"Revolver",type:"Slug Pistol",damage:"3d6-3",range:"10m",mass:1,cost:150,magazine:6,traits:[],tl:4,notes:"Reliable, simple design",source:"Core Rulebook"},{name:"Snub Pistol",type:"Slug Pistol",damage:"3d6-3",range:"5m",mass:.5,cost:150,magazine:6,traits:["Zero-G"],tl:8,notes:"Designed for spacecraft use",source:"Core Rulebook"},{name:"Body Pistol",type:"Slug Pistol",damage:"3d6-3",range:"5m",mass:.25,cost:500,magazine:6,traits:[],tl:7,notes:"Easily concealed, non-metallic",source:"Core Rulebook"},{name:"Accelerator Rifle",type:"Slug Rifle",damage:"3d6",range:"250m",mass:4,cost:900,magazine:15,traits:["Auto 2","Scope"],tl:9,notes:"Magnetically accelerated projectiles",source:"Core Rulebook"},{name:"Advanced Combat Rifle",type:"Slug Rifle",damage:"3d6",range:"250m",mass:4,cost:1e3,magazine:40,traits:["Auto 3","Scope"],tl:9,notes:"Modern military standard",source:"Core Rulebook"},{name:"Assault Rifle",type:"Slug Rifle",damage:"3d6",range:"200m",mass:4,cost:300,magazine:30,traits:["Auto 3"],tl:7,notes:"Common military weapon",source:"Core Rulebook"},{name:"Autorifle",type:"Slug Rifle",damage:"3d6",range:"200m",mass:5,cost:200,magazine:20,traits:["Auto 2"],tl:6,notes:"Early automatic rifle",source:"Core Rulebook"},{name:"Rifle",type:"Slug Rifle",damage:"3d6",range:"250m",mass:4,cost:200,magazine:10,traits:[],tl:5,notes:"Standard bolt-action rifle",source:"Core Rulebook"},{name:"Shotgun",type:"Slug Rifle",damage:"4d6",range:"20m",range_long:"50m",mass:4,cost:200,magazine:10,traits:["Bulky"],tl:4,notes:"Can fire shot or slugs",source:"Core Rulebook"},{name:"Gauss Rifle",type:"Energy Rifle",damage:"4d6",range:"500m",mass:4,cost:1500,magazine:80,traits:["AP 3","Auto 3","Scope"],tl:12,notes:"Electromagnetically accelerated",source:"Core Rulebook"},{name:"Gauss Pistol",type:"Energy Pistol",damage:"3d6",range:"50m",mass:.5,cost:500,magazine:40,traits:["AP 3"],tl:12,notes:"Compact gauss weapon",source:"Core Rulebook"},{name:"Laser Carbine",type:"Energy Rifle",damage:"4d6",range:"250m",mass:4,cost:2500,magazine:50,traits:["Zero-G"],tl:9,notes:"Lightweight laser weapon",source:"Core Rulebook"},{name:"Laser Rifle",type:"Energy Rifle",damage:"5d6",range:"300m",mass:5,cost:3500,magazine:100,traits:["Zero-G"],tl:9,notes:"Standard energy weapon",source:"Core Rulebook"},{name:"Laser Pistol",type:"Energy Pistol",damage:"3d6+3",range:"50m",mass:2,cost:1500,magazine:50,traits:["Zero-G"],tl:9,notes:"Personal energy weapon",source:"Core Rulebook"},{name:"Plasma Rifle",type:"Energy Rifle",damage:"6d6",range:"100m",mass:6,cost:7e3,magazine:10,traits:["AP 10","Bulky","Blast 3"],tl:11,notes:"Superheated plasma bolts",source:"Core Rulebook"},{name:"Plasma Pistol",type:"Energy Pistol",damage:"4d6",range:"20m",mass:2,cost:4e3,magazine:10,traits:["AP 5","Blast 1"],tl:11,notes:"Compact plasma weapon",source:"Core Rulebook"},{name:"Stunner",type:"Energy Pistol",damage:"2d6 (stun)",range:"10m",mass:1,cost:500,magazine:100,traits:["Stun","Zero-G"],tl:8,notes:"Non-lethal energy weapon",source:"Core Rulebook"},{name:"Neural Disruptor",type:"Energy Pistol",damage:"Special",range:"5m",mass:.5,cost:2500,magazine:20,traits:["Stun","Illegal"],tl:11,notes:"Disrupts neural activity",source:"Core Rulebook"},{name:"Grenade Launcher",type:"Heavy Weapon",damage:"Varies",range:"250m",mass:6,cost:400,magazine:6,traits:["Bulky"],tl:7,notes:"Fires grenades",source:"Core Rulebook"},{name:"RAM Grenade Launcher",type:"Heavy Weapon",damage:"Varies",range:"250m",mass:5,cost:800,magazine:6,traits:["Bulky","Auto 3"],tl:8,notes:"Rocket Assisted Multi-purpose",source:"Core Rulebook"},{name:"Machine Gun",type:"Heavy Weapon",damage:"3d6",range:"500m",mass:10,cost:1200,magazine:100,traits:["Auto 4","Bulky"],tl:7,notes:"Crew-served weapon",source:"Core Rulebook"},{name:"Advanced Machine Gun",type:"Heavy Weapon",damage:"3d6+2",range:"600m",mass:8,cost:1800,magazine:100,traits:["Auto 4","Bulky"],tl:8,notes:"Improved crew-served weapon",source:"Core Rulebook"},{name:"PGMP (Plasma Gun, Man Portable)",type:"Heavy Weapon",damage:"1d6 x 10",range:"300m",mass:8,cost:2e4,magazine:10,traits:["AP 20","Bulky","Blast 6"],tl:13,notes:"Man-portable plasma cannon",source:"Core Rulebook"},{name:"FGMP (Fusion Gun, Man Portable)",type:"Heavy Weapon",damage:"2d6 x 10",range:"300m",mass:12,cost:5e4,magazine:20,traits:["AP 30","Bulky","Blast 9","Radiation"],tl:14,notes:"Man-portable fusion weapon",source:"Core Rulebook"},{name:"Rocket Launcher",type:"Heavy Weapon",damage:"Varies",range:"500m",mass:8,cost:2e3,magazine:1,traits:["Bulky"],tl:7,notes:"Anti-vehicle weapon",source:"Core Rulebook"},{name:"Flamethrower",type:"Heavy Weapon",damage:"4d6",range:"20m",mass:12,cost:500,magazine:10,traits:["Bulky","Blast 3","Fire"],tl:6,notes:"Area effect flame weapon",source:"Core Rulebook"},{name:"Dagger",type:"Blade",damage:"1d6+2",range:"Melee",mass:.25,cost:10,magazine:null,traits:[],tl:1,notes:"Small blade weapon",source:"Core Rulebook"},{name:"Knife",type:"Blade",damage:"1d6+2",range:"Melee",mass:.25,cost:10,magazine:null,traits:[],tl:1,notes:"Utility/combat knife",source:"Core Rulebook"},{name:"Cutlass",type:"Blade",damage:"2d6+2",range:"Melee",mass:1,cost:100,magazine:null,traits:[],tl:2,notes:"Curved sword",source:"Core Rulebook"},{name:"Sword",type:"Blade",damage:"3d6",range:"Melee",mass:1,cost:200,magazine:null,traits:[],tl:2,notes:"Standard sword",source:"Core Rulebook"},{name:"Blade",type:"Blade",damage:"2d6+4",range:"Melee",mass:2,cost:250,magazine:null,traits:[],tl:4,notes:"Modern combat blade",source:"Core Rulebook"},{name:"Club",type:"Bludgeon",damage:"2d6",range:"Melee",mass:1,cost:5,magazine:null,traits:[],tl:0,notes:"Simple bludgeon",source:"Core Rulebook"},{name:"Improvised Weapon",type:"Bludgeon",damage:"1d6",range:"Melee",mass:1,cost:0,magazine:null,traits:[],tl:0,notes:"Any makeshift weapon",source:"Core Rulebook"},{name:"Broadsword",type:"Blade",damage:"4d6",range:"Melee",mass:2,cost:500,magazine:null,traits:["Bulky"],tl:3,notes:"Large two-handed sword",source:"Core Rulebook"},{name:"Polearm",type:"Blade",damage:"3d6+3",range:"Melee (reach)",mass:3,cost:100,magazine:null,traits:["Bulky","Reach"],tl:2,notes:"Spear, halberd, etc.",source:"Core Rulebook"},{name:"Pike",type:"Blade",damage:"3d6+2",range:"Melee (reach)",mass:4,cost:40,magazine:null,traits:["Bulky","Reach"],tl:2,notes:"Very long spear",source:"Core Rulebook"},{name:"Frag Grenade",type:"Grenade",damage:"5d6",range:"Thrown (20m)",mass:.5,cost:30,magazine:null,traits:["Blast 6"],tl:6,notes:"Fragmentation grenade",source:"Core Rulebook"},{name:"Smoke Grenade",type:"Grenade",damage:"None",range:"Thrown (20m)",mass:.25,cost:15,magazine:null,traits:["Smoke","Blast 6"],tl:6,notes:"Creates smoke screen",source:"Core Rulebook"},{name:"Stun Grenade",type:"Grenade",damage:"3d6 (stun)",range:"Thrown (20m)",mass:.25,cost:30,magazine:null,traits:["Stun","Blast 3"],tl:7,notes:"Non-lethal grenade",source:"Core Rulebook"},{name:"Aerosol Grenade",type:"Grenade",damage:"Special",range:"Thrown (20m)",mass:.25,cost:20,magazine:null,traits:["Blast 6"],tl:7,notes:"Disperses chemical agent",source:"Core Rulebook"},{name:"Snare Pistol",type:"Special",damage:"Special",range:"10m",mass:.5,cost:150,magazine:1,traits:["Entangle"],tl:8,notes:"Fires entangling net",source:"Core Rulebook"},{name:"Shotgun Pistol",type:"Slug Pistol",damage:"3d6",range:"10m",mass:1.5,cost:150,magazine:4,traits:[],tl:5,notes:"Compact shotgun",source:"Core Rulebook"},{name:"Submachine Gun",type:"Slug Rifle",damage:"3d6-3",range:"30m",mass:2.5,cost:250,magazine:30,traits:["Auto 3"],tl:6,notes:"Compact automatic weapon",source:"Core Rulebook"},{name:"Carbine",type:"Slug Rifle",damage:"3d6",range:"100m",mass:3,cost:200,magazine:10,traits:[],tl:5,notes:"Shortened rifle",source:"Core Rulebook"},{name:"Crossbow",type:"Projectile",damage:"3d6",range:"50m",mass:2,cost:75,magazine:1,traits:["Silent"],tl:2,notes:"Mechanical bow",source:"Core Rulebook"},{name:"Bow",type:"Projectile",damage:"2d6",range:"75m",mass:1,cost:60,magazine:1,traits:["Silent"],tl:1,notes:"Traditional bow",source:"Core Rulebook"}],pC=["Slug Pistol","Slug Rifle","Energy Pistol","Energy Rifle","Heavy Weapon","Blade","Bludgeon","Grenade","Projectile","Special"],gC={AP:"Armor Piercing - Reduces armor protection",Auto:"Automatic fire - Can fire multiple shots",Blast:"Area effect - Damages everything in radius",Bulky:"Large and cumbersome weapon",Fire:"Sets targets ablaze",Illegal:"Banned by most governments",Radiation:"Causes radiation damage",Reach:"Extended melee range",Scope:"Includes targeting scope",Silent:"Makes no noise when fired",Smoke:"Creates concealing smoke",Stun:"Non-lethal incapacitation","Zero-G":"Functions normally in zero gravity",Entangle:"Restricts target movement"},Uy={weapons:mC,weaponTypes:pC,traits:gC},zy="traveller-ui-state-v1",ng={Party_Finances:[],Ship_Accounts:[],Ship_Cargo:[],Ship_Maintenance_Log:[],Loans_Mortgage:[],Party_Inventory:[],Ammo_Tracker:[],PCs:{}};function yC(){try{const i=localStorage.getItem(zy);if(!i)return ng;const a=JSON.parse(i);return a.PCs||(a.PCs={}),Object.keys(a.PCs).forEach(r=>{a.PCs[r].Finance||(a.PCs[r].Finance=[]),a.PCs[r].Inventory||(a.PCs[r].Inventory=[]),a.PCs[r].Weapons||(a.PCs[r].Weapons=[]),a.PCs[r].Armour||(a.PCs[r].Armour=[]),a.PCs[r].Ammo||(a.PCs[r].Ammo=[])}),a}catch{return ng}}function vC(i){localStorage.setItem(zy,JSON.stringify(i))}function vu(i){const a=yC();a.PCs[i]||(a.PCs[i]={Finance:[],Inventory:[],Weapons:[],Armour:[],Ammo:[]},vC(a))}function bC(i){const a=S.useCallback((o,c,h)=>{i(m=>{m.PCs[o]||vu(o);const p=m.PCs[o]||{Finance:[],Inventory:[],Weapons:[],Armour:[],Ammo:[]};return{...m,PCs:{...m.PCs,[o]:{...p,Ammo:(p.Ammo||[]).map((g,v)=>v===c?h:g)}}}})},[i]),r=S.useCallback((o,c)=>{i(h=>{if(!h.PCs[o])return vu(o),h;const m=h.PCs[o]?.Ammo?.[c];if(!m)return h;const p=Number(m["Rounds Loaded"]||0),g=Number(m["Spare Magazines"]||0),v=Number(m["Loose Rounds"]||0),b=Number(m["Magazine Size"]||0);let x=p,_=g,C=v;if(x>0)x-=1;else if(_>0)_-=1,x=b-1;else if(C>0&&b>0){const R=Math.min(C,b);C-=R,x=R-1}else return h;const j=x+_*b+C,A={...m,"Rounds Loaded":x,"Spare Magazines":_,"Loose Rounds":C,"Total Rounds":j};return{...h,PCs:{...h.PCs,[o]:{...h.PCs[o],Ammo:(h.PCs[o].Ammo||[]).map((R,k)=>k===c?A:R)}}}})},[i]),s=S.useCallback((o,c)=>{i(h=>{if(!h.PCs[o])return vu(o),h;const m=h.PCs[o]?.Ammo?.[c];if(!m)return h;const p=Number(m["Rounds Loaded"]||0),g=Number(m["Spare Magazines"]||0),v=Number(m["Loose Rounds"]||0),b=Number(m["Magazine Size"]||0);let x=p,_=g,C=v;if(_>0&&x<b)_-=1,x=b;else if(C>0&&x<b){const R=b-x,k=Math.min(C,R);C-=k,x+=k}const j=x+_*b+C,A={...m,"Rounds Loaded":x,"Spare Magazines":_,"Loose Rounds":C,"Total Rounds":j};return{...h,PCs:{...h.PCs,[o]:{...h.PCs[o],Ammo:(h.PCs[o].Ammo||[]).map((R,k)=>k===c?A:R)}}}})},[i]);return{updateCharacterAmmo:a,fireRound:r,reloadWeapon:s}}const xC={Party_Finances:[],Ship_Accounts:[],Ship_Cargo:[],Ship_Maintenance_Log:[],Loans_Mortgage:[],Party_Inventory:[],Ammo_Tracker:[],PCs:{}};function _C(){const[i,a]=S.useState(xC),r=S.useCallback(b=>{a(x=>({...x,Party_Finances:b}))},[]),s=S.useCallback(b=>{a(x=>({...x,Ship_Accounts:b}))},[]),o=S.useCallback(b=>{a(x=>({...x,Ship_Cargo:[...x.Ship_Cargo,b]}))},[]),c=S.useCallback((b,x)=>{a(_=>({..._,PCs:{..._.PCs,[b]:{..._.PCs[b]||{Finance:[],Inventory:[],Weapons:[],Armour:[],Ammo:[]},Finance:x}}}))},[]),h=S.useCallback((b,x)=>{a(_=>{const C=_.PCs[b]||{Finance:[],Inventory:[],Weapons:[],Armour:[],Ammo:[]};return{..._,PCs:{..._.PCs,[b]:{...C,Inventory:[...C.Inventory,x]}}}})},[]),m=S.useCallback((b,x)=>{a(_=>{const C=_.PCs[b]||{Finance:[],Inventory:[],Weapons:[],Armour:[],Ammo:[]},j=C.Ammo||[],A=C.Finance||[],R=j.findIndex(H=>H.Weapon===x.Weapon&&H["Ammo Type"]===x["Ammo Type"]);let k;if(R>=0){k=[...j];const H=k[R];k[R]={...H,"Spare Magazines":Number(H["Spare Magazines"]||0)+Number(x["Spare Magazines"]||0),"Loose Rounds":Number(H["Loose Rounds"]||0)+Number(x["Loose Rounds"]||0)}}else k=[...j,x];let O=A;if(x.Cost&&x.Cost>0){const H={Date:new Date().toISOString().split("T")[0],Description:`Purchased ${x["Ammo Type"]} for ${x.Weapon}`,Category:"Expense",Subcategory:"Ammo","Amount (Cr)":Math.abs(x.Cost),"Paid By":b,Notes:x.Notes||""};O=[...A,H]}return{..._,PCs:{..._.PCs,[b]:{...C,Ammo:k,Finance:O}}}})},[]),p=S.useCallback((b,x)=>{a(_=>{const C=_.PCs[b]||{Finance:[],Inventory:[],Weapons:[],Armour:[],Ammo:[]},j=Uy.weapons.find(k=>k.name===x.Weapon);let A=C.Ammo||[];j&&j.magazine!==null&&j.magazine>0&&A.findIndex(O=>O.Weapon===x.Weapon)===-1&&(A=[...A,{Weapon:x.Weapon,"Ammo Type":x.Type||"","Magazine Size":j.magazine,"Rounds Loaded":0,"Spare Magazines":0,"Loose Rounds":0,Notes:"Auto-created with weapon"}]);let R=C.Finance||[];if(x.Cost&&x.Cost>0){const k={Date:new Date().toISOString().split("T")[0],Description:`Purchased ${x.Weapon}`,Category:"Expense",Subcategory:"Weapons","Amount (Cr)":Math.abs(x.Cost),"Paid By":b,Notes:x.Notes||""};R=[...R,k]}return{..._,PCs:{..._.PCs,[b]:{...C,Weapons:[...C.Weapons||[],x],Ammo:A,Finance:R}}}})},[]),g=S.useCallback((b,x)=>{a(_=>{const C=_.PCs[b]||{Finance:[],Inventory:[],Weapons:[],Armour:[],Ammo:[]};let j=C.Finance||[];if(x.Cost&&x.Cost>0){const A={Date:new Date().toISOString().split("T")[0],Description:`Purchased ${x.Armour}`,Category:"Expense",Subcategory:"Armour","Amount (Cr)":Math.abs(x.Cost),"Paid By":b,Notes:x.Notes||""};j=[...j,A]}return{..._,PCs:{..._.PCs,[b]:{...C,Armour:[...C.Armour||[],x],Finance:j}}}})},[]),v=bC(a);return{state:i,setState:a,updatePartyFinances:r,updateShipAccounts:s,addCargoLeg:o,updateCharacterFinance:c,addCharacterInventory:h,addCharacterAmmo:m,addCharacterWeapon:p,addCharacterArmour:g,...v}}function wC(i){const[a,r]=S.useState([]),[s,o]=S.useState([]),[c,h]=S.useState([]),[m,p]=S.useState([]),[g,v]=S.useState([]),[b,x]=S.useState([]),[_,C]=S.useState([]),[j,A]=S.useState(!0),[R,k]=S.useState(null),O=b_();S.useEffect(()=>{if(!i){A(!1);return}(async()=>{try{A(!0),k(null);const F=await O.getAllCampaignData(i);r(F.finances),o(F.shipFinances),h(F.cargo),p(F.maintenance),v(F.loans),x(F.partyInventory),C(F.ammo)}catch(F){console.error("Failed to load campaign data:",F),k(F instanceof Error?F:new Error("Failed to load campaign data"))}finally{A(!1)}})()},[i]);const H=S.useCallback(async ie=>{if(i)try{const F=ie.filter(J=>!J.id),pe=ie.filter(J=>!!J.id),L=F.map(J=>O.addCampaignFinance(i,J)),Y=await Promise.all(L),ae=pe.map(J=>O.updateCampaignFinance(J.id,J));await Promise.all(ae);const ee=ie.map(J=>{if(J.id)return J;const Ae=F.indexOf(J);return Y[Ae]});r(ee)}catch(F){throw console.error("Failed to update party finances:",F),F}},[i,O]),I=S.useCallback(async ie=>{if(i)try{const F=await O.addCampaignFinance(i,ie);r(pe=>[F,...pe])}catch(F){throw console.error("Failed to add party finance:",F),F}},[i,O]),V=S.useCallback(async ie=>{if(i)try{const F=ie.filter(J=>!J.id),pe=ie.filter(J=>!!J.id),L=F.map(J=>O.addShipFinance(i,J)),Y=await Promise.all(L),ae=pe.map(J=>O.updateShipFinance(J.id,J));await Promise.all(ae);const ee=ie.map(J=>{if(J.id)return J;const Ae=F.indexOf(J);return Y[Ae]});o(ee)}catch(F){throw console.error("Failed to update ship finances:",F),F}},[i,O]),re=S.useCallback(async ie=>{if(i)try{const F=await O.addShipFinance(i,ie);o(pe=>[F,...pe])}catch(F){throw console.error("Failed to add ship finance:",F),F}},[i,O]),G=S.useCallback(async ie=>{if(i)try{const F=await O.addShipCargo(i,ie);h(pe=>[F,...pe])}catch(F){throw console.error("Failed to add cargo:",F),F}},[i,O]),q=S.useCallback(async ie=>{if(i)try{const F=await O.addShipMaintenance(i,ie);p(pe=>[F,...pe])}catch(F){throw console.error("Failed to add maintenance:",F),F}},[i,O]),K=S.useCallback(async ie=>{if(i)try{const F=await O.addCampaignLoan(i,ie);v(pe=>[F,...pe])}catch(F){throw console.error("Failed to add loan:",F),F}},[i,O]),de=S.useCallback(async ie=>{if(i)try{const F=await O.addPartyInventoryItem(i,ie);x(pe=>[F,...pe])}catch(F){throw console.error("Failed to add party inventory item:",F),F}},[i,O]),ce=S.useCallback(async ie=>{if(i)try{const F=await O.addCampaignAmmo(i,ie);C(pe=>[F,...pe])}catch(F){throw console.error("Failed to add campaign ammo:",F),F}},[i,O]);return{partyFinances:a,shipFinances:s,shipCargo:c,shipMaintenance:m,loans:g,partyInventory:b,campaignAmmo:_,isLoading:j,error:R,updatePartyFinances:H,addPartyFinance:I,updateShipAccounts:V,addShipFinance:re,addCargoLeg:G,addShipMaintenance:q,addLoan:K,addPartyInventoryItem:de,addCampaignAmmo:ce}}function SC(i){const[a,r]=S.useState([]),[s,o]=S.useState([]),[c,h]=S.useState([]),[m,p]=S.useState([]),[g,v]=S.useState([]),[b,x]=S.useState(!0),[_,C]=S.useState(null),j=v_();S.useEffect(()=>{if(!i){x(!1),r([]),o([]),h([]),p([]),v([]);return}(async()=>{try{x(!0),C(null);const[q,K,de,ce,ie]=await Promise.all([j.getCharacterFinance(i),j.getCharacterInventory(i),j.getCharacterWeapons(i),j.getCharacterArmour(i),j.getCharacterAmmo(i)]);q.success&&q.data&&r(q.data.map(bu)),K.success&&K.data&&o(K.data.map(sg)),de.success&&de.data&&h(de.data.map(ig)),ce.success&&ce.data&&p(ce.data.map(lg)),ie.success&&ie.data&&v(ie.data.map(og))}catch(q){console.error("Failed to load character data:",q),C(q instanceof Error?q:new Error("Failed to load character data"))}finally{x(!1)}})()},[i]);const A=S.useCallback(async G=>{if(i)try{const q=G.filter(F=>!F.id),K=q.map(F=>j.addCharacterFinance(i,F.Description,F["Amount (Cr)"])),ce=(await Promise.all(K)).filter(F=>F.success&&!!F.data).map(F=>bu(F.data)),ie=G.map(F=>{if(F.id)return F;const pe=q.indexOf(F);return ce[pe]});r(ie)}catch(q){throw console.error("Failed to update character finances:",q),q}},[i,j]),R=S.useCallback(async(G,q)=>{if(i)try{const K=await j.addCharacterFinance(i,G,q);if(K.success&&K.data){const de=bu(K.data);r(ce=>[de,...ce])}}catch(K){throw console.error("Failed to add finance:",K),K}},[i,j]),k=S.useCallback(async G=>{if(i)try{const q={itemName:G.Item,quantity:G.Qty||1,weight:G["Unit Mass (kg)"],value:G["Unit Value (Cr)"],description:G.Notes},K=await j.addCharacterInventory(i,q);if(K.success&&K.data){const de=sg(K.data);o(ce=>[...ce,de])}}catch(q){throw console.error("Failed to add inventory:",q),q}},[i,j]),O=S.useCallback(async G=>{if(i)try{const q={name:G.Weapon,damage:G.Damage,range:G.Range,weight:typeof G.Mass=="number"?G.Mass:void 0,cost:G.Cost,notes:G.Notes},K=await j.addCharacterWeapon(i,q);if(K.success&&K.data){const de=ig(K.data);h(ce=>[...ce,de])}}catch(q){throw console.error("Failed to add weapon:",q),q}},[i,j]),H=S.useCallback(async G=>{if(i)try{const q={name:G.Armour,protection:typeof G.Protection=="number"?G.Protection:void 0,weight:typeof G.Mass=="number"?G.Mass:void 0,cost:G.Cost,notes:G.Notes},K=await j.addCharacterArmour(i,q);if(K.success&&K.data){const de=lg(K.data);p(ce=>[...ce,de])}}catch(q){throw console.error("Failed to add armour:",q),q}},[i,j]),I=S.useCallback(async G=>{if(i)try{const q={type:G.Weapon,quantity:G["Total Rounds"]||0,maxQuantity:typeof G["Magazine Size"]=="number"?G["Magazine Size"]:void 0,weaponCompatibility:G["Ammo Type"],notes:G.Notes},K=await j.addCharacterAmmo(i,q);if(K.success&&K.data){const de=og(K.data);v(ce=>[...ce,de])}}catch(q){throw console.error("Failed to add ammo:",q),q}},[i,j]),V=S.useCallback(async G=>{if(!i||G<0||G>=g.length)return;const q=g[G],K=q["Total Rounds"]||0;if(K<=0)return;const de=[...g];if(de[G]={...q,"Total Rounds":K-1},v(de),q.id)try{await j.updateCharacterAmmo(q.id,cg(de[G]))}catch(ce){console.error("Failed to update ammo in database:",ce),v(g)}},[i,g,j]),re=S.useCallback(async G=>{if(!i||G<0||G>=g.length)return;const q=g[G],K=typeof q["Magazine Size"]=="number"?q["Magazine Size"]:0,de=[...g];if(de[G]={...q,"Rounds Loaded":K},v(de),q.id)try{await j.updateCharacterAmmo(q.id,cg(de[G]))}catch(ce){console.error("Failed to update ammo in database:",ce),v(g)}},[i,g,j]);return{finance:a,inventory:s,weapons:c,armour:m,ammo:g,isLoading:b,error:_,updateFinance:A,addFinance:R,addInventory:k,addWeapon:O,addArmour:H,addAmmo:I,fireRound:V,reloadWeapon:re}}function bu(i){return{Date:i.transactionDate.toISOString().split("T")[0],Description:i.description,Category:"Income",Subcategory:void 0,"Amount (Cr)":i.amount,"Paid By":void 0,"Paid From (Fund)":void 0,"Running Total":void 0,Notes:void 0}}function sg(i){return{Item:i.itemName,Qty:i.quantity,"Unit Mass (kg)":i.weight,"Total Mass (kg)":i.weight?i.weight*i.quantity:void 0,"Unit Value (Cr)":i.value,"Total Value (Cr)":i.value?i.value*i.quantity:void 0,"Location/Container":void 0,Notes:i.description}}function ig(i){return{Weapon:i.name,Type:void 0,Damage:i.damage,Range:i.range,Mass:i.weight,Cost:i.cost,Notes:i.notes}}function lg(i){return{Armour:i.name,Type:void 0,Protection:i.protection,Mass:i.weight,Cost:i.cost,Notes:i.notes}}function og(i){return{id:i.id,Weapon:i.type,"Ammo Type":i.weaponCompatibility,"Magazine Size":i.maxQuantity,"Rounds Loaded":void 0,"Spare Magazines":void 0,"Loose Rounds":void 0,"Total Rounds":i.quantity,Cost:void 0,Notes:i.notes}}function cg(i){return{type:i.Weapon,quantity:typeof i["Total Rounds"]=="number"?i["Total Rounds"]:void 0,maxQuantity:typeof i["Magazine Size"]=="number"?i["Magazine Size"]:void 0,weaponCompatibility:i["Ammo Type"],notes:i.Notes}}function CC(i,a=0){let r=a;return i.map(s=>{const o=s["Amount (Cr)"],c=s.Category;return c==="Income"?r+=o:c==="Expense"&&(r-=o),{...s,"Running Total":r}})}function bl(i,a=0){return i.reduce((r,s)=>{const o=s["Amount (Cr)"],c=s.Category;return c==="Income"?r+o:c==="Expense"?r-o:r},a)}function jC(i,a,r=0){const s=[...i,a];return s.sort((o,c)=>new Date(o.Date).getTime()-new Date(c.Date).getTime()),CC(s,r)}function AC(i){const a=[];return i.Description?.trim()||a.push("Description is required"),i.Date||a.push("Date is required"),(i["Amount (Cr)"]===void 0||i["Amount (Cr)"]===null)&&a.push("Amount is required"),typeof i["Amount (Cr)"]=="number"&&i["Amount (Cr)"]<0&&a.push("Amount must be positive (use Expense category for negative impact)"),["Income","Expense","Transfer"].includes(i.Category||"")||a.push("Category must be Income, Expense, or Transfer"),{isValid:a.length===0,errors:a}}function NC(i){return`${i.toLocaleString()} Cr`}function EC(i){const a=i.reduce((r,s)=>{const o=s["Amount (Cr)"];return s.Category==="Income"?r.totalIncome+=o:s.Category==="Expense"&&(r.totalExpenses+=o),r.transactionCount++,r},{totalIncome:0,totalExpenses:0,transactionCount:0});return{...a,netChange:a.totalIncome-a.totalExpenses}}function RC(i,a){return S.useMemo(()=>({party:bl(i.Party_Finances,0),ship:bl(i.Ship_Accounts,0),character:bl(i.PCs[a]?.Finance||[],0)}),[i.Party_Finances,i.Ship_Accounts,i.PCs,a])}function TC(i,a){const r=S.useCallback(async o=>{try{const{importXlsx:c}=await Nl(async()=>{const{importXlsx:h}=await import("./xlsx-C9OvYgdp.js");return{importXlsx:h}},__vite__mapDeps([0,1,2,3]));return await c(o,i),{success:!0}}catch(c){return{success:!1,error:c instanceof Error?c.message:"Unknown error occurred"}}},[i]),s=S.useCallback(async()=>{try{const{exportXlsx:o}=await Nl(async()=>{const{exportXlsx:c}=await import("./xlsx-C9OvYgdp.js");return{exportXlsx:c}},__vite__mapDeps([0,1,2,3]));return await o(a),{success:!0}}catch(o){return{success:!1,error:o instanceof Error?o.message:"Unknown error occurred"}}},[a]);return{handleImport:r,handleExport:s}}function kC({onImport:i,onExport:a}){const r=async o=>{const c=o.target.files?.[0];c&&((await i(c)).success||(o.target.value=""))},s=async()=>{await a()};return d.jsx("div",{className:"flex flex-wrap items-center justify-end gap-3",children:d.jsxs("div",{className:"flex items-center gap-4",role:"group","aria-label":"Mission Data Operations",children:[d.jsxs("label",{className:"btn-hud py-2.5 px-6 !rounded-xl !text-xs cursor-pointer bg-side !text-main hover:bg-hud-accent border border-border transition-all duration-300 shadow-sm","data-testid":"import-button",tabIndex:0,children:[d.jsx("input",{type:"file",accept:".xlsx,.xls",className:"hidden",onChange:r,"data-testid":"file-input"}),d.jsx(hb,{className:"w-4 h-4 text-primary","aria-hidden":"true"}),d.jsx("span",{className:"font-black uppercase tracking-widest",children:"Import Data"})]}),d.jsxs("button",{onClick:s,className:"btn-hud py-2.5 px-6 !rounded-xl !text-xs bg-primary text-white shadow-lg shadow-primary-glow/20 transition-all duration-300 hover:scale-105 active:scale-95","data-testid":"export-button",children:[d.jsx(fb,{className:"w-4 h-4","aria-hidden":"true"}),d.jsx("span",{className:"font-black uppercase tracking-widest",children:"Export Data"})]})]})})}const Lu=i=>`${new Intl.NumberFormat(void 0,{style:"decimal",maximumFractionDigits:0}).format(i)} Cr`,OC=()=>new Date().toISOString().slice(0,10);function DC({partyBalance:i,shipBalance:a,cargoLegsCount:r,characterCount:s}){const o=[{label:"Party Fund",value:Lu(i),icon:d.jsx(mg,{className:"w-5 h-5"}),color:"text-primary"},{label:"Ship Fund",value:Lu(a),icon:d.jsx(mb,{className:"w-5 h-5"}),color:"text-blue-400"},{label:"Active Cargo",value:r,icon:d.jsx($u,{className:"w-5 h-5"}),color:"text-amber-400"},{label:"Personnel",value:s,icon:d.jsx(Bs,{className:"w-5 h-5"}),color:"text-emerald-400"}];return d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",role:"region","aria-label":"Campaign statistics",children:o.map((c,h)=>d.jsxs("div",{className:"hud-glass p-5 relative overflow-hidden group hover:scale-[1.02] transition-transform duration-300",style:{animationDelay:`${h*100}ms`},children:[d.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-primary/30 group-hover:bg-primary transition-colors"}),d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"space-y-1",children:[d.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-muted group-hover:text-text-main transition-colors",children:c.label}),d.jsx("h3",{className:"text-2xl font-black tracking-tight font-heading",children:c.value})]}),d.jsx("div",{className:`p-2.5 rounded-xl bg-white/5 ${c.color} shadow-inner`,children:c.icon})]}),d.jsx("div",{className:"absolute bottom-1 right-1 opacity-20 group-hover:opacity-100 transition-opacity",children:d.jsx("div",{className:"w-4 h-4 border-r-2 border-b-2 border-primary/40"})})]},c.label))})}function Ly({tabs:i,active:a,onChange:r}){const s=o=>{const c=i.findIndex(p=>p.id===a);let h=c;switch(o.key){case"ArrowLeft":o.preventDefault(),h=c>0?c-1:i.length-1;break;case"ArrowRight":o.preventDefault(),h=c<i.length-1?c+1:0;break;case"Home":o.preventDefault(),h=0;break;case"End":o.preventDefault(),h=i.length-1;break;default:return}const m=i[h].id;r(m)};return d.jsx("div",{className:"flex flex-wrap p-1.5 gap-2 hud-glass rounded-2xl w-fit mb-8 shadow-inner",role:"tablist","aria-label":"Campaign navigation",children:i.map(o=>{const c=a===o.id;return d.jsxs("button",{onClick:()=>r(o.id),onKeyDown:s,className:`relative px-6 py-2.5 rounded-xl transition-all duration-300 group ${c?"bg-primary text-white shadow-lg shadow-primary-glow scale-105":"text-muted hover:text-text-main hover:bg-white/5"}`,role:"tab","aria-selected":c,"aria-controls":`tabpanel-${o.id}`,id:`tab-${o.id}`,type:"button",tabIndex:c?0:-1,children:[d.jsx("span",{className:"relative z-10 font-black text-[11px] uppercase tracking-[0.15em]",children:o.label}),c&&d.jsx("div",{className:"absolute inset-0 border border-white/20 rounded-xl"}),!c&&d.jsx("div",{className:"absolute -bottom-1 left-1.5 right-1.5 h-[1px] bg-primary/0 group-hover:bg-primary/40 transition-all rounded-full"})]},o.id)})})}function Tn({columns:i,rows:a}){const r=s=>S.isValidElement(s)?s:String(s??"");return d.jsx("div",{className:"overflow-auto glass rounded-2xl border transition-all duration-300",children:d.jsxs("table",{className:"table w-full",children:[d.jsx("thead",{children:d.jsx("tr",{className:"bg-white/5",children:i.map(s=>d.jsx("th",{className:"px-4 py-3 text-xs font-bold tracking-wider text-muted uppercase",children:s},s))})}),d.jsx("tbody",{className:"animate-in",children:a.length===0?d.jsx("tr",{children:d.jsx("td",{className:"text-muted p-8 text-center text-sm font-medium",colSpan:i.length,children:"No data available in this section."})}):a.map((s,o)=>d.jsx("tr",{className:"hover:bg-white/5 transition-colors duration-200",children:i.map(c=>d.jsx("td",{className:"px-4 py-3 border-t",children:r(s[c])},c))},o))})]})})}function kn(i){const[a,r]=S.useState(i),s=S.useCallback((p,g)=>{r(v=>({...v,[p]:g}))},[]),o=S.useCallback(p=>g=>{s(p,g.target.value)},[s]),c=S.useCallback(p=>{r(g=>{const v={...i};return p&&p.forEach(b=>{v[b]=g[b]}),v})},[i]),h=S.useCallback(p=>{r(g=>({...g,...p}))},[]),m=S.useCallback(()=>({...a}),[a]);return{form:a,updateField:s,createInputHandler:o,resetForm:c,updateFields:h,getFormData:m,setForm:r}}const MC={Route:"",Item:"",Tons:"",BuyWorld:"",BuyPP:"",SellWorld:"",SellPP:"",DM:"",Fees:""};function UC({rows:i,onAdd:a}){const{form:r,createInputHandler:s,resetForm:o}=kn(MC),c=()=>{if(!r.Route||!r.Item||!r.Tons||!r.BuyWorld||!r.BuyPP)return;const p=Number(r.Tons),g=Number(r.BuyPP),v=r.SellPP===""?null:Number(r.SellPP),b=r.Fees===""?0:Number(r.Fees),x=v===null?null:(v-g)*p-b;a({"Leg/Route":r.Route,Item:r.Item,Tons:p,"Purchase World":r.BuyWorld,"Purchase Price (Cr/ton)":g,"Sale World":r.SellWorld,"Sale Price (Cr/ton)":v,"Broker (DM)":r.DM,"Fees/Taxes (Cr)":b,"Profit (Cr)":x}),o()},h=i.reduce((p,g)=>p+(g.Tons||0),0),m=i.reduce((p,g)=>p+(g["Profit (Cr)"]||0),0);return d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"hud-glass p-6",children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx($u,{className:"w-5 h-5 text-primary"}),d.jsxs("h3",{className:"text-sm font-black tracking-[0.2em] uppercase text-text-main",children:["Trade ",d.jsx("span",{className:"text-primary",children:"Manifest"})]})]}),d.jsxs("div",{className:"flex gap-4",children:[d.jsxs("div",{className:"text-right",children:[d.jsx("p",{className:"text-[10px] font-black text-muted uppercase tracking-widest",children:"Hold Usage"}),d.jsxs("p",{className:"text-xs font-bold",children:[h.toFixed(1)," ",d.jsx("span",{className:"text-[10px] text-muted font-black",children:"TONS"})]})]}),d.jsxs("div",{className:"text-right",children:[d.jsx("p",{className:"text-[10px] font-black text-muted uppercase tracking-widest",children:"Net Outcome"}),d.jsxs("div",{className:"flex items-center gap-1.5 justify-end",children:[m>=0?d.jsx(pg,{className:"w-3 h-3 text-emerald-400"}):d.jsx(gg,{className:"w-3 h-3 text-red-500"}),d.jsxs("p",{className:`text-xs font-bold ${m>=0?"text-emerald-400":"text-red-500"}`,children:[m.toLocaleString()," ",d.jsx("span",{className:"text-[10px] opacity-70 font-black",children:"CR"})]})]})]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4",children:[d.jsx(oe,{label:"Route Origin/Destination",placeholder:"Vland  Regina",value:r.Route,onChange:s("Route")}),d.jsx(oe,{label:"Commodity Designation",placeholder:"Petrochemicals / Luxury Goods",value:r.Item,onChange:s("Item")}),d.jsx(oe,{type:"number",label:"Bulk Tonnage",placeholder:"10.0",value:r.Tons,onChange:s("Tons")})]}),d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3 pt-4 border-t border-white/5",children:[d.jsx("div",{className:"lg:col-span-2",children:d.jsx(oe,{placeholder:"Origin World",value:r.BuyWorld,onChange:s("BuyWorld")})}),d.jsx(oe,{type:"number",placeholder:"Buy (Cr/ton)",value:r.BuyPP,onChange:s("BuyPP")}),d.jsx(oe,{type:"number",placeholder:"Sell (Cr/ton)",value:r.SellPP,onChange:s("SellPP")}),d.jsx(oe,{type:"number",placeholder:"Fees (Cr)",value:r.Fees,onChange:s("Fees")}),d.jsxs("button",{onClick:c,className:"btn-hud py-2.5 flex items-center justify-center gap-2 group",type:"button",children:[d.jsx(Cn,{className:"w-4 h-4 group-hover:rotate-90 transition-transform"}),d.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Manifest"})]})]})]}),d.jsx("div",{className:"hud-glass p-0 overflow-hidden",children:d.jsx(Tn,{columns:["Leg/Route","Item","Tons","Purchase","Sale","Profit (Cr)"],rows:i.map(p=>({...p,"Leg/Route":d.jsx("span",{className:"font-bold text-[11px] uppercase tracking-wide flex items-center gap-2",children:p["Leg/Route"]}),Item:d.jsx("span",{className:"font-black text-primary uppercase tracking-tight",children:p.Item}),Purchase:d.jsxs("div",{className:"text-[10px]",children:[d.jsxs("p",{className:"text-muted uppercase font-black",children:["From ",p["Purchase World"]]}),d.jsxs("p",{className:"font-mono",children:[p["Purchase Price (Cr/ton)"].toLocaleString()," Cr"]})]}),Sale:p["Sale Price (Cr/ton)"]?d.jsxs("div",{className:"text-[10px]",children:[d.jsxs("p",{className:"text-muted uppercase font-black",children:["To ",p["Sale World"]]}),d.jsxs("p",{className:"font-mono",children:[p["Sale Price (Cr/ton)"].toLocaleString()," Cr"]})]}):d.jsx("span",{className:"text-muted italic",children:"In Transit"}),"Profit (Cr)":p["Profit (Cr)"]!==void 0&&p["Profit (Cr)"]!==null?d.jsxs("span",{className:`font-black tracking-tight ${p["Profit (Cr)"]>=0?"text-emerald-400":"text-red-500"}`,children:[p["Profit (Cr)"]>0?"+":"",p["Profit (Cr)"].toLocaleString()]}):d.jsx("span",{className:"text-muted",children:"Calculating..."})}))})})]})}function zC({title:i,totalIncome:a,totalExpenses:r,netChange:s,currentBalance:o}){const c=[{label:"Total Revenue",value:a,icon:d.jsx(pg,{className:"w-4 h-4"}),color:"text-emerald-400"},{label:"Total Outflow",value:r,icon:d.jsx(gg,{className:"w-4 h-4"}),color:"text-red-400"},{label:"Net Variance",value:s,icon:d.jsx(pb,{className:"w-4 h-4"}),color:s>=0?"text-emerald-400":"text-red-400"},{label:"Current Assets",value:o,icon:d.jsx(gb,{className:"w-4 h-4"}),color:o>=0?"text-emerald-400":"text-red-400"}];return d.jsxs("div",{className:"hud-glass p-6",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-6 border-b border-white/10 pb-4",children:[d.jsx("div",{className:"w-1.5 h-6 bg-primary rounded-full"}),d.jsxs("h3",{className:"text-sm font-black tracking-[0.2em] uppercase text-text-main",children:[i," ",d.jsx("span",{className:"text-muted",children:"Financial_Audit"})]})]}),d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8",children:c.map((h,m)=>d.jsxs("div",{className:"space-y-3 relative group",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:`p-1.5 rounded-lg bg-white/5 ${h.color}`,children:h.icon}),d.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-muted group-hover:text-text-main transition-colors",children:h.label})]}),d.jsx("div",{className:"pl-1",children:d.jsx("h4",{className:`text-2xl font-black tracking-tight ${h.color}`,children:NC(h.value)})}),m<c.length-1&&d.jsx("div",{className:"hidden lg:block absolute -right-4 top-1/2 -translate-y-1/2 w-[1px] h-10 bg-white/5"})]},h.label))})]})}function LC({title:i,fundName:a,onSubmit:r}){const s={Date:OC(),Description:"",Category:"Expense",Subcategory:"",Amount:"",Notes:""},{form:o,createInputHandler:c,resetForm:h}=kn(s),[m,p]=S.useState([]),g=()=>{p([]);const v={Date:o.Date,Description:o.Description,Category:o.Category,Subcategory:o.Subcategory,"Amount (Cr)":Number(o.Amount),"Paid By":a,"Paid From (Fund)":a,Notes:o.Notes},b=AC(v);if(!b.isValid){p(b.errors);return}r(v),h(["Date","Category"])};return d.jsxs("div",{className:"hud-glass p-6",children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsxs("h3",{className:"text-sm font-black tracking-[0.2em] uppercase text-text-main",children:["Log ",d.jsx("span",{className:"text-primary",children:i})," Transaction"]}),m.length>0&&d.jsx("span",{className:"text-[10px] font-bold text-red-500 uppercase animate-pulse",children:"Validation Error"})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[d.jsx(oe,{type:"date",value:o.Date,onChange:c("Date")}),d.jsx("div",{className:"lg:col-span-2",children:d.jsx(oe,{placeholder:"Description / Reason",value:o.Description,onChange:c("Description")})}),d.jsxs(oe,{type:"select",value:o.Category,onChange:c("Category"),children:[d.jsx("option",{value:"Income",children:"Income"}),d.jsx("option",{value:"Expense",children:"Expense"}),d.jsx("option",{value:"Transfer",children:"Transfer"})]}),d.jsx(oe,{type:"number",placeholder:"Amount (Cr)",value:o.Amount,onChange:c("Amount")}),d.jsxs("button",{onClick:g,className:"btn-hud py-2.5 flex items-center justify-center gap-2 group",type:"button",children:[d.jsx(Cn,{className:"w-4 h-4 group-hover:rotate-90 transition-transform"}),d.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Execute"})]})]}),m.length>0&&d.jsx("div",{className:"mt-4 p-3 bg-red-500/10 border border-red-500/20 rounded-xl",children:d.jsx("ul",{className:"text-[10px] space-y-1",children:m.map((v,b)=>d.jsxs("li",{className:"text-red-400 font-bold uppercase tracking-wider flex items-center gap-2",children:[d.jsx("div",{className:"w-1 h-1 bg-red-500 rounded-full"}),v]},b))})})]})}function Bu({title:i,rows:a,onUpdate:r,fundName:s,initialBalance:o=0,showSummary:c=!0}){const h=bl(a,o),m=EC(a),p=b=>{const x=jC(a,b,o);r(x)},g=b=>{switch(b){case"Expense":return"bg-red-500/10 border-red-500/20 text-red-500";case"Income":return"bg-emerald-500/10 border-emerald-500/20 text-emerald-500";default:return"bg-primary/10 border-primary/20 text-primary"}},v=a.map(b=>({...b,"Amount (Cr)":d.jsxs("span",{className:`font-mono font-bold ${b.Category==="Expense"?"text-red-400":"text-emerald-400"}`,children:[b.Category==="Expense"?"-":"+",Math.abs(b["Amount (Cr)"]).toLocaleString()]}),"Running Total":d.jsxs("span",{className:"font-black text-primary",children:[(b["Running Total"]||0).toLocaleString()," ",d.jsx("span",{className:"text-[10px] opacity-70",children:"CR"})]}),Category:d.jsx("span",{className:`text-[10px] font-black uppercase tracking-widest px-2 py-0.5 rounded-full border ${g(b.Category)}`,children:b.Category})}));return d.jsxs("div",{className:"space-y-8 animate-hud",children:[c&&d.jsx(zC,{title:i,totalIncome:m.totalIncome,totalExpenses:m.totalExpenses,netChange:m.netChange,currentBalance:h}),d.jsxs("div",{className:"grid grid-cols-1 gap-8",children:[d.jsx(LC,{title:i,fundName:s,onSubmit:p}),d.jsxs("div",{className:"hud-glass p-0 overflow-hidden",children:[d.jsxs("div",{className:"flex items-center gap-3 p-6 border-b border-white/5",children:[d.jsx(mg,{className:"w-5 h-5 text-primary"}),d.jsxs("h3",{className:"text-sm font-black tracking-[0.2em] uppercase text-text-main",children:["Fiscal ",d.jsx("span",{className:"text-primary",children:"Ledger"})]})]}),d.jsx(Tn,{columns:["Date","Description","Category","Amount (Cr)","Running Total","Notes"],rows:v})]})]})]})}function BC({pc:i,rows:a,onAdd:r}){const s=i.includes("  ")?i.split("  ")[1]:i;return d.jsx("div",{className:"space-y-4",children:d.jsx(Bu,{title:s,rows:a,onUpdate:r,fundName:`${s} Fund`,initialBalance:0,showSummary:!0})})}const qC={Item:"",Qty:"","Unit Mass (kg)":"","Unit Value (Cr)":"","Location/Container":"",Notes:""};function PC({rows:i,onAdd:a}){const{form:r,createInputHandler:s,resetForm:o}=kn(qC),c=()=>{if(!r.Item||r.Qty==="")return;const p=Number(r.Qty||0),g=Number(r["Unit Mass (kg)"]||0),v=Number(r["Unit Value (Cr)"]||0);a({Item:r.Item,Qty:p,"Unit Mass (kg)":g,"Total Mass (kg)":p*g,"Unit Value (Cr)":v,"Total Value (Cr)":p*v,"Location/Container":r["Location/Container"],Notes:r.Notes}),o()},h=i.reduce((p,g)=>p+(g["Total Mass (kg)"]||0),0),m=i.reduce((p,g)=>p+(g["Total Value (Cr)"]||0),0);return d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"hud-glass p-6",children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx($u,{className:"w-5 h-5 text-primary"}),d.jsxs("h3",{className:"text-sm font-black tracking-[0.2em] uppercase text-text-main",children:["Gear ",d.jsx("span",{className:"text-primary",children:"Manifest"})]})]}),d.jsxs("div",{className:"flex gap-4",children:[d.jsxs("div",{className:"text-right",children:[d.jsx("p",{className:"text-[10px] font-black text-muted uppercase tracking-widest",children:"Payload"}),d.jsxs("p",{className:"text-xs font-bold",children:[h.toFixed(1)," ",d.jsx("span",{className:"text-[10px] text-muted font-black",children:"KG"})]})]}),d.jsxs("div",{className:"text-right",children:[d.jsx("p",{className:"text-[10px] font-black text-muted uppercase tracking-widest",children:"Valuation"}),d.jsxs("p",{className:"text-xs font-bold text-emerald-400",children:[m.toLocaleString()," ",d.jsx("span",{className:"text-[10px] text-emerald-500 font-black",children:"CR"})]})]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-3",children:[d.jsx("div",{className:"lg:col-span-2",children:d.jsx(oe,{placeholder:"Item Name",value:r.Item,onChange:s("Item")})}),d.jsx(oe,{type:"number",placeholder:"Quantity",value:r.Qty,onChange:s("Qty")}),d.jsx(oe,{type:"number",placeholder:"Mass (kg)",value:r["Unit Mass (kg)"],onChange:s("Unit Mass (kg)")}),d.jsxs("button",{onClick:c,className:"btn-hud py-2.5 flex items-center justify-center gap-2 group",type:"button",children:[d.jsx(Cn,{className:"w-4 h-4 group-hover:rotate-90 transition-transform"}),d.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Register"})]})]})]}),d.jsx("div",{className:"hud-glass p-0 overflow-hidden",children:d.jsx(Tn,{columns:["Item","Qty","Unit Mass (kg)","Total Mass (kg)","Location/Container","Notes"],rows:i})})]})}function By(){const i=S.useMemo(()=>Uy,[]);return{getAllWeapons:()=>i.weapons,getWeaponsByType:p=>i.weapons.filter(g=>g.type===p),getWeaponByName:p=>i.weapons.find(g=>g.name===p),getWeaponTypes:()=>i.weaponTypes,getWeaponsByTechLevel:(p,g)=>i.weapons.filter(v=>g!==void 0?v.tl>=p&&v.tl<=g:v.tl>=p),getTraitDescription:p=>i.traits[p],sortWeaponsByCost:(p=!0)=>{const g=[...i.weapons].sort((v,b)=>v.cost-b.cost);return p?g:g.reverse()},weaponTypes:i.weaponTypes,traits:i.traits}}const ug={Weapon:"","Ammo Type":"","Magazine Size":"","Rounds Loaded":"","Spare Magazines":"","Loose Rounds":"",Cost:"",Notes:""};function $C({row:i,index:a,onFireRound:r,onReload:s}){const o=Number(i["Total Rounds"]||0)<=0,c=Number(i["Spare Magazines"]||0)>0||Number(i["Loose Rounds"]||0)>0;return d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{onClick:()=>r?.(a),disabled:o,className:`px-3 py-1 rounded-lg font-black text-[10px] uppercase tracking-widest transition-all ${o?"bg-white/5 text-muted opacity-50 cursor-not-allowed":"bg-red-500/10 text-red-400 hover:bg-red-500 hover:text-white shadow-lg shadow-red-500/10"}`,children:"Fire"}),d.jsx("button",{onClick:()=>s?.(a),disabled:!c,className:`px-3 py-1 rounded-lg font-black text-[10px] uppercase tracking-widest transition-all ${c?"bg-primary/10 text-primary hover:bg-primary hover:text-white shadow-lg shadow-primary-glow":"bg-white/5 text-muted opacity-50 cursor-not-allowed"}`,children:"Reload"})]})}function HC({rows:i,weapons:a=[],onAdd:r,onFireRound:s,onReload:o}){const{form:c,createInputHandler:h,resetForm:m,updateField:p,setForm:g}=kn(ug),{getAllWeapons:v,getWeaponByName:b}=By(),x=A=>{if(!A||A===""||A==="__custom")return;const R=b(A);R&&R.magazine!==null?g({...c,Weapon:R.name,"Magazine Size":R.magazine.toString(),"Ammo Type":R.type}):p("Weapon",A)},_=()=>{if(!c.Weapon)return;const A=Number(c["Magazine Size"]||0),R=Number(c["Rounds Loaded"]||0),k=Number(c["Spare Magazines"]||0),O=Number(c["Loose Rounds"]||0),H=A*k+R+O;r({Weapon:c.Weapon,"Ammo Type":c["Ammo Type"],"Magazine Size":A,"Rounds Loaded":R,"Spare Magazines":k,"Loose Rounds":O,"Total Rounds":H,Cost:c.Cost?Number(c.Cost):void 0,Notes:c.Notes}),m()},C=A=>{p("Weapon",A)},j=i.map((A,R)=>({...A,Weapon:d.jsx("span",{className:"font-black text-primary uppercase tracking-tight",children:A.Weapon}),"Ammo Type":d.jsx("span",{className:"text-muted font-bold tracking-widest text-[10px] uppercase px-2 py-0.5 bg-white/5 rounded-full border border-white/5",children:A["Ammo Type"]}),"Rounds Loaded":d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(yb,{className:`w-3 h-3 ${Number(A["Rounds Loaded"])>0?"text-amber-400":"text-red-500"}`}),d.jsx("span",{className:"font-mono font-bold",children:A["Rounds Loaded"]})]}),"Total Rounds":d.jsx("span",{className:"font-black text-primary",children:A["Total Rounds"]}),Actions:d.jsx($C,{row:A,index:R,onFireRound:s,onReload:o})}));return d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"hud-glass p-6",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[d.jsx(vb,{className:"w-5 h-5 text-primary"}),d.jsxs("h3",{className:"text-sm font-black tracking-[0.2em] uppercase text-text-main",children:["Ballistics ",d.jsx("span",{className:"text-primary",children:"Registry"})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[d.jsxs(oe,{type:"select",label:"Designation Target",value:c.Weapon==="__custom"?"__custom":c.Weapon,onChange:A=>{const R=A.target.value;R==="__custom"?g({...ug,Weapon:"__custom"}):(h("Weapon")(A),x(R))},children:[d.jsx("option",{value:"",children:"Select Ordinance Target..."}),d.jsx("optgroup",{label:"Active Loadout",children:a.map(A=>d.jsx("option",{value:A.Weapon,children:A.Weapon},A.Weapon))}),d.jsx("optgroup",{label:"Ordinance Database",children:v().filter(A=>A.magazine!==null).map(A=>d.jsx("option",{value:A.name,children:A.name},A.name))}),d.jsx("optgroup",{label:"Manual Override",children:d.jsx("option",{value:"__custom",children:"Custom Ordinance Target"})})]}),d.jsx(oe,{label:"Payload Type",placeholder:"e.g., AP, HE, 9mm",value:c["Ammo Type"],onChange:h("Ammo Type")})]}),c.Weapon==="__custom"&&d.jsx("div",{className:"mb-4 animate-in",children:d.jsx(oe,{label:"Manual Designation",placeholder:"Enter Custom Ordinance Name...",value:"",onChange:A=>C(A.target.value)})}),d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3 pt-4 border-t border-white/5",children:[d.jsx(oe,{type:"number",placeholder:"MAG SZ",value:c["Magazine Size"],onChange:h("Magazine Size")}),d.jsx(oe,{type:"number",placeholder:"LOADED",value:c["Rounds Loaded"],onChange:h("Rounds Loaded")}),d.jsx(oe,{type:"number",placeholder:"SPARE MAGS",value:c["Spare Magazines"],onChange:h("Spare Magazines")}),d.jsx(oe,{type:"number",placeholder:"LOOSE",value:c["Loose Rounds"],onChange:h("Loose Rounds")}),d.jsx(oe,{type:"number",placeholder:"COST",value:c.Cost,onChange:h("Cost")}),d.jsxs("button",{onClick:_,className:"btn-hud py-2.5 flex items-center justify-center gap-2 group",type:"button",children:[d.jsx(Cn,{className:"w-4 h-4 group-hover:rotate-90 transition-transform"}),d.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Deploy"})]})]})]}),d.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/5 rounded-xl border border-white/10 mb-6",children:[d.jsx(bb,{className:"w-4 h-4 text-primary"}),d.jsxs("p",{className:"text-[10px] font-bold text-muted uppercase tracking-wider",children:["Priority System: Loaded Rounds ",d.jsx("span",{className:"text-primary",children:""})," Spare Mags ",d.jsx("span",{className:"text-primary",children:""})," Loose Rounds"]})]}),d.jsx("div",{className:"hud-glass p-0 overflow-hidden",children:d.jsx(Tn,{columns:["Weapon","Ammo Type","Magazine Size","Rounds Loaded","Spare Magazines","Loose Rounds","Total Rounds","Actions"],rows:j})})]})}const dg={Weapon:"",Type:"",Damage:"",Range:"",Mass:"",Cost:"",Notes:""};function VC({rows:i,onAdd:a}){const{form:r,createInputHandler:s,resetForm:o,setForm:c}=kn(dg),{getAllWeapons:h,getWeaponTypes:m,getWeaponByName:p}=By(),[g,v]=S.useState("All"),b=_=>{if(!_||_===""){o();return}const C=p(_);if(C){const j=C.range_long?`${C.range} - ${C.range_long}`:C.range;c({Weapon:C.name,Type:C.type,Damage:C.damage,Range:j,Mass:C.mass.toString(),Cost:C.cost.toString(),Notes:C.notes})}},x=()=>{r.Weapon&&(a({Weapon:r.Weapon,Type:r.Type,Damage:r.Damage,Range:r.Range,Mass:r.Mass?Number(r.Mass):void 0,Cost:r.Cost?Number(r.Cost):void 0,Notes:r.Notes}),o())};return d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"hud-glass p-6",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[d.jsx(xb,{className:"w-5 h-5 text-primary"}),d.jsxs("h3",{className:"text-sm font-black tracking-[0.2em] uppercase text-text-main",children:["Armory ",d.jsx("span",{className:"text-primary",children:"Inventory"})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[d.jsxs(oe,{type:"select",label:"Database Source",value:g,onChange:_=>v(_.target.value),children:[d.jsx("option",{value:"All",children:"All Mission Datasheets"}),d.jsx("option",{value:"Core Rulebook",children:"Core Rulebook"}),d.jsx("option",{value:"High Guard",children:"High Guard"}),d.jsx("option",{value:"Central Supply Catalogue",children:"Central Supply Catalogue"}),d.jsx("option",{value:"Mercenary",children:"Mercenary"}),d.jsx("option",{value:"Other",children:"Other"})]}),d.jsxs(oe,{type:"select",label:"Registry",value:r.Weapon==="custom"?"custom":r.Weapon,onChange:_=>{_.target.value==="custom"?c({...dg,Weapon:"custom"}):(s("Weapon")(_),b(_.target.value))},children:[d.jsx("option",{value:"",children:"Select Ordinance..."}),d.jsx("optgroup",{label:"Ordinance Database",children:h().filter(_=>g==="All"||_.source===g).map(_=>d.jsx("option",{value:_.name,children:_.name},_.name))}),d.jsx("optgroup",{label:"Custom Registry",children:d.jsx("option",{value:"custom",children:"Register Custom Ordinance"})})]})]}),r.Weapon==="custom"&&d.jsx("div",{className:"mb-4 animate-in",children:d.jsx(oe,{label:"Custom Designation",placeholder:"Enter Custom Weapon Name...",value:"",onChange:_=>{c({...r,Weapon:_.target.value})}})}),d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3 pt-4 border-t border-white/5",children:[d.jsxs(oe,{type:"select",value:r.Type,onChange:s("Type"),children:[d.jsx("option",{value:"",children:"Class"}),m().map(_=>d.jsx("option",{value:_,children:_},_))]}),d.jsx(oe,{placeholder:"DMG",value:r.Damage,onChange:s("Damage")}),d.jsx(oe,{placeholder:"RNG",value:r.Range,onChange:s("Range")}),d.jsx(oe,{type:"number",placeholder:"WT (kg)",value:r.Mass,onChange:s("Mass")}),d.jsx(oe,{type:"number",placeholder:"CR",value:r.Cost,onChange:s("Cost")}),d.jsxs("button",{onClick:x,className:"btn-hud py-2.5 flex items-center justify-center gap-2 group",type:"button","data-testid":"add-weapon-button","aria-label":"Add new weapon entry to character equipment",children:[d.jsx(Cn,{className:"w-4 h-4 group-hover:rotate-90 transition-transform"}),d.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Equip"})]})]})]}),d.jsx("div",{className:"hud-glass p-0 overflow-hidden",children:d.jsx(Tn,{columns:["Weapon","Type","Damage","Range","Mass","Cost","Notes"],rows:i.map(_=>({..._,Weapon:d.jsx("span",{className:"font-black text-primary uppercase tracking-tight",children:_.Weapon}),Damage:d.jsx("span",{className:"text-red-400 font-bold",children:_.Damage}),Range:_.Range?`${_.Range}`:"N/A",Mass:_.Mass?`${_.Mass} kg`:"0 kg"}))})})]})}const FC=[{name:"Jack",type:"Light",protection:1,mass:1,cost:50,tl:1,traits:[],notes:"Leather jacket or heavy clothing",source:"Core Rulebook"},{name:"Cloth",type:"Light",protection:5,mass:2,cost:250,tl:7,traits:[],notes:"Ballistic cloth armor",source:"Core Rulebook"},{name:"Mesh",type:"Light",protection:6,mass:2,cost:150,tl:6,traits:[],notes:"Flexible metal mesh",source:"Core Rulebook"},{name:"Flak Jacket",type:"Light",protection:7,mass:3,cost:100,tl:5,traits:["Bulky"],notes:"Heavy protective vest",source:"Core Rulebook"},{name:"Ablat",type:"Light",protection:3,mass:2,cost:75,tl:9,traits:["Ablative"],notes:"Ablative armor against energy weapons",source:"Core Rulebook"},{name:"Reflec",type:"Light",protection:10,protectionType:"vs lasers",mass:.5,cost:1500,tl:10,traits:["Laser Only"],notes:"Reflective coating, only protects vs lasers",source:"Core Rulebook"},{name:"Combat Armour (TL 11)",type:"Medium",protection:13,mass:6,cost:5e3,tl:11,traits:[],notes:"Military-grade powered armor",source:"Core Rulebook"},{name:"Combat Armour (TL 13)",type:"Medium",protection:15,mass:5,cost:8e3,tl:13,traits:[],notes:"Advanced military armor",source:"Core Rulebook"},{name:"Hostile Environment Vacc Suit",type:"Vacc Suit",protection:8,mass:12,cost:7e3,tl:8,traits:["Environment"],notes:"Protects against vacuum and hostile environments",source:"Core Rulebook"},{name:"Vacc Suit (Standard)",type:"Vacc Suit",protection:6,mass:10,cost:4e3,tl:8,traits:["Environment"],notes:"Standard vacuum protection",source:"Core Rulebook"},{name:"HEV Suit",type:"Vacc Suit",protection:8,mass:12,cost:9e3,tl:10,traits:["Environment","Sealed"],notes:"Hazardous Environment Vacc Suit",source:"Core Rulebook"},{name:"Battle Dress (TL 13)",type:"Heavy",protection:18,mass:20,cost:2e5,tl:13,traits:["Powered","Sealed","Environment"],notes:"Fully powered combat armor with life support",source:"Core Rulebook"},{name:"Battle Dress (TL 14)",type:"Heavy",protection:20,mass:18,cost:25e4,tl:14,traits:["Powered","Sealed","Environment"],notes:"Advanced powered armor",source:"Core Rulebook"},{name:"Boarding Armour",type:"Medium",protection:11,mass:8,cost:4500,tl:9,traits:["Zero-G"],notes:"Designed for ship boarding operations",source:"Core Rulebook"},{name:"Diplo Vest",type:"Light",protection:4,mass:.5,cost:500,tl:9,traits:["Concealed"],notes:"Easily concealed diplomatic protection",source:"Core Rulebook"},{name:"Hostile Environment Suit",type:"Environment",protection:6,mass:8,cost:3e3,tl:8,traits:["Environment","Sealed"],notes:"Protection from hostile atmospheres",source:"Core Rulebook"},{name:"NBC Suit",type:"Environment",protection:3,mass:4,cost:500,tl:6,traits:["NBC"],notes:"Nuclear, Biological, Chemical protection",source:"Core Rulebook"},{name:"Protec Suit",type:"Environment",protection:2,mass:3,cost:300,tl:5,traits:["NBC"],notes:"Basic hazmat protection",source:"Core Rulebook"},{name:"Shield",type:"Shield",protection:2,mass:2,cost:20,tl:1,traits:["Melee"],notes:"Personal shield, +2 vs melee attacks",source:"Core Rulebook"},{name:"Riot Shield",type:"Shield",protection:3,mass:3,cost:100,tl:5,traits:["Melee","Bulky"],notes:"Large shield for riot control",source:"Core Rulebook"},{name:"Combat Helmet",type:"Accessory",protection:2,mass:1,cost:100,tl:7,traits:[],notes:"Head protection only",source:"Core Rulebook"},{name:"Respirator",type:"Accessory",protection:0,mass:.5,cost:100,tl:6,traits:["Breathing"],notes:"Filters air, no armor value",source:"Core Rulebook"},{name:"Breather Mask",type:"Accessory",protection:0,mass:.2,cost:150,tl:8,traits:["Breathing"],notes:"Compact air filter",source:"Core Rulebook"},{name:"Skinsuit",type:"Undersuit",protection:0,mass:2,cost:200,tl:8,traits:[],notes:"Worn under armor, provides life support interface",source:"Core Rulebook"},{name:"TL 10 Cloth",type:"Light",protection:7,mass:1.5,cost:500,tl:10,traits:[],notes:"Advanced ballistic cloth",source:"Core Rulebook"},{name:"TL 12 Cloth",type:"Light",protection:9,mass:1,cost:1e3,tl:12,traits:[],notes:"High-tech ballistic protection",source:"Core Rulebook"},{name:"Boarding Vacc Suit",type:"Vacc Suit",protection:9,mass:10,cost:8e3,tl:10,traits:["Environment","Zero-G"],notes:"Armored vacc suit for combat",source:"Core Rulebook"},{name:"Thruster Pack",type:"Accessory",protection:0,mass:5,cost:2e3,tl:9,traits:["Zero-G"],notes:"Personal maneuvering in zero-G",source:"Core Rulebook"},{name:"Gravitic Compensator",type:"Accessory",protection:0,mass:6,cost:1e4,tl:12,traits:[],notes:"Reduces effective weight of armor",source:"Core Rulebook"}],GC=["Light","Medium","Heavy","Vacc Suit","Environment","Shield","Accessory","Undersuit"],IC={Ablative:"Degrades with use, protects better against energy weapons",Bulky:"Difficult to move in, may impose penalties",Concealed:"Can be hidden under normal clothing",Environment:"Protects against environmental hazards","Laser Only":"Only provides protection against laser weapons",Melee:"Provides bonus against melee attacks",NBC:"Protection against Nuclear, Biological, Chemical threats",Powered:"Powered armor system, enhances strength",Sealed:"Provides sealed environment","Zero-G":"Optimized for zero gravity operations",Breathing:"Provides air filtration or supply"},YC={armour:FC,armourTypes:GC,traits:IC};function QC(){const i=S.useMemo(()=>YC,[]);return{getAllArmour:()=>i.armour,getArmourByType:g=>i.armour.filter(v=>v.type===g),getArmourByName:g=>i.armour.find(v=>v.name===g),getArmourTypes:()=>i.armourTypes,getArmourByTechLevel:(g,v)=>i.armour.filter(b=>v!==void 0?b.tl>=g&&b.tl<=v:b.tl>=g),getTraitDescription:g=>i.traits[g],sortArmourByCost:(g=!0)=>{const v=[...i.armour].sort((b,x)=>b.cost-x.cost);return g?v:v.reverse()},sortArmourByProtection:(g=!0)=>{const v=[...i.armour].sort((b,x)=>b.protection-x.protection);return g?v:v.reverse()},armourTypes:i.armourTypes,traits:i.traits}}const xu={Armour:"",Type:"",Protection:"",Mass:"",Cost:"",Notes:""};function KC({rows:i,onAdd:a}){const{form:r,createInputHandler:s,resetForm:o,setForm:c}=kn(xu),{getAllArmour:h,getArmourTypes:m,getArmourByName:p}=QC(),[g,v]=S.useState("All"),b=_=>{if(!_||_===""){o();return}if(_==="custom"){c({...xu,Armour:"custom"});return}const C=p(_);if(C){const j=C.protectionType?`${C.protection} (${C.protectionType})`:C.protection.toString();c({Armour:C.name,Type:C.type,Protection:j,Mass:C.mass.toString(),Cost:C.cost.toString(),Notes:C.notes})}},x=()=>{r.Armour&&(a({Armour:r.Armour,Type:r.Type,Protection:r.Protection?Number(r.Protection):r.Protection,Mass:r.Mass?Number(r.Mass):r.Mass,Cost:r.Cost?Number(r.Cost):void 0,Notes:r.Notes}),o())};return d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"hud-glass p-6",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[d.jsx(_b,{className:"w-5 h-5 text-blue-400"}),d.jsxs("h3",{className:"text-sm font-black tracking-[0.2em] uppercase text-text-main",children:["Protection ",d.jsx("span",{className:"text-blue-400",children:"Suites"})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[d.jsxs(oe,{type:"select",label:"Database Source",value:g,onChange:_=>v(_.target.value),children:[d.jsx("option",{value:"All",children:"All Protection Manuals"}),d.jsx("option",{value:"Core Rulebook",children:"Core Rulebook"}),d.jsx("option",{value:"High Guard",children:"High Guard"}),d.jsx("option",{value:"Central Supply Catalogue",children:"Central Supply Catalogue"}),d.jsx("option",{value:"Mercenary",children:"Mercenary"}),d.jsx("option",{value:"Other",children:"Other"})]}),d.jsxs(oe,{type:"select",label:"Registry",value:r.Armour==="custom"?"custom":r.Armour,onChange:_=>{_.target.value==="custom"?c({...xu,Armour:"custom"}):(s("Armour")(_),b(_.target.value))},children:[d.jsx("option",{value:"",children:"Select Armour..."}),d.jsx("optgroup",{label:"Certified Suites",children:h().filter(_=>g==="All"||_.source===g).map(_=>d.jsx("option",{value:_.name,children:_.name},_.name))}),d.jsx("optgroup",{label:"Custom Fabrication",children:d.jsx("option",{value:"custom",children:"Register Custom Suite"})})]})]}),r.Armour==="custom"&&d.jsx("div",{className:"mb-4 animate-in",children:d.jsx(oe,{label:"Custom Designation",placeholder:"Enter Custom Armour Name...",value:"",onChange:_=>{c({...r,Armour:_.target.value})}})}),d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3 pt-4 border-t border-white/5",children:[d.jsxs(oe,{type:"select",value:r.Type,onChange:s("Type"),children:[d.jsx("option",{value:"",children:"Class"}),m().map(_=>d.jsx("option",{value:_,children:_},_))]}),d.jsx(oe,{placeholder:"PROT",value:r.Protection,onChange:s("Protection")}),d.jsx(oe,{placeholder:"WT (kg)",value:r.Mass,onChange:s("Mass")}),d.jsx(oe,{type:"number",placeholder:"CR",value:r.Cost,onChange:s("Cost")}),d.jsxs("button",{onClick:x,className:"btn-hud py-2.5 flex items-center justify-center gap-2 group",type:"button","data-testid":"add-armour-button","aria-label":"Add new armour entry to character equipment",children:[d.jsx(Cn,{className:"w-4 h-4 group-hover:rotate-90 transition-transform"}),d.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Assign"})]})]})]}),d.jsx("div",{className:"hud-glass p-0 overflow-hidden",children:d.jsx(Tn,{columns:["Armour","Type","Protection","Mass","Cost","Notes"],rows:i.map(_=>({..._,Armour:d.jsx("span",{className:"font-black text-blue-400 uppercase tracking-tight",children:_.Armour}),Protection:d.jsxs("span",{className:"font-bold flex items-center gap-2",children:[d.jsx(yg,{className:"w-3 h-3 text-blue-400"})," ",_.Protection]}),Mass:_.Mass?`${_.Mass} kg`:"0 kg"}))})})]})}const WC={STR:"Strength",DEX:"Dexterity",END:"Endurance",INT:"Intelligence",EDU:"Education",SOC:"Social Standing"},JC=i=>i<=0?-3:i<=2?-2:i<=5?-1:i<=8?0:i<=11?1:i<=14?2:3;function XC({stats:i}){const a=i||{STR:7,DEX:7,END:7,INT:7,EDU:7,SOC:7};return d.jsxs("div",{className:"hud-glass p-6",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[d.jsx(vg,{className:"w-5 h-5 text-primary"}),d.jsxs("h3",{className:"text-sm font-black tracking-[0.2em] uppercase text-text-main",children:["Biometric ",d.jsx("span",{className:"text-primary",children:"Profile"})]})]}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-8",children:Object.entries(a).map(([r,s])=>{const o=JC(s),c=s/15*100;return d.jsxs("div",{className:"group",children:[d.jsxs("div",{className:"flex justify-between items-end mb-2",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-muted group-hover:text-primary transition-colors",children:WC[r]||r}),d.jsxs("div",{className:"text-xl font-black text-main",children:[s.toString().padStart(2,"0"),d.jsxs("span",{className:"ml-2 text-[10px] text-primary/60 font-bold bg-primary/5 px-2 py-0.5 rounded border border-primary/10",children:["MOD ",o>=0?"+":"",o]})]})]}),d.jsxs("div",{className:"text-[10px] font-black text-muted uppercase tracking-tighter",children:["Level ",s," / 15"]})]}),d.jsxs("div",{className:"h-2 bg-white/5 rounded-full overflow-hidden border border-white/5 relative",children:[d.jsx("div",{className:"h-full bg-primary shadow-[0_0_15px_rgba(var(--color-primary-rgb),0.5)] transition-all duration-1000 ease-out relative",style:{width:`${Math.min(c,100)}%`},children:d.jsx("div",{className:"absolute inset-0 opacity-20 bg-grain pointer-events-none"})}),d.jsx("div",{className:"absolute inset-0 flex justify-between px-1 pointer-events-none opacity-20",children:[...Array(5)].map((h,m)=>d.jsx("div",{className:"w-[1px] h-full bg-white"},m))})]})]},r)})}),d.jsxs("div",{className:"mt-8 pt-6 border-t border-white/5 flex items-center justify-between",children:[d.jsxs("div",{className:"flex gap-4",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"w-2 h-2 rounded-full bg-primary animate-pulse"}),d.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-muted",children:"Core Criticality: Stable"})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.4)]"}),d.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-muted",children:"Operative Status: Prime"})]})]}),d.jsx("span",{className:"text-[8px] font-mono text-muted uppercase",children:"Data Hash: 0X7F2A9B..."})]})]})}function ZC({campaignId:i,selectedPc:a,onPcChange:r,characterBalance:s,characterFinance:o,characterInventory:c,characterAmmo:h,characterWeapons:m,characterArmour:p,onUpdateFinance:g,onAddInventory:v,onAddAmmo:b,onAddWeapon:x,onAddArmour:_,onFireRound:C,onReloadWeapon:j}){const[A,R]=S.useState("profile"),{characters:k,loading:O,error:H}=id(i),I=k.find(V=>V.displayName===a);return d.jsxs("div",{className:"space-y-8 animate-hud",children:[d.jsx("div",{className:"flex flex-col lg:flex-row gap-6 items-start lg:items-stretch",children:d.jsx("div",{className:"hud-glass p-6 flex-grow min-w-0 w-full lg:w-auto",children:d.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-6",children:[d.jsxs("div",{className:"flex items-center gap-5",children:[d.jsx("div",{className:"w-16 h-16 rounded-2xl bg-primary/10 flex items-center justify-center text-primary shadow-inner border border-primary/20",children:d.jsx(El,{className:"w-8 h-8"})}),d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[d.jsx("span",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-primary",children:"PERSONNEL_FILE"}),H&&d.jsx("span",{className:"text-[10px] text-amber-500 font-bold px-1.5 py-0.5 bg-amber-500/10 rounded",children:"OFFLINE"})]}),d.jsx("select",{className:"bg-transparent text-2xl font-black tracking-tight border-none p-0 focus:ring-0 cursor-pointer hover:text-primary transition-colors appearance-none",value:a,onChange:V=>r(V.target.value),disabled:O,children:O?d.jsx("option",{children:"Loading Personnel..."}):k.map(V=>d.jsx("option",{value:V.displayName,className:"bg-surface-high",children:V.displayName},V.id))}),I&&d.jsx("p",{className:"text-sm text-muted uppercase tracking-widest font-bold mt-1",children:I.characterName||"Unknown operative"})]})]}),d.jsxs("div",{className:"flex flex-wrap gap-4",children:[d.jsxs("div",{className:"px-5 py-3 rounded-2xl bg-white/5 border border-white/10 flex items-center gap-4",children:[d.jsx(wb,{className:"w-5 h-5 text-emerald-400"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-[10px] font-black text-muted uppercase tracking-widest",children:"Available Credits"}),d.jsx("p",{className:"font-bold text-main",children:Lu(s)})]})]}),d.jsxs("div",{className:"px-5 py-3 rounded-2xl bg-white/5 border border-white/10 flex items-center gap-4",children:[d.jsx(vg,{className:"w-5 h-5 text-primary"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-[10px] font-black text-muted uppercase tracking-widest",children:"Status"}),d.jsx("p",{className:"font-bold text-main uppercase",children:"Mission Ready"})]})]})]})]})})}),d.jsx(Ly,{tabs:[{id:"profile",label:"Bio-Profile"},{id:"ledger",label:"Financial Ledger"},{id:"inventory",label:"Gear Manifest"},{id:"weapons",label:"Armory Entry"},{id:"armour",label:"Protection Suite"},{id:"ammo",label:"Ballistics Tracker"}],active:A,onChange:V=>R(V)}),d.jsxs("div",{className:"transition-all duration-500",children:[A==="profile"&&d.jsx(XC,{stats:I?.stats}),A==="ledger"&&d.jsx(BC,{pc:a,rows:o,onAdd:V=>g(a,V)}),A==="inventory"&&d.jsx(PC,{rows:c,onAdd:V=>v(a,V)}),A==="weapons"&&d.jsx(VC,{rows:m,onAdd:V=>x(a,V)}),A==="armour"&&d.jsx(KC,{rows:p,onAdd:V=>_(a,V)}),A==="ammo"&&d.jsx(HC,{rows:h,weapons:m,onAdd:V=>b(a,V),onFireRound:V=>C?.(a,V),onReload:V=>j?.(a,V)})]})]})}function ej({campaignId:i,activeTab:a,partyFinances:r,shipFinances:s,shipCargo:o,characterFinance:c,characterInventory:h,characterWeapons:m,characterArmour:p,characterAmmo:g,selectedCharacterDisplayName:v,characterBalance:b,onCharacterChange:x,onUpdatePartyFinances:_,onUpdateShipAccounts:C,onAddCargoLeg:j,onUpdateCharacterFinance:A,onAddCharacterInventory:R,onAddCharacterAmmo:k,onAddCharacterWeapon:O,onAddCharacterArmour:H,onFireRound:I,onReloadWeapon:V}){return d.jsxs("div",{role:"tabpanel","aria-labelledby":`tab-${a}`,id:`tabpanel-${a}`,children:[a==="party"&&d.jsx(Bu,{title:"Party",rows:r,onUpdate:_,fundName:"Party Fund",initialBalance:0,showSummary:!0}),a==="ship"&&d.jsx(Bu,{title:"Ship",rows:s,onUpdate:C,fundName:"Ship Fund",initialBalance:0,showSummary:!0}),a==="cargo"&&d.jsx(UC,{rows:o,onAdd:j}),a==="characters"&&d.jsx(ZC,{campaignId:i,selectedPc:v,onPcChange:x,characterBalance:b,characterFinance:c,characterInventory:h,characterAmmo:g,characterWeapons:m,characterArmour:p,onUpdateFinance:A,onAddInventory:R,onAddAmmo:k,onAddWeapon:O,onAddArmour:H,onFireRound:I,onReloadWeapon:V})]})}function tj(){const{campaignId:i}=yx(),a=Ps(),[r,s]=S.useState("party"),{characters:o}=id(i||""),[c,h]=S.useState(""),m=c||o[0]?.displayName||"",p=S.useMemo(()=>o.find(_e=>_e.displayName===m)?.id,[o,m]),{partyFinances:g,shipFinances:v,shipCargo:b,updatePartyFinances:x,updateShipAccounts:_,addCargoLeg:C}=wC(i),{finance:j,inventory:A,weapons:R,armour:k,ammo:O,updateFinance:H,addInventory:I,addAmmo:V,addWeapon:re,addArmour:G,fireRound:q,reloadWeapon:K}=SC(p),{state:de,setState:ce}=_C(),ie=S.useMemo(()=>m?{[m]:{Finance:j,Inventory:A,Weapons:R,Armour:k,Ammo:O}}:{},[m,j,A,R,k,O]),F=RC({Party_Finances:g,Ship_Accounts:v,PCs:ie},m),{handleImport:pe,handleExport:L}=TC(ce,de),Y=(ze,_e)=>{H(_e)},ae=(ze,_e)=>{I(_e)},ee=(ze,_e)=>{V(_e)},J=(ze,_e)=>{re(_e)},Ae=(ze,_e)=>{G(_e)},Ne=(ze,_e)=>{q(_e)},Q=(ze,_e)=>{K(_e)},{campaigns:me}=ky();if(!i)return a("/"),null;const et=me.find(ze=>ze.id===i);return d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"mb-12 animate-hud",children:d.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-6",children:[d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[d.jsx("span",{className:"px-3 py-1 rounded-full bg-primary/10 text-primary text-[10px] font-black uppercase tracking-widest border border-primary/20",children:"ACTIVE_MISSION"}),d.jsxs("span",{className:"text-muted text-[10px] font-black uppercase tracking-widest",children:["ID: ",i?.slice(0,8),"..."]})]}),d.jsxs("h1",{className:"text-4xl md:text-5xl font-black tracking-tighter uppercase",children:[et?.name||"Campaign"," ",d.jsx("span",{className:"text-primary",children:"Dashboard"})]})]}),d.jsx("div",{className:"flex gap-3",children:d.jsx(kC,{onImport:pe,onExport:L})})]})}),d.jsxs("div",{className:"space-y-8",children:[d.jsx("div",{className:"animate-hud delay-100",children:d.jsx(DC,{partyBalance:F.party,shipBalance:F.ship,cargoLegsCount:b.length,characterCount:o.length})}),d.jsxs("div",{className:"animate-hud delay-200",children:[d.jsx(Ly,{tabs:[{id:"party",label:"Party"},{id:"ship",label:"Ship"},{id:"cargo",label:"Cargo"},{id:"characters",label:"Characters"}],active:r,onChange:ze=>s(ze)}),d.jsx("div",{className:"mt-8 transition-all duration-500",children:d.jsx(ej,{campaignId:i||"",activeTab:r,partyFinances:g,shipFinances:v,shipCargo:b,characterFinance:j,characterInventory:A,characterWeapons:R,characterArmour:k,characterAmmo:O,selectedCharacterDisplayName:m,characterBalance:F.character,onCharacterChange:h,onUpdatePartyFinances:x,onUpdateShipAccounts:_,onAddCargoLeg:C,onUpdateCharacterFinance:Y,onAddCharacterInventory:ae,onAddCharacterAmmo:ee,onAddCharacterWeapon:J,onAddCharacterArmour:Ae,onFireRound:Ne,onReloadWeapon:Q})})]})]})]})}function aj({onCollapse:i,onOpenSettings:a}){const[r,s]=S.useState(!1),o=Ps(),c=aa(),{user:h,signOut:m}=Za(),p=()=>{const v=!r;s(v),i(v)},g=[{id:"/",label:"Mission Control",icon:d.jsx(jb,{className:"w-5 h-5"})},{id:"/campaigns",label:"Campaigns",icon:d.jsx(Bs,{className:"w-5 h-5"})},{id:"/characters",label:"Characters",icon:d.jsx(El,{className:"w-5 h-5"})},{id:"settings",label:"Diagnostics",icon:d.jsx(hg,{className:"w-5 h-5"}),action:a}];return d.jsxs("aside",{className:`sidebar-hud ${r?"w-20":"w-72"} flex flex-col transition-all duration-500 overflow-hidden`,children:[d.jsxs("div",{className:`p-6 flex items-center ${r?"justify-center":"justify-between"}`,children:[!r&&d.jsxs("div",{className:"flex items-center gap-3 animate-hud",children:[d.jsx("div",{className:"p-2 bg-primary rounded-xl shadow-lg shadow-primary-glow",children:d.jsx(fg,{className:"w-6 h-6 text-white"})}),d.jsx("span",{className:"font-black text-xl tracking-tighter uppercase whitespace-nowrap",children:"TRAVELLER"})]}),d.jsx("button",{onClick:p,className:"p-2 hover:bg-hud-accent rounded-xl transition-colors text-muted hover:text-primary shrink-0",children:r?d.jsx(Pu,{className:"w-6 h-6"}):d.jsx(Sb,{className:"w-6 h-6"})})]}),d.jsx("nav",{className:"flex-grow px-4 mt-8 space-y-2",children:g.map(v=>{const b=c.pathname===v.id,x=()=>{v.action?v.action():o(v.id)};return d.jsxs("button",{onClick:x,className:`w-full flex items-center rounded-2xl transition-all duration-300 group ${r?"justify-center p-3.5":"gap-4 px-4 py-3.5"} ${b?"bg-primary text-white shadow-lg shadow-primary-glow scale-[1.02]":"text-muted hover:text-text-main hover:bg-hud-accent"}`,children:[d.jsx("div",{className:`${b?"text-white":"group-hover:text-primary"} transition-colors shrink-0`,children:v.icon}),!r&&d.jsx("span",{className:"font-bold text-sm uppercase tracking-wider animate-hud whitespace-nowrap overflow-hidden",children:v.label})]},v.id)})}),d.jsxs("div",{className:"p-4 border-t border-border-color",children:[d.jsxs("div",{className:`flex items-center gap-4 p-3 rounded-2xl ${r?"justify-center":"bg-hud-accent"}`,children:[d.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary/20 flex items-center justify-center text-primary font-black uppercase shadow-inner",children:h?.email?.[0]||"U"}),!r&&d.jsxs("div",{className:"flex-grow min-w-0 animate-hud",children:[d.jsx("p",{className:"text-sm font-bold truncate tracking-tight",children:h?.displayName||"User"}),d.jsx("p",{className:"text-[10px] text-muted truncate uppercase tracking-widest font-black",children:"Logged In"})]})]}),d.jsxs("button",{onClick:()=>m(),className:`w-full flex items-center text-muted hover:text-red-500 transition-colors rounded-2xl group ${r?"justify-center p-4 mt-4":"gap-4 px-4 py-4 mt-6"}`,children:[d.jsx(Cb,{className:"w-5 h-5 group-hover:scale-110 transition-transform shrink-0"}),!r&&d.jsx("span",{className:"font-bold text-sm uppercase tracking-wider animate-hud whitespace-nowrap overflow-hidden",children:"Sign Out"})]})]})]})}const qy=S.createContext(void 0);function rj({children:i}){const[a,r]=S.useState(()=>localStorage.getItem("hud-theme")||"system"),[s,o]=S.useState("dark");return S.useEffect(()=>{localStorage.setItem("hud-theme",a);const c=window.document.documentElement,h=m=>{c.classList.remove("light","dark"),c.classList.add(m),o(m)};if(a==="system"){const m=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";h(m);const p=window.matchMedia("(prefers-color-scheme: dark)"),g=v=>{h(v.matches?"dark":"light")};return p.addEventListener("change",g),()=>p.removeEventListener("change",g)}h(a)},[a]),d.jsx(qy.Provider,{value:{theme:a,setTheme:r,resolvedTheme:s},children:i})}function nj(){const i=S.useContext(qy);if(i===void 0)throw new Error("useTheme must be used within a ThemeProvider");return i}function sj({isOpen:i,onClose:a,user:r,onUpdateProfile:s,onChangePassword:o,onDeleteAccount:c}){const{theme:h,setTheme:m}=nj(),[p,g]=S.useState("profile"),[v,b]=S.useState(!1),[x,_]=S.useState(null),[C,j]=S.useState(r.displayName||""),[A,R]=S.useState(r.username||""),[k,O]=S.useState(""),[H,I]=S.useState(""),[V,re]=S.useState(""),[G,q]=S.useState(!1),[K,de]=S.useState(!1),[ce,ie]=S.useState(!1),F=GS(H),pe=async ee=>{ee.preventDefault(),b(!0),_(null);try{await s({displayName:C.trim()||void 0,username:A.trim()||void 0}),_({type:"success",text:"Profile updated successfully!"})}catch(J){_({type:"error",text:J instanceof Error?J.message:"Failed to update profile"})}finally{b(!1)}},L=async ee=>{if(ee.preventDefault(),b(!0),_(null),!F.isValid){_({type:"error",text:"Please fix the password requirements"}),b(!1);return}if(H!==V){_({type:"error",text:"New passwords do not match"}),b(!1);return}try{await o({currentPassword:k,newPassword:H}),_({type:"success",text:"Password changed successfully!"}),O(""),I(""),re("")}catch(J){_({type:"error",text:J instanceof Error?J.message:"Failed to change password"})}finally{b(!1)}},Y=()=>{window.confirm("Are you sure you want to delete your account? This action cannot be undone.")&&c()},ae=[{id:"profile",label:"Profile",icon:El},{id:"password",label:"Password",icon:yg},{id:"display",label:"Display",icon:cp},{id:"danger",label:"Danger Zone",icon:up}];return d.jsx(rt,{isOpen:i,onClose:a,title:"Account Settings",maxWidth:"xl",children:d.jsxs("div",{className:"flex h-[32rem]",children:[d.jsx("div",{className:"w-56 border-r border-gray-200 dark:border-zinc-700 pr-6",children:d.jsx("nav",{className:"space-y-1",children:ae.map(ee=>{const J=ee.icon;return d.jsxs("button",{onClick:()=>g(ee.id),className:`w-full flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors ${p===ee.id?"bg-primary/10 text-primary":"text-muted hover:text-text-main hover:bg-hud-accent"}`,children:[d.jsx(J,{className:"w-4 h-4 mr-3"}),ee.label]},ee.id)})})}),d.jsxs("div",{className:"flex-1 pl-8",children:[x&&d.jsx("div",{className:`mb-4 p-3 rounded-lg text-sm ${x.type==="success"?"bg-green-500/10 text-green-600 dark:text-green-400 border border-green-500/20":"bg-red-500/10 text-red-600 dark:text-red-400 border border-red-500/20"}`,children:x.text}),p==="profile"&&d.jsxs("form",{onSubmit:pe,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-text-main mb-2 uppercase tracking-wider",children:"Email Address"}),d.jsxs("div",{className:"flex items-center px-3 py-2 bg-hud-accent border border-border rounded-lg",children:[d.jsx(Ab,{className:"w-4 h-4 text-muted mr-3"}),d.jsx("span",{className:"text-sm text-muted",children:r.email})]}),d.jsx("p",{className:"text-xs text-muted mt-1 italic",children:"Email cannot be changed"})]}),d.jsx(oe,{label:"Display Name",type:"text",value:C,onChange:ee=>j(ee.target.value),placeholder:"Enter your display name"}),d.jsx(oe,{label:"Username",type:"text",value:A,onChange:ee=>R(ee.target.value),placeholder:"Enter your username"}),d.jsx(Te,{type:"submit",disabled:v,className:"w-full",children:v?"Updating...":"Update Profile"})]}),p==="password"&&d.jsxs("form",{onSubmit:L,className:"space-y-4",children:[d.jsxs("div",{className:"relative",children:[d.jsx(oe,{label:"Current Password",type:G?"text":"password",value:k,onChange:ee=>O(ee.target.value),placeholder:"Enter your current password",required:!0}),d.jsx("button",{type:"button",onClick:()=>q(!G),className:"absolute right-3 top-8 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:G?d.jsx(Jc,{className:"w-4 h-4"}):d.jsx(Xc,{className:"w-4 h-4"})})]}),d.jsxs("div",{className:"relative",children:[d.jsx(oe,{label:"New Password",type:K?"text":"password",value:H,onChange:ee=>I(ee.target.value),placeholder:"Enter your new password",required:!0}),d.jsx("button",{type:"button",onClick:()=>de(!K),className:"absolute right-3 top-8 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:K?d.jsx(Jc,{className:"w-4 h-4"}):d.jsx(Xc,{className:"w-4 h-4"})})]}),H&&d.jsxs("div",{className:"space-y-2",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-muted",children:"Password Strength:"}),d.jsx("span",{className:`text-sm font-bold uppercase tracking-widest ${IS(F.strength)}`,children:YS(F.strength)})]}),d.jsx("div",{className:"space-y-1 text-xs",children:F.errors.map((ee,J)=>d.jsxs("div",{className:"flex items-center text-red-600 dark:text-red-400",children:[d.jsx("span",{className:"mr-2",children:""}),ee]},J))})]}),d.jsxs("div",{className:"relative",children:[d.jsx(oe,{label:"Confirm New Password",type:ce?"text":"password",value:V,onChange:ee=>re(ee.target.value),placeholder:"Confirm your new password",required:!0}),d.jsx("button",{type:"button",onClick:()=>ie(!ce),className:"absolute right-3 top-8 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:ce?d.jsx(Jc,{className:"w-4 h-4"}):d.jsx(Xc,{className:"w-4 h-4"})})]}),d.jsx(Te,{type:"submit",disabled:v||!F.isValid||H!==V,className:"w-full",children:v?"Changing Password...":"Change Password"})]}),p==="display"&&d.jsx("div",{className:"space-y-6 animate-hud",children:d.jsxs("div",{children:[d.jsx("h3",{className:"text-sm font-bold uppercase tracking-widest text-primary mb-4",children:"Tactical Interface"}),d.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[d.jsxs("button",{onClick:()=>m("light"),type:"button",className:`flex items-center justify-between p-4 rounded-xl border transition-all ${h==="light"?"bg-primary/10 border-primary text-primary shadow-lg shadow-primary-glow/10":"bg-hud-accent border-border hover:border-primary/50"}`,children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:`p-2 rounded-lg ${h==="light"?"bg-primary text-white":"bg-side text-muted"}`,children:d.jsx(Nb,{className:"w-5 h-5"})}),d.jsxs("div",{className:"text-left",children:[d.jsx("p",{className:"font-bold",children:"Light HUD"}),d.jsx("p",{className:"text-xs text-muted",children:"Optimized for high-light environments"})]})]}),h==="light"&&d.jsx("div",{className:"w-2 h-2 rounded-full bg-primary animate-pulse"})]}),d.jsxs("button",{onClick:()=>m("dark"),type:"button",className:`flex items-center justify-between p-4 rounded-xl border transition-all ${h==="dark"?"bg-primary/10 border-primary text-primary shadow-lg shadow-primary-glow/10":"bg-hud-accent border-border hover:border-primary/50"}`,children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:`p-2 rounded-lg ${h==="dark"?"bg-primary text-white":"bg-side text-muted"}`,children:d.jsx(Eb,{className:"w-5 h-5"})}),d.jsxs("div",{className:"text-left",children:[d.jsx("p",{className:"font-bold",children:"Dark HUD"}),d.jsx("p",{className:"text-xs text-muted",children:"Stealth mode for low-light sectors"})]})]}),h==="dark"&&d.jsx("div",{className:"w-2 h-2 rounded-full bg-primary animate-pulse"})]}),d.jsxs("button",{onClick:()=>m("system"),type:"button",className:`flex items-center justify-between p-4 rounded-xl border transition-all ${h==="system"?"bg-primary/10 border-primary text-primary shadow-lg shadow-primary-glow/10":"bg-hud-accent border-border hover:border-primary/50"}`,children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:`p-2 rounded-lg ${h==="system"?"bg-primary text-white":"bg-side text-muted"}`,children:d.jsx(cp,{className:"w-5 h-5"})}),d.jsxs("div",{className:"text-left",children:[d.jsx("p",{className:"font-bold",children:"Dynamic Sync"}),d.jsx("p",{className:"text-xs text-muted",children:"Inherit system-level display parameters"})]})]}),h==="system"&&d.jsx("div",{className:"w-2 h-2 rounded-full bg-primary animate-pulse"})]})]})]})}),p==="danger"&&d.jsx("div",{className:"space-y-6",children:d.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:d.jsxs("div",{className:"flex items-start",children:[d.jsx(up,{className:"w-5 h-5 text-red-600 dark:text-red-400 mt-0.5 mr-3 flex-shrink-0"}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"Delete Account"}),d.jsx("p",{className:"mt-1 text-sm text-red-700 dark:text-red-300",children:"Once you delete your account, there is no going back. Please be certain."}),d.jsx("div",{className:"mt-4",children:d.jsx(Te,{variant:"danger",onClick:Y,className:"bg-red-600 hover:bg-red-700 text-white",children:"Delete Account"})})]})]})})})]})]})})}function ij({children:i}){const[a,r]=S.useState(!1),[s,o]=S.useState(!1),[c,h]=S.useState(!1),{user:m,updateProfile:p,changePassword:g,deleteAccount:v}=Za();return d.jsxs("div",{className:"min-h-screen bg-transparent selection:bg-primary/20",children:[d.jsxs("div",{className:"lg:hidden glass fixed top-0 w-full z-50 px-6 py-4 flex items-center justify-between border-b",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-8 h-8 bg-primary rounded-lg shadow-lg flex items-center justify-center",children:d.jsx("span",{className:"text-white text-xs font-black",children:"T"})}),d.jsx("span",{className:"font-black tracking-tighter uppercase",children:"TRAVELLER"})]}),d.jsx("button",{onClick:()=>o(!s),className:"p-2 hover:bg-hud-accent rounded-xl text-primary",children:s?d.jsx(qu,{}):d.jsx(Rb,{})})]}),d.jsx("div",{className:`
        ${s?"translate-x-0":"-translate-x-full lg:translate-x-0"}
        fixed inset-y-0 left-0 z-50 transition-transform duration-500
      `,children:d.jsx(aj,{onCollapse:r,onOpenSettings:()=>h(!0)})}),m&&d.jsx(sj,{isOpen:c,onClose:()=>h(!1),user:m,onUpdateProfile:async b=>{const x=await p(b);if(!x.success&&x.error)throw new Error(x.error)},onChangePassword:async b=>{const x=await g(b);if(!x.success&&x.error)throw new Error(x.error)},onDeleteAccount:()=>{v().then(()=>{h(!1)})}}),s&&d.jsx("div",{className:"lg:hidden fixed inset-0 bg-black/60 backdrop-blur-sm z-40 transition-opacity",onClick:()=>o(!1)}),d.jsx("main",{className:`
        min-h-screen transition-all duration-500
        ${a?"lg:pl-20":"lg:pl-72"}
        pt-20 lg:pt-0
      `,children:d.jsx("div",{className:"max-w-[1600px] mx-auto p-4 lg:p-8 animate-hud",children:i})})]})}function lj(){const{user:i,loading:a,completeProfile:r}=Za();return HS(),a?d.jsx("div",{className:"min-h-screen flex items-center justify-center",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),d.jsx("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):i?i.profileCompleted?d.jsx(ij,{children:d.jsxs(Dx,{children:[d.jsx(vn,{path:"/",element:d.jsx(yu,{})}),d.jsx(vn,{path:"/campaigns",element:d.jsx(yu,{})}),d.jsx(vn,{path:"/characters",element:d.jsx(yu,{})}),d.jsx(vn,{path:"/campaign/:campaignId",element:d.jsx(tj,{})}),d.jsx(vn,{path:"*",element:d.jsx(kx,{to:"/",replace:!0})})]})}):d.jsx(KS,{onComplete:r}):d.jsxs(d.Fragment,{children:[!1,d.jsx(FS,{})]})}function oj(){return d.jsx(a_,{basename:"/traveller-dashboard",children:d.jsx(lj,{})})}class cj extends bg.Component{constructor(a){super(a),this.state={hasError:!1}}static getDerivedStateFromError(a){return{hasError:!0,error:a}}componentDidCatch(a,r){console.error("Error boundary caught an error:",a,r)}render(){return this.state.hasError?d.jsx("div",{className:"min-h-screen flex items-center justify-center bg-red-50",children:d.jsxs("div",{className:"max-w-md mx-auto p-6 bg-white rounded-lg shadow-lg",children:[d.jsx("h2",{className:"text-xl font-bold text-red-600 mb-4",children:"Something went wrong"}),d.jsx("pre",{className:"text-sm bg-gray-100 p-4 rounded overflow-auto",children:this.state.error?.message}),d.jsx("pre",{className:"text-xs bg-gray-100 p-4 rounded overflow-auto mt-2",children:this.state.error?.stack}),d.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Reload Page"})]})}):this.props.children}}class uj{supabase;constructor(a){this.supabase=a}async getCampaignFinances(a){const{data:r,error:s}=await this.supabase.from("campaign_finances").select("*").eq("campaign_id",a).order("transaction_date",{ascending:!1});if(s)throw s;return(r||[]).map(o=>({id:o.id,Date:o.transaction_date,Description:o.description,Category:o.category,Subcategory:o.subcategory,"Amount (Cr)":parseFloat(o.amount),"Paid By":o.paid_by,"Paid From (Fund)":o.paid_from_fund,"Running Total":o.running_total?parseFloat(o.running_total):void 0,Notes:o.notes}))}async addCampaignFinance(a,r){const{data:s,error:o}=await this.supabase.from("campaign_finances").insert({campaign_id:a,transaction_date:r.Date,description:r.Description,category:r.Category,subcategory:r.Subcategory,amount:r["Amount (Cr)"],paid_by:r["Paid By"],paid_from_fund:r["Paid From (Fund)"],notes:r.Notes}).select().single();if(o)throw o;return{id:s.id,Date:s.transaction_date,Description:s.description,Category:s.category,Subcategory:s.subcategory,"Amount (Cr)":parseFloat(s.amount),"Paid By":s.paid_by,"Paid From (Fund)":s.paid_from_fund,"Running Total":s.running_total?parseFloat(s.running_total):void 0,Notes:s.notes}}async updateCampaignFinance(a,r){const s={};r.Date&&(s.transaction_date=r.Date),r.Description&&(s.description=r.Description),r.Category&&(s.category=r.Category),r.Subcategory!==void 0&&(s.subcategory=r.Subcategory),r["Amount (Cr)"]!==void 0&&(s.amount=r["Amount (Cr)"]),r["Paid By"]!==void 0&&(s.paid_by=r["Paid By"]),r["Paid From (Fund)"]!==void 0&&(s.paid_from_fund=r["Paid From (Fund)"]),r.Notes!==void 0&&(s.notes=r.Notes);const{error:o}=await this.supabase.from("campaign_finances").update(s).eq("id",a);if(o)throw o}async deleteCampaignFinance(a){const{error:r}=await this.supabase.from("campaign_finances").delete().eq("id",a);if(r)throw r}async getShipFinances(a){const{data:r,error:s}=await this.supabase.from("ship_finances").select("*").eq("campaign_id",a).order("transaction_date",{ascending:!1});if(s)throw s;return(r||[]).map(o=>({id:o.id,Date:o.transaction_date,Description:o.description,Category:o.category,Subcategory:o.subcategory,"Amount (Cr)":parseFloat(o.amount),"Paid By":o.paid_by,"Paid From (Fund)":o.paid_from_fund,"Running Total":o.running_total?parseFloat(o.running_total):void 0,Notes:o.notes}))}async addShipFinance(a,r){const{data:s,error:o}=await this.supabase.from("ship_finances").insert({campaign_id:a,transaction_date:r.Date,description:r.Description,category:r.Category,subcategory:r.Subcategory,amount:r["Amount (Cr)"],paid_by:r["Paid By"],paid_from_fund:r["Paid From (Fund)"],notes:r.Notes}).select().single();if(o)throw o;return{id:s.id,Date:s.transaction_date,Description:s.description,Category:s.category,Subcategory:s.subcategory,"Amount (Cr)":parseFloat(s.amount),"Paid By":s.paid_by,"Paid From (Fund)":s.paid_from_fund,"Running Total":s.running_total?parseFloat(s.running_total):void 0,Notes:s.notes}}async updateShipFinance(a,r){const s={};r.Date&&(s.transaction_date=r.Date),r.Description&&(s.description=r.Description),r.Category&&(s.category=r.Category),r.Subcategory!==void 0&&(s.subcategory=r.Subcategory),r["Amount (Cr)"]!==void 0&&(s.amount=r["Amount (Cr)"]),r["Paid By"]!==void 0&&(s.paid_by=r["Paid By"]),r["Paid From (Fund)"]!==void 0&&(s.paid_from_fund=r["Paid From (Fund)"]),r.Notes!==void 0&&(s.notes=r.Notes);const{error:o}=await this.supabase.from("ship_finances").update(s).eq("id",a);if(o)throw o}async deleteShipFinance(a){const{error:r}=await this.supabase.from("ship_finances").delete().eq("id",a);if(r)throw r}async getShipCargo(a){const{data:r,error:s}=await this.supabase.from("ship_cargo").select("*").eq("campaign_id",a).order("created_at",{ascending:!1});if(s)throw s;return(r||[]).map(o=>({"Leg/Route":o.leg_route,Item:o.item,Tons:parseFloat(o.tons),"Purchase World":o.purchase_world,"Purchase Price (Cr/ton)":parseFloat(o.purchase_price_per_ton),"Sale World":o.sale_world,"Sale Price (Cr/ton)":o.sale_price_per_ton?parseFloat(o.sale_price_per_ton):null,"Broker (DM)":o.broker_dm,"Fees/Taxes (Cr)":o.fees_taxes?parseFloat(o.fees_taxes):void 0,"Profit (Cr)":o.profit?parseFloat(o.profit):null}))}async addShipCargo(a,r){const{data:s,error:o}=await this.supabase.from("ship_cargo").insert({campaign_id:a,leg_route:r["Leg/Route"],item:r.Item,tons:r.Tons,purchase_world:r["Purchase World"],purchase_price_per_ton:r["Purchase Price (Cr/ton)"],sale_world:r["Sale World"],sale_price_per_ton:r["Sale Price (Cr/ton)"],broker_dm:r["Broker (DM)"],fees_taxes:r["Fees/Taxes (Cr)"],profit:r["Profit (Cr)"]}).select().single();if(o)throw o;return{"Leg/Route":s.leg_route,Item:s.item,Tons:parseFloat(s.tons),"Purchase World":s.purchase_world,"Purchase Price (Cr/ton)":parseFloat(s.purchase_price_per_ton),"Sale World":s.sale_world,"Sale Price (Cr/ton)":s.sale_price_per_ton?parseFloat(s.sale_price_per_ton):null,"Broker (DM)":s.broker_dm,"Fees/Taxes (Cr)":s.fees_taxes?parseFloat(s.fees_taxes):void 0,"Profit (Cr)":s.profit?parseFloat(s.profit):null}}async updateShipCargo(a,r){const s={};r["Leg/Route"]&&(s.leg_route=r["Leg/Route"]),r.Item&&(s.item=r.Item),r.Tons!==void 0&&(s.tons=r.Tons),r["Purchase World"]&&(s.purchase_world=r["Purchase World"]),r["Purchase Price (Cr/ton)"]!==void 0&&(s.purchase_price_per_ton=r["Purchase Price (Cr/ton)"]),r["Sale World"]!==void 0&&(s.sale_world=r["Sale World"]),r["Sale Price (Cr/ton)"]!==void 0&&(s.sale_price_per_ton=r["Sale Price (Cr/ton)"]),r["Broker (DM)"]!==void 0&&(s.broker_dm=r["Broker (DM)"]),r["Fees/Taxes (Cr)"]!==void 0&&(s.fees_taxes=r["Fees/Taxes (Cr)"]),r["Profit (Cr)"]!==void 0&&(s.profit=r["Profit (Cr)"]);const{error:o}=await this.supabase.from("ship_cargo").update(s).eq("id",a);if(o)throw o}async deleteShipCargo(a){const{error:r}=await this.supabase.from("ship_cargo").delete().eq("id",a);if(r)throw r}async getShipMaintenance(a){const{data:r,error:s}=await this.supabase.from("ship_maintenance").select("*").eq("campaign_id",a).order("maintenance_date",{ascending:!1});if(s)throw s;return(r||[]).map(o=>({Date:o.maintenance_date,Type:o.type,Description:o.description,"Cost (Cr)":o.cost?parseFloat(o.cost):void 0,Location:o.location,Notes:o.notes}))}async addShipMaintenance(a,r){const{data:s,error:o}=await this.supabase.from("ship_maintenance").insert({campaign_id:a,maintenance_date:r.Date,type:r.Type,description:r.Description,cost:r["Cost (Cr)"],location:r.Location,notes:r.Notes}).select().single();if(o)throw o;return{Date:s.maintenance_date,Type:s.type,Description:s.description,"Cost (Cr)":s.cost?parseFloat(s.cost):void 0,Location:s.location,Notes:s.notes}}async updateShipMaintenance(a,r){const s={};r.Date&&(s.maintenance_date=r.Date),r.Type&&(s.type=r.Type),r.Description&&(s.description=r.Description),r["Cost (Cr)"]!==void 0&&(s.cost=r["Cost (Cr)"]),r.Location!==void 0&&(s.location=r.Location),r.Notes!==void 0&&(s.notes=r.Notes);const{error:o}=await this.supabase.from("ship_maintenance").update(s).eq("id",a);if(o)throw o}async deleteShipMaintenance(a){const{error:r}=await this.supabase.from("ship_maintenance").delete().eq("id",a);if(r)throw r}async getCampaignLoans(a){const{data:r,error:s}=await this.supabase.from("campaign_loans").select("*").eq("campaign_id",a).order("created_at",{ascending:!1});if(s)throw s;return(r||[]).map(o=>({"Loan Type":o.loan_type,Principal:parseFloat(o.principal),"Interest Rate":o.interest_rate?parseFloat(o.interest_rate):void 0,"Monthly Payment":o.monthly_payment?parseFloat(o.monthly_payment):void 0,"Remaining Balance":o.remaining_balance?parseFloat(o.remaining_balance):void 0,Notes:o.notes}))}async addCampaignLoan(a,r){const{data:s,error:o}=await this.supabase.from("campaign_loans").insert({campaign_id:a,loan_type:r["Loan Type"],principal:r.Principal,interest_rate:r["Interest Rate"],monthly_payment:r["Monthly Payment"],remaining_balance:r["Remaining Balance"],notes:r.Notes}).select().single();if(o)throw o;return{"Loan Type":s.loan_type,Principal:parseFloat(s.principal),"Interest Rate":s.interest_rate?parseFloat(s.interest_rate):void 0,"Monthly Payment":s.monthly_payment?parseFloat(s.monthly_payment):void 0,"Remaining Balance":s.remaining_balance?parseFloat(s.remaining_balance):void 0,Notes:s.notes}}async updateCampaignLoan(a,r){const s={};r["Loan Type"]&&(s.loan_type=r["Loan Type"]),r.Principal!==void 0&&(s.principal=r.Principal),r["Interest Rate"]!==void 0&&(s.interest_rate=r["Interest Rate"]),r["Monthly Payment"]!==void 0&&(s.monthly_payment=r["Monthly Payment"]),r["Remaining Balance"]!==void 0&&(s.remaining_balance=r["Remaining Balance"]),r.Notes!==void 0&&(s.notes=r.Notes);const{error:o}=await this.supabase.from("campaign_loans").update(s).eq("id",a);if(o)throw o}async deleteCampaignLoan(a){const{error:r}=await this.supabase.from("campaign_loans").delete().eq("id",a);if(r)throw r}async getPartyInventory(a){const{data:r,error:s}=await this.supabase.from("party_inventory").select("*").eq("campaign_id",a).order("created_at",{ascending:!1});if(s)throw s;return(r||[]).map(o=>({Item:o.item,Qty:o.quantity,"Unit Mass (kg)":o.unit_mass_kg?parseFloat(o.unit_mass_kg):void 0,"Total Mass (kg)":o.total_mass_kg?parseFloat(o.total_mass_kg):void 0,"Unit Value (Cr)":o.unit_value?parseFloat(o.unit_value):void 0,"Total Value (Cr)":o.total_value?parseFloat(o.total_value):void 0,"Location/Container":o.location_container,Notes:o.notes}))}async addPartyInventoryItem(a,r){const{data:s,error:o}=await this.supabase.from("party_inventory").insert({campaign_id:a,item:r.Item,quantity:r.Qty,unit_mass_kg:r["Unit Mass (kg)"],total_mass_kg:r["Total Mass (kg)"],unit_value:r["Unit Value (Cr)"],total_value:r["Total Value (Cr)"],location_container:r["Location/Container"],notes:r.Notes}).select().single();if(o)throw o;return{Item:s.item,Qty:s.quantity,"Unit Mass (kg)":s.unit_mass_kg?parseFloat(s.unit_mass_kg):void 0,"Total Mass (kg)":s.total_mass_kg?parseFloat(s.total_mass_kg):void 0,"Unit Value (Cr)":s.unit_value?parseFloat(s.unit_value):void 0,"Total Value (Cr)":s.total_value?parseFloat(s.total_value):void 0,"Location/Container":s.location_container,Notes:s.notes}}async updatePartyInventoryItem(a,r){const s={};r.Item&&(s.item=r.Item),r.Qty!==void 0&&(s.quantity=r.Qty),r["Unit Mass (kg)"]!==void 0&&(s.unit_mass_kg=r["Unit Mass (kg)"]),r["Total Mass (kg)"]!==void 0&&(s.total_mass_kg=r["Total Mass (kg)"]),r["Unit Value (Cr)"]!==void 0&&(s.unit_value=r["Unit Value (Cr)"]),r["Total Value (Cr)"]!==void 0&&(s.total_value=r["Total Value (Cr)"]),r["Location/Container"]!==void 0&&(s.location_container=r["Location/Container"]),r.Notes!==void 0&&(s.notes=r.Notes);const{error:o}=await this.supabase.from("party_inventory").update(s).eq("id",a);if(o)throw o}async deletePartyInventoryItem(a){const{error:r}=await this.supabase.from("party_inventory").delete().eq("id",a);if(r)throw r}async getCampaignAmmo(a){const{data:r,error:s}=await this.supabase.from("campaign_ammo").select("*").eq("campaign_id",a).order("created_at",{ascending:!1});if(s)throw s;return(r||[]).map(o=>({Weapon:o.weapon,"Ammo Type":o.ammo_type,"Magazine Size":o.magazine_size,"Rounds Loaded":o.rounds_loaded,"Spare Magazines":o.spare_magazines,"Loose Rounds":o.loose_rounds,"Total Rounds":o.total_rounds,Cost:o.cost?parseFloat(o.cost):void 0,Notes:o.notes}))}async addCampaignAmmo(a,r){const{data:s,error:o}=await this.supabase.from("campaign_ammo").insert({campaign_id:a,weapon:r.Weapon,ammo_type:r["Ammo Type"],magazine_size:r["Magazine Size"]?.toString(),rounds_loaded:r["Rounds Loaded"]?.toString(),spare_magazines:r["Spare Magazines"]?.toString(),loose_rounds:r["Loose Rounds"]?.toString(),total_rounds:r["Total Rounds"],cost:r.Cost,notes:r.Notes}).select().single();if(o)throw o;return{Weapon:s.weapon,"Ammo Type":s.ammo_type,"Magazine Size":s.magazine_size,"Rounds Loaded":s.rounds_loaded,"Spare Magazines":s.spare_magazines,"Loose Rounds":s.loose_rounds,"Total Rounds":s.total_rounds,Cost:s.cost?parseFloat(s.cost):void 0,Notes:s.notes}}async updateCampaignAmmo(a,r){const s={};r.Weapon&&(s.weapon=r.Weapon),r["Ammo Type"]!==void 0&&(s.ammo_type=r["Ammo Type"]),r["Magazine Size"]!==void 0&&(s.magazine_size=r["Magazine Size"]?.toString()),r["Rounds Loaded"]!==void 0&&(s.rounds_loaded=r["Rounds Loaded"]?.toString()),r["Spare Magazines"]!==void 0&&(s.spare_magazines=r["Spare Magazines"]?.toString()),r["Loose Rounds"]!==void 0&&(s.loose_rounds=r["Loose Rounds"]?.toString()),r["Total Rounds"]!==void 0&&(s.total_rounds=r["Total Rounds"]),r.Cost!==void 0&&(s.cost=r.Cost),r.Notes!==void 0&&(s.notes=r.Notes);const{error:o}=await this.supabase.from("campaign_ammo").update(s).eq("id",a);if(o)throw o}async deleteCampaignAmmo(a){const{error:r}=await this.supabase.from("campaign_ammo").delete().eq("id",a);if(r)throw r}async getAllCampaignData(a){const[r,s,o,c,h,m,p]=await Promise.all([this.getCampaignFinances(a),this.getShipFinances(a),this.getShipCargo(a),this.getShipMaintenance(a),this.getCampaignLoans(a),this.getPartyInventory(a),this.getCampaignAmmo(a)]);return{finances:r,shipFinances:s,cargo:o,maintenance:c,loans:h,partyInventory:m,ammo:p}}}function dj(){Qt.getInstance().init({authRepository:new uC,campaignRepository:new My,characterRepository:new cC(W),campaignDataRepository:new uj(W)})}dj();const Py=document.getElementById("root");if(!Py)throw new Error("Failed to find the root element");$b.createRoot(Py).render(d.jsx(bg.StrictMode,{children:d.jsx(cj,{children:d.jsx(rj,{children:d.jsx(oj,{})})})}));export{ng as D,Nl as _};
